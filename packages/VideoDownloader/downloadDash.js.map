{"version":3,"file":"downloadDash.js","mappings":"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,OAAO86B,SAAS,CAAC96B,KAAK,CAAC,GAAG,IAAI;EAChC,CAAC;EAED;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACE8tB,mBAAmB,CAAC9tB,KAAK,EAAE;IACzB,OAAOg6B,aAAa,CAACh6B,KAAK,CAAC;EAC7B,CAAC;EAED;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACEo2B,0BAA0B,CAACp2B,KAAK,EAAE;IAChC,OAAOg6B,aAAa,CAACh6B,KAAK,CAAC;EAC7B,CAAC;EAED;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACEgvB,IAAI,CAAChvB,KAAK,EAAE;IACV,OAAOA,KAAK;EACd,CAAC;EAED;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACE+tB,oBAAoB,CAAC/tB,KAAK,EAAE;IAC1B,OAAOg6B,aAAa,CAACh6B,KAAK,CAAC;EAC7B,CAAC;EAED;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACEyF,KAAK,CAACzF,KAAK,EAAE;IACX,OAAOg6B,aAAa,CAACh6B,KAAK,CAAC;EAC7B,CAAC;EAED;AACF;AACA;AACA;AACA;AACA;AACA;AACA;EACEq1B,KAAK,CAACr1B,KAAK,EAAE;IACX,OAAOonB,QAAQ,CAACpnB,KAAK,EAAE,EAAE,CAAC;EAC5B,CAAC;EAED;AACF;AACA;AACA;AACA;AACA;AACA;AACA;EACEs1B,MAAM,CAACt1B,KAAK,EAAE;IACZ,OAAOonB,QAAQ,CAACpnB,KAAK,EAAE,EAAE,CAAC;EAC5B,CAAC;EAED;AACF;AACA;AACA;AACA;AACA;AACA;AACA;EACEuzB,SAAS,CAACvzB,KAAK,EAAE;IACf,OAAOonB,QAAQ,CAACpnB,KAAK,EAAE,EAAE,CAAC;EAC5B,CAAC;EAED;AACF;AACA;AACA;AACA;AACA;AACA;AACA;EACEu1B,SAAS,CAACv1B,KAAK,EAAE;IACf,OAAO65B,kBAAkB,CAAC75B,KAAK,CAAC;EAClC,CAAC;EAED;AACF;AACA;AACA;AACA;AACA;AACA;AACA;EA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","sources":["webpack://video/./node_modules/@videojs/vhs-utils/es/decode-b64-to-uint8-array.js","webpack://video/./node_modules/@videojs/vhs-utils/es/media-groups.js","webpack://video/./node_modules/@videojs/vhs-utils/es/resolve-url.js","webpack://video/./node_modules/@xmldom/xmldom/lib/conventions.js","webpack://video/./node_modules/@xmldom/xmldom/lib/dom-parser.js","webpack://video/./node_modules/@xmldom/xmldom/lib/dom.js","webpack://video/./node_modules/@xmldom/xmldom/lib/entities.js","webpack://video/./node_modules/@xmldom/xmldom/lib/index.js","webpack://video/./node_modules/@xmldom/xmldom/lib/sax.js","webpack://video/./node_modules/global/window.js","webpack://video/./node_modules/mpd-parser/dist/mpd-parser.es.js","webpack://video/./node_modules/url-toolkit/src/url-toolkit.js","webpack://video/webpack/bootstrap","webpack://video/webpack/runtime/compat get default export","webpack://video/webpack/runtime/define property getters","webpack://video/webpack/runtime/global","webpack://video/webpack/runtime/hasOwnProperty shorthand","webpack://video/webpack/runtime/make namespace object","webpack://video/./downloadDash.js"],"sourcesContent":["import window from 'global/window';\n\nvar atob = function atob(s) {\n  return window.atob ? window.atob(s) : Buffer.from(s, 'base64').toString('binary');\n};\n\nexport default function decodeB64ToUint8Array(b64Text) {\n  var decodedString = atob(b64Text);\n  var array = new Uint8Array(decodedString.length);\n\n  for (var i = 0; i < decodedString.length; i++) {\n    array[i] = decodedString.charCodeAt(i);\n  }\n\n  return array;\n}","/**\n * Loops through all supported media groups in master and calls the provided\n * callback for each group\n *\n * @param {Object} master\n *        The parsed master manifest object\n * @param {string[]} groups\n *        The media groups to call the callback for\n * @param {Function} callback\n *        Callback to call for each media group\n */\nexport var forEachMediaGroup = function forEachMediaGroup(master, groups, callback) {\n  groups.forEach(function (mediaType) {\n    for (var groupKey in master.mediaGroups[mediaType]) {\n      for (var labelKey in master.mediaGroups[mediaType][groupKey]) {\n        var mediaProperties = master.mediaGroups[mediaType][groupKey][labelKey];\n        callback(mediaProperties, mediaType, groupKey, labelKey);\n      }\n    }\n  });\n};","import URLToolkit from 'url-toolkit';\nimport window from 'global/window';\nvar DEFAULT_LOCATION = 'http://example.com';\n\nvar resolveUrl = function resolveUrl(baseUrl, relativeUrl) {\n  // return early if we don't need to resolve\n  if (/^[a-z]+:/i.test(relativeUrl)) {\n    return relativeUrl;\n  } // if baseUrl is a data URI, ignore it and resolve everything relative to window.location\n\n\n  if (/^data:/.test(baseUrl)) {\n    baseUrl = window.location && window.location.href || '';\n  } // IE11 supports URL but not the URL constructor\n  // feature detect the behavior we want\n\n\n  var nativeURL = typeof window.URL === 'function';\n  var protocolLess = /^\\/\\//.test(baseUrl); // remove location if window.location isn't available (i.e. we're in node)\n  // and if baseUrl isn't an absolute url\n\n  var removeLocation = !window.location && !/\\/\\//i.test(baseUrl); // if the base URL is relative then combine with the current location\n\n  if (nativeURL) {\n    baseUrl = new window.URL(baseUrl, window.location || DEFAULT_LOCATION);\n  } else if (!/\\/\\//i.test(baseUrl)) {\n    baseUrl = URLToolkit.buildAbsoluteURL(window.location && window.location.href || '', baseUrl);\n  }\n\n  if (nativeURL) {\n    var newUrl = new URL(relativeUrl, baseUrl); // if we're a protocol-less url, remove the protocol\n    // and if we're location-less, remove the location\n    // otherwise, return the url unmodified\n\n    if (removeLocation) {\n      return newUrl.href.slice(DEFAULT_LOCATION.length);\n    } else if (protocolLess) {\n      return newUrl.href.slice(newUrl.protocol.length);\n    }\n\n    return newUrl.href;\n  }\n\n  return URLToolkit.buildAbsoluteURL(baseUrl, relativeUrl);\n};\n\nexport default resolveUrl;","'use strict'\n\n/**\n * Ponyfill for `Array.prototype.find` which is only available in ES6 runtimes.\n *\n * Works with anything that has a `length` property and index access properties, including NodeList.\n *\n * @template {unknown} T\n * @param {Array<T> | ({length:number, [number]: T})} list\n * @param {function (item: T, index: number, list:Array<T> | ({length:number, [number]: T})):boolean} predicate\n * @param {Partial<Pick<ArrayConstructor['prototype'], 'find'>>?} ac `Array.prototype` by default,\n * \t\t\t\tallows injecting a custom implementation in tests\n * @returns {T | undefined}\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/find\n * @see https://tc39.es/ecma262/multipage/indexed-collections.html#sec-array.prototype.find\n */\nfunction find(list, predicate, ac) {\n\tif (ac === undefined) {\n\t\tac = Array.prototype;\n\t}\n\tif (list && typeof ac.find === 'function') {\n\t\treturn ac.find.call(list, predicate);\n\t}\n\tfor (var i = 0; i < list.length; i++) {\n\t\tif (Object.prototype.hasOwnProperty.call(list, i)) {\n\t\t\tvar item = list[i];\n\t\t\tif (predicate.call(undefined, item, i, list)) {\n\t\t\t\treturn item;\n\t\t\t}\n\t\t}\n\t}\n}\n\n/**\n * \"Shallow freezes\" an object to render it immutable.\n * Uses `Object.freeze` if available,\n * otherwise the immutability is only in the type.\n *\n * Is used to create \"enum like\" objects.\n *\n * @template T\n * @param {T} object the object to freeze\n * @param {Pick<ObjectConstructor, 'freeze'> = Object} oc `Object` by default,\n * \t\t\t\tallows to inject custom object constructor for tests\n * @returns {Readonly<T>}\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/freeze\n */\nfunction freeze(object, oc) {\n\tif (oc === undefined) {\n\t\toc = Object\n\t}\n\treturn oc && typeof oc.freeze === 'function' ? oc.freeze(object) : object\n}\n\n/**\n * Since we can not rely on `Object.assign` we provide a simplified version\n * that is sufficient for our needs.\n *\n * @param {Object} target\n * @param {Object | null | undefined} source\n *\n * @returns {Object} target\n * @throws TypeError if target is not an object\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign\n * @see https://tc39.es/ecma262/multipage/fundamental-objects.html#sec-object.assign\n */\nfunction assign(target, source) {\n\tif (target === null || typeof target !== 'object') {\n\t\tthrow new TypeError('target is not an object')\n\t}\n\tfor (var key in source) {\n\t\tif (Object.prototype.hasOwnProperty.call(source, key)) {\n\t\t\ttarget[key] = source[key]\n\t\t}\n\t}\n\treturn target\n}\n\n/**\n * All mime types that are allowed as input to `DOMParser.parseFromString`\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/DOMParser/parseFromString#Argument02 MDN\n * @see https://html.spec.whatwg.org/multipage/dynamic-markup-insertion.html#domparsersupportedtype WHATWG HTML Spec\n * @see DOMParser.prototype.parseFromString\n */\nvar MIME_TYPE = freeze({\n\t/**\n\t * `text/html`, the only mime type that triggers treating an XML document as HTML.\n\t *\n\t * @see DOMParser.SupportedType.isHTML\n\t * @see https://www.iana.org/assignments/media-types/text/html IANA MimeType registration\n\t * @see https://en.wikipedia.org/wiki/HTML Wikipedia\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/DOMParser/parseFromString MDN\n\t * @see https://html.spec.whatwg.org/multipage/dynamic-markup-insertion.html#dom-domparser-parsefromstring WHATWG HTML Spec\n\t */\n\tHTML: 'text/html',\n\n\t/**\n\t * Helper method to check a mime type if it indicates an HTML document\n\t *\n\t * @param {string} [value]\n\t * @returns {boolean}\n\t *\n\t * @see https://www.iana.org/assignments/media-types/text/html IANA MimeType registration\n\t * @see https://en.wikipedia.org/wiki/HTML Wikipedia\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/DOMParser/parseFromString MDN\n\t * @see https://html.spec.whatwg.org/multipage/dynamic-markup-insertion.html#dom-domparser-parsefromstring \t */\n\tisHTML: function (value) {\n\t\treturn value === MIME_TYPE.HTML\n\t},\n\n\t/**\n\t * `application/xml`, the standard mime type for XML documents.\n\t *\n\t * @see https://www.iana.org/assignments/media-types/application/xml IANA MimeType registration\n\t * @see https://tools.ietf.org/html/rfc7303#section-9.1 RFC 7303\n\t * @see https://en.wikipedia.org/wiki/XML_and_MIME Wikipedia\n\t */\n\tXML_APPLICATION: 'application/xml',\n\n\t/**\n\t * `text/html`, an alias for `application/xml`.\n\t *\n\t * @see https://tools.ietf.org/html/rfc7303#section-9.2 RFC 7303\n\t * @see https://www.iana.org/assignments/media-types/text/xml IANA MimeType registration\n\t * @see https://en.wikipedia.org/wiki/XML_and_MIME Wikipedia\n\t */\n\tXML_TEXT: 'text/xml',\n\n\t/**\n\t * `application/xhtml+xml`, indicates an XML document that has the default HTML namespace,\n\t * but is parsed as an XML document.\n\t *\n\t * @see https://www.iana.org/assignments/media-types/application/xhtml+xml IANA MimeType registration\n\t * @see https://dom.spec.whatwg.org/#dom-domimplementation-createdocument WHATWG DOM Spec\n\t * @see https://en.wikipedia.org/wiki/XHTML Wikipedia\n\t */\n\tXML_XHTML_APPLICATION: 'application/xhtml+xml',\n\n\t/**\n\t * `image/svg+xml`,\n\t *\n\t * @see https://www.iana.org/assignments/media-types/image/svg+xml IANA MimeType registration\n\t * @see https://www.w3.org/TR/SVG11/ W3C SVG 1.1\n\t * @see https://en.wikipedia.org/wiki/Scalable_Vector_Graphics Wikipedia\n\t */\n\tXML_SVG_IMAGE: 'image/svg+xml',\n})\n\n/**\n * Namespaces that are used in this code base.\n *\n * @see http://www.w3.org/TR/REC-xml-names\n */\nvar NAMESPACE = freeze({\n\t/**\n\t * The XHTML namespace.\n\t *\n\t * @see http://www.w3.org/1999/xhtml\n\t */\n\tHTML: 'http://www.w3.org/1999/xhtml',\n\n\t/**\n\t * Checks if `uri` equals `NAMESPACE.HTML`.\n\t *\n\t * @param {string} [uri]\n\t *\n\t * @see NAMESPACE.HTML\n\t */\n\tisHTML: function (uri) {\n\t\treturn uri === NAMESPACE.HTML\n\t},\n\n\t/**\n\t * The SVG namespace.\n\t *\n\t * @see http://www.w3.org/2000/svg\n\t */\n\tSVG: 'http://www.w3.org/2000/svg',\n\n\t/**\n\t * The `xml:` namespace.\n\t *\n\t * @see http://www.w3.org/XML/1998/namespace\n\t */\n\tXML: 'http://www.w3.org/XML/1998/namespace',\n\n\t/**\n\t * The `xmlns:` namespace\n\t *\n\t * @see https://www.w3.org/2000/xmlns/\n\t */\n\tXMLNS: 'http://www.w3.org/2000/xmlns/',\n})\n\nexports.assign = assign;\nexports.find = find;\nexports.freeze = freeze;\nexports.MIME_TYPE = MIME_TYPE;\nexports.NAMESPACE = NAMESPACE;\n","var conventions = require(\"./conventions\");\nvar dom = require('./dom')\nvar entities = require('./entities');\nvar sax = require('./sax');\n\nvar DOMImplementation = dom.DOMImplementation;\n\nvar NAMESPACE = conventions.NAMESPACE;\n\nvar ParseError = sax.ParseError;\nvar XMLReader = sax.XMLReader;\n\n/**\n * Normalizes line ending according to https://www.w3.org/TR/xml11/#sec-line-ends:\n *\n * > XML parsed entities are often stored in computer files which,\n * > for editing convenience, are organized into lines.\n * > These lines are typically separated by some combination\n * > of the characters CARRIAGE RETURN (#xD) and LINE FEED (#xA).\n * >\n * > To simplify the tasks of applications, the XML processor must behave\n * > as if it normalized all line breaks in external parsed entities (including the document entity)\n * > on input, before parsing, by translating all of the following to a single #xA character:\n * >\n * > 1. the two-character sequence #xD #xA\n * > 2. the two-character sequence #xD #x85\n * > 3. the single character #x85\n * > 4. the single character #x2028\n * > 5. any #xD character that is not immediately followed by #xA or #x85.\n *\n * @param {string} input\n * @returns {string}\n */\nfunction normalizeLineEndings(input) {\n\treturn input\n\t\t.replace(/\\r[\\n\\u0085]/g, '\\n')\n\t\t.replace(/[\\r\\u0085\\u2028]/g, '\\n')\n}\n\n/**\n * @typedef Locator\n * @property {number} [columnNumber]\n * @property {number} [lineNumber]\n */\n\n/**\n * @typedef DOMParserOptions\n * @property {DOMHandler} [domBuilder]\n * @property {Function} [errorHandler]\n * @property {(string) => string} [normalizeLineEndings] used to replace line endings before parsing\n * \t\t\t\t\t\tdefaults to `normalizeLineEndings`\n * @property {Locator} [locator]\n * @property {Record<string, string>} [xmlns]\n *\n * @see normalizeLineEndings\n */\n\n/**\n * The DOMParser interface provides the ability to parse XML or HTML source code\n * from a string into a DOM `Document`.\n *\n * _xmldom is different from the spec in that it allows an `options` parameter,\n * to override the default behavior._\n *\n * @param {DOMParserOptions} [options]\n * @constructor\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/DOMParser\n * @see https://html.spec.whatwg.org/multipage/dynamic-markup-insertion.html#dom-parsing-and-serialization\n */\nfunction DOMParser(options){\n\tthis.options = options ||{locator:{}};\n}\n\nDOMParser.prototype.parseFromString = function(source,mimeType){\n\tvar options = this.options;\n\tvar sax =  new XMLReader();\n\tvar domBuilder = options.domBuilder || new DOMHandler();//contentHandler and LexicalHandler\n\tvar errorHandler = options.errorHandler;\n\tvar locator = options.locator;\n\tvar defaultNSMap = options.xmlns||{};\n\tvar isHTML = /\\/x?html?$/.test(mimeType);//mimeType.toLowerCase().indexOf('html') > -1;\n  \tvar entityMap = isHTML ? entities.HTML_ENTITIES : entities.XML_ENTITIES;\n\tif(locator){\n\t\tdomBuilder.setDocumentLocator(locator)\n\t}\n\n\tsax.errorHandler = buildErrorHandler(errorHandler,domBuilder,locator);\n\tsax.domBuilder = options.domBuilder || domBuilder;\n\tif(isHTML){\n\t\tdefaultNSMap[''] = NAMESPACE.HTML;\n\t}\n\tdefaultNSMap.xml = defaultNSMap.xml || NAMESPACE.XML;\n\tvar normalize = options.normalizeLineEndings || normalizeLineEndings;\n\tif (source && typeof source === 'string') {\n\t\tsax.parse(\n\t\t\tnormalize(source),\n\t\t\tdefaultNSMap,\n\t\t\tentityMap\n\t\t)\n\t} else {\n\t\tsax.errorHandler.error('invalid doc source')\n\t}\n\treturn domBuilder.doc;\n}\nfunction buildErrorHandler(errorImpl,domBuilder,locator){\n\tif(!errorImpl){\n\t\tif(domBuilder instanceof DOMHandler){\n\t\t\treturn domBuilder;\n\t\t}\n\t\terrorImpl = domBuilder ;\n\t}\n\tvar errorHandler = {}\n\tvar isCallback = errorImpl instanceof Function;\n\tlocator = locator||{}\n\tfunction build(key){\n\t\tvar fn = errorImpl[key];\n\t\tif(!fn && isCallback){\n\t\t\tfn = errorImpl.length == 2?function(msg){errorImpl(key,msg)}:errorImpl;\n\t\t}\n\t\terrorHandler[key] = fn && function(msg){\n\t\t\tfn('[xmldom '+key+']\\t'+msg+_locator(locator));\n\t\t}||function(){};\n\t}\n\tbuild('warning');\n\tbuild('error');\n\tbuild('fatalError');\n\treturn errorHandler;\n}\n\n//console.log('#\\n\\n\\n\\n\\n\\n\\n####')\n/**\n * +ContentHandler+ErrorHandler\n * +LexicalHandler+EntityResolver2\n * -DeclHandler-DTDHandler\n *\n * DefaultHandler:EntityResolver, DTDHandler, ContentHandler, ErrorHandler\n * DefaultHandler2:DefaultHandler,LexicalHandler, DeclHandler, EntityResolver2\n * @link http://www.saxproject.org/apidoc/org/xml/sax/helpers/DefaultHandler.html\n */\nfunction DOMHandler() {\n    this.cdata = false;\n}\nfunction position(locator,node){\n\tnode.lineNumber = locator.lineNumber;\n\tnode.columnNumber = locator.columnNumber;\n}\n/**\n * @see org.xml.sax.ContentHandler#startDocument\n * @link http://www.saxproject.org/apidoc/org/xml/sax/ContentHandler.html\n */\nDOMHandler.prototype = {\n\tstartDocument : function() {\n    \tthis.doc = new DOMImplementation().createDocument(null, null, null);\n    \tif (this.locator) {\n        \tthis.doc.documentURI = this.locator.systemId;\n    \t}\n\t},\n\tstartElement:function(namespaceURI, localName, qName, attrs) {\n\t\tvar doc = this.doc;\n\t    var el = doc.createElementNS(namespaceURI, qName||localName);\n\t    var len = attrs.length;\n\t    appendElement(this, el);\n\t    this.currentElement = el;\n\n\t\tthis.locator && position(this.locator,el)\n\t    for (var i = 0 ; i < len; i++) {\n\t        var namespaceURI = attrs.getURI(i);\n\t        var value = attrs.getValue(i);\n\t        var qName = attrs.getQName(i);\n\t\t\tvar attr = doc.createAttributeNS(namespaceURI, qName);\n\t\t\tthis.locator &&position(attrs.getLocator(i),attr);\n\t\t\tattr.value = attr.nodeValue = value;\n\t\t\tel.setAttributeNode(attr)\n\t    }\n\t},\n\tendElement:function(namespaceURI, localName, qName) {\n\t\tvar current = this.currentElement\n\t\tvar tagName = current.tagName;\n\t\tthis.currentElement = current.parentNode;\n\t},\n\tstartPrefixMapping:function(prefix, uri) {\n\t},\n\tendPrefixMapping:function(prefix) {\n\t},\n\tprocessingInstruction:function(target, data) {\n\t    var ins = this.doc.createProcessingInstruction(target, data);\n\t    this.locator && position(this.locator,ins)\n\t    appendElement(this, ins);\n\t},\n\tignorableWhitespace:function(ch, start, length) {\n\t},\n\tcharacters:function(chars, start, length) {\n\t\tchars = _toString.apply(this,arguments)\n\t\t//console.log(chars)\n\t\tif(chars){\n\t\t\tif (this.cdata) {\n\t\t\t\tvar charNode = this.doc.createCDATASection(chars);\n\t\t\t} else {\n\t\t\t\tvar charNode = this.doc.createTextNode(chars);\n\t\t\t}\n\t\t\tif(this.currentElement){\n\t\t\t\tthis.currentElement.appendChild(charNode);\n\t\t\t}else if(/^\\s*$/.test(chars)){\n\t\t\t\tthis.doc.appendChild(charNode);\n\t\t\t\t//process xml\n\t\t\t}\n\t\t\tthis.locator && position(this.locator,charNode)\n\t\t}\n\t},\n\tskippedEntity:function(name) {\n\t},\n\tendDocument:function() {\n\t\tthis.doc.normalize();\n\t},\n\tsetDocumentLocator:function (locator) {\n\t    if(this.locator = locator){// && !('lineNumber' in locator)){\n\t    \tlocator.lineNumber = 0;\n\t    }\n\t},\n\t//LexicalHandler\n\tcomment:function(chars, start, length) {\n\t\tchars = _toString.apply(this,arguments)\n\t    var comm = this.doc.createComment(chars);\n\t    this.locator && position(this.locator,comm)\n\t    appendElement(this, comm);\n\t},\n\n\tstartCDATA:function() {\n\t    //used in characters() methods\n\t    this.cdata = true;\n\t},\n\tendCDATA:function() {\n\t    this.cdata = false;\n\t},\n\n\tstartDTD:function(name, publicId, systemId) {\n\t\tvar impl = this.doc.implementation;\n\t    if (impl && impl.createDocumentType) {\n\t        var dt = impl.createDocumentType(name, publicId, systemId);\n\t        this.locator && position(this.locator,dt)\n\t        appendElement(this, dt);\n\t\t\t\t\tthis.doc.doctype = dt;\n\t    }\n\t},\n\t/**\n\t * @see org.xml.sax.ErrorHandler\n\t * @link http://www.saxproject.org/apidoc/org/xml/sax/ErrorHandler.html\n\t */\n\twarning:function(error) {\n\t\tconsole.warn('[xmldom warning]\\t'+error,_locator(this.locator));\n\t},\n\terror:function(error) {\n\t\tconsole.error('[xmldom error]\\t'+error,_locator(this.locator));\n\t},\n\tfatalError:function(error) {\n\t\tthrow new ParseError(error, this.locator);\n\t}\n}\nfunction _locator(l){\n\tif(l){\n\t\treturn '\\n@'+(l.systemId ||'')+'#[line:'+l.lineNumber+',col:'+l.columnNumber+']'\n\t}\n}\nfunction _toString(chars,start,length){\n\tif(typeof chars == 'string'){\n\t\treturn chars.substr(start,length)\n\t}else{//java sax connect width xmldom on rhino(what about: \"? && !(chars instanceof String)\")\n\t\tif(chars.length >= start+length || start){\n\t\t\treturn new java.lang.String(chars,start,length)+'';\n\t\t}\n\t\treturn chars;\n\t}\n}\n\n/*\n * @link http://www.saxproject.org/apidoc/org/xml/sax/ext/LexicalHandler.html\n * used method of org.xml.sax.ext.LexicalHandler:\n *  #comment(chars, start, length)\n *  #startCDATA()\n *  #endCDATA()\n *  #startDTD(name, publicId, systemId)\n *\n *\n * IGNORED method of org.xml.sax.ext.LexicalHandler:\n *  #endDTD()\n *  #startEntity(name)\n *  #endEntity(name)\n *\n *\n * @link http://www.saxproject.org/apidoc/org/xml/sax/ext/DeclHandler.html\n * IGNORED method of org.xml.sax.ext.DeclHandler\n * \t#attributeDecl(eName, aName, type, mode, value)\n *  #elementDecl(name, model)\n *  #externalEntityDecl(name, publicId, systemId)\n *  #internalEntityDecl(name, value)\n * @link http://www.saxproject.org/apidoc/org/xml/sax/ext/EntityResolver2.html\n * IGNORED method of org.xml.sax.EntityResolver2\n *  #resolveEntity(String name,String publicId,String baseURI,String systemId)\n *  #resolveEntity(publicId, systemId)\n *  #getExternalSubset(name, baseURI)\n * @link http://www.saxproject.org/apidoc/org/xml/sax/DTDHandler.html\n * IGNORED method of org.xml.sax.DTDHandler\n *  #notationDecl(name, publicId, systemId) {};\n *  #unparsedEntityDecl(name, publicId, systemId, notationName) {};\n */\n\"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl\".replace(/\\w+/g,function(key){\n\tDOMHandler.prototype[key] = function(){return null}\n})\n\n/* Private static helpers treated below as private instance methods, so don't need to add these to the public API; we might use a Relator to also get rid of non-standard public properties */\nfunction appendElement (hander,node) {\n    if (!hander.currentElement) {\n        hander.doc.appendChild(node);\n    } else {\n        hander.currentElement.appendChild(node);\n    }\n}//appendChild and setAttributeNS are preformance key\n\nexports.__DOMHandler = DOMHandler;\nexports.normalizeLineEndings = normalizeLineEndings;\nexports.DOMParser = DOMParser;\n","var conventions = require(\"./conventions\");\n\nvar find = conventions.find;\nvar NAMESPACE = conventions.NAMESPACE;\n\n/**\n * A prerequisite for `[].filter`, to drop elements that are empty\n * @param {string} input\n * @returns {boolean}\n */\nfunction notEmptyString (input) {\n\treturn input !== ''\n}\n/**\n * @see https://infra.spec.whatwg.org/#split-on-ascii-whitespace\n * @see https://infra.spec.whatwg.org/#ascii-whitespace\n *\n * @param {string} input\n * @returns {string[]} (can be empty)\n */\nfunction splitOnASCIIWhitespace(input) {\n\t// U+0009 TAB, U+000A LF, U+000C FF, U+000D CR, U+0020 SPACE\n\treturn input ? input.split(/[\\t\\n\\f\\r ]+/).filter(notEmptyString) : []\n}\n\n/**\n * Adds element as a key to current if it is not already present.\n *\n * @param {Record<string, boolean | undefined>} current\n * @param {string} element\n * @returns {Record<string, boolean | undefined>}\n */\nfunction orderedSetReducer (current, element) {\n\tif (!current.hasOwnProperty(element)) {\n\t\tcurrent[element] = true;\n\t}\n\treturn current;\n}\n\n/**\n * @see https://infra.spec.whatwg.org/#ordered-set\n * @param {string} input\n * @returns {string[]}\n */\nfunction toOrderedSet(input) {\n\tif (!input) return [];\n\tvar list = splitOnASCIIWhitespace(input);\n\treturn Object.keys(list.reduce(orderedSetReducer, {}))\n}\n\n/**\n * Uses `list.indexOf` to implement something like `Array.prototype.includes`,\n * which we can not rely on being available.\n *\n * @param {any[]} list\n * @returns {function(any): boolean}\n */\nfunction arrayIncludes (list) {\n\treturn function(element) {\n\t\treturn list && list.indexOf(element) !== -1;\n\t}\n}\n\nfunction copy(src,dest){\n\tfor(var p in src){\n\t\tif (Object.prototype.hasOwnProperty.call(src, p)) {\n\t\t\tdest[p] = src[p];\n\t\t}\n\t}\n}\n\n/**\n^\\w+\\.prototype\\.([_\\w]+)\\s*=\\s*((?:.*\\{\\s*?[\\r\\n][\\s\\S]*?^})|\\S.*?(?=[;\\r\\n]));?\n^\\w+\\.prototype\\.([_\\w]+)\\s*=\\s*(\\S.*?(?=[;\\r\\n]));?\n */\nfunction _extends(Class,Super){\n\tvar pt = Class.prototype;\n\tif(!(pt instanceof Super)){\n\t\tfunction t(){};\n\t\tt.prototype = Super.prototype;\n\t\tt = new t();\n\t\tcopy(pt,t);\n\t\tClass.prototype = pt = t;\n\t}\n\tif(pt.constructor != Class){\n\t\tif(typeof Class != 'function'){\n\t\t\tconsole.error(\"unknown Class:\"+Class)\n\t\t}\n\t\tpt.constructor = Class\n\t}\n}\n\n// Node Types\nvar NodeType = {}\nvar ELEMENT_NODE                = NodeType.ELEMENT_NODE                = 1;\nvar ATTRIBUTE_NODE              = NodeType.ATTRIBUTE_NODE              = 2;\nvar TEXT_NODE                   = NodeType.TEXT_NODE                   = 3;\nvar CDATA_SECTION_NODE          = NodeType.CDATA_SECTION_NODE          = 4;\nvar ENTITY_REFERENCE_NODE       = NodeType.ENTITY_REFERENCE_NODE       = 5;\nvar ENTITY_NODE                 = NodeType.ENTITY_NODE                 = 6;\nvar PROCESSING_INSTRUCTION_NODE = NodeType.PROCESSING_INSTRUCTION_NODE = 7;\nvar COMMENT_NODE                = NodeType.COMMENT_NODE                = 8;\nvar DOCUMENT_NODE               = NodeType.DOCUMENT_NODE               = 9;\nvar DOCUMENT_TYPE_NODE          = NodeType.DOCUMENT_TYPE_NODE          = 10;\nvar DOCUMENT_FRAGMENT_NODE      = NodeType.DOCUMENT_FRAGMENT_NODE      = 11;\nvar NOTATION_NODE               = NodeType.NOTATION_NODE               = 12;\n\n// ExceptionCode\nvar ExceptionCode = {}\nvar ExceptionMessage = {};\nvar INDEX_SIZE_ERR              = ExceptionCode.INDEX_SIZE_ERR              = ((ExceptionMessage[1]=\"Index size error\"),1);\nvar DOMSTRING_SIZE_ERR          = ExceptionCode.DOMSTRING_SIZE_ERR          = ((ExceptionMessage[2]=\"DOMString size error\"),2);\nvar HIERARCHY_REQUEST_ERR       = ExceptionCode.HIERARCHY_REQUEST_ERR       = ((ExceptionMessage[3]=\"Hierarchy request error\"),3);\nvar WRONG_DOCUMENT_ERR          = ExceptionCode.WRONG_DOCUMENT_ERR          = ((ExceptionMessage[4]=\"Wrong document\"),4);\nvar INVALID_CHARACTER_ERR       = ExceptionCode.INVALID_CHARACTER_ERR       = ((ExceptionMessage[5]=\"Invalid character\"),5);\nvar NO_DATA_ALLOWED_ERR         = ExceptionCode.NO_DATA_ALLOWED_ERR         = ((ExceptionMessage[6]=\"No data allowed\"),6);\nvar NO_MODIFICATION_ALLOWED_ERR = ExceptionCode.NO_MODIFICATION_ALLOWED_ERR = ((ExceptionMessage[7]=\"No modification allowed\"),7);\nvar NOT_FOUND_ERR               = ExceptionCode.NOT_FOUND_ERR               = ((ExceptionMessage[8]=\"Not found\"),8);\nvar NOT_SUPPORTED_ERR           = ExceptionCode.NOT_SUPPORTED_ERR           = ((ExceptionMessage[9]=\"Not supported\"),9);\nvar INUSE_ATTRIBUTE_ERR         = ExceptionCode.INUSE_ATTRIBUTE_ERR         = ((ExceptionMessage[10]=\"Attribute in use\"),10);\n//level2\nvar INVALID_STATE_ERR        \t= ExceptionCode.INVALID_STATE_ERR        \t= ((ExceptionMessage[11]=\"Invalid state\"),11);\nvar SYNTAX_ERR               \t= ExceptionCode.SYNTAX_ERR               \t= ((ExceptionMessage[12]=\"Syntax error\"),12);\nvar INVALID_MODIFICATION_ERR \t= ExceptionCode.INVALID_MODIFICATION_ERR \t= ((ExceptionMessage[13]=\"Invalid modification\"),13);\nvar NAMESPACE_ERR            \t= ExceptionCode.NAMESPACE_ERR           \t= ((ExceptionMessage[14]=\"Invalid namespace\"),14);\nvar INVALID_ACCESS_ERR       \t= ExceptionCode.INVALID_ACCESS_ERR      \t= ((ExceptionMessage[15]=\"Invalid access\"),15);\n\n/**\n * DOM Level 2\n * Object DOMException\n * @see http://www.w3.org/TR/2000/REC-DOM-Level-2-Core-20001113/ecma-script-binding.html\n * @see http://www.w3.org/TR/REC-DOM-Level-1/ecma-script-language-binding.html\n */\nfunction DOMException(code, message) {\n\tif(message instanceof Error){\n\t\tvar error = message;\n\t}else{\n\t\terror = this;\n\t\tError.call(this, ExceptionMessage[code]);\n\t\tthis.message = ExceptionMessage[code];\n\t\tif(Error.captureStackTrace) Error.captureStackTrace(this, DOMException);\n\t}\n\terror.code = code;\n\tif(message) this.message = this.message + \": \" + message;\n\treturn error;\n};\nDOMException.prototype = Error.prototype;\ncopy(ExceptionCode,DOMException)\n\n/**\n * @see http://www.w3.org/TR/2000/REC-DOM-Level-2-Core-20001113/core.html#ID-536297177\n * The NodeList interface provides the abstraction of an ordered collection of nodes, without defining or constraining how this collection is implemented. NodeList objects in the DOM are live.\n * The items in the NodeList are accessible via an integral index, starting from 0.\n */\nfunction NodeList() {\n};\nNodeList.prototype = {\n\t/**\n\t * The number of nodes in the list. The range of valid child node indices is 0 to length-1 inclusive.\n\t * @standard level1\n\t */\n\tlength:0,\n\t/**\n\t * Returns the indexth item in the collection. If index is greater than or equal to the number of nodes in the list, this returns null.\n\t * @standard level1\n\t * @param index  unsigned long\n\t *   Index into the collection.\n\t * @return Node\n\t * \tThe node at the indexth position in the NodeList, or null if that is not a valid index.\n\t */\n\titem: function(index) {\n\t\treturn this[index] || null;\n\t},\n\ttoString:function(isHTML,nodeFilter){\n\t\tfor(var buf = [], i = 0;i<this.length;i++){\n\t\t\tserializeToString(this[i],buf,isHTML,nodeFilter);\n\t\t}\n\t\treturn buf.join('');\n\t},\n\t/**\n\t * @private\n\t * @param {function (Node):boolean} predicate\n\t * @returns {Node[]}\n\t */\n\tfilter: function (predicate) {\n\t\treturn Array.prototype.filter.call(this, predicate);\n\t},\n\t/**\n\t * @private\n\t * @param {Node} item\n\t * @returns {number}\n\t */\n\tindexOf: function (item) {\n\t\treturn Array.prototype.indexOf.call(this, item);\n\t},\n};\n\nfunction LiveNodeList(node,refresh){\n\tthis._node = node;\n\tthis._refresh = refresh\n\t_updateLiveList(this);\n}\nfunction _updateLiveList(list){\n\tvar inc = list._node._inc || list._node.ownerDocument._inc;\n\tif(list._inc != inc){\n\t\tvar ls = list._refresh(list._node);\n\t\t//console.log(ls.length)\n\t\t__set__(list,'length',ls.length);\n\t\tcopy(ls,list);\n\t\tlist._inc = inc;\n\t}\n}\nLiveNodeList.prototype.item = function(i){\n\t_updateLiveList(this);\n\treturn this[i];\n}\n\n_extends(LiveNodeList,NodeList);\n\n/**\n * Objects implementing the NamedNodeMap interface are used\n * to represent collections of nodes that can be accessed by name.\n * Note that NamedNodeMap does not inherit from NodeList;\n * NamedNodeMaps are not maintained in any particular order.\n * Objects contained in an object implementing NamedNodeMap may also be accessed by an ordinal index,\n * but this is simply to allow convenient enumeration of the contents of a NamedNodeMap,\n * and does not imply that the DOM specifies an order to these Nodes.\n * NamedNodeMap objects in the DOM are live.\n * used for attributes or DocumentType entities\n */\nfunction NamedNodeMap() {\n};\n\nfunction _findNodeIndex(list,node){\n\tvar i = list.length;\n\twhile(i--){\n\t\tif(list[i] === node){return i}\n\t}\n}\n\nfunction _addNamedNode(el,list,newAttr,oldAttr){\n\tif(oldAttr){\n\t\tlist[_findNodeIndex(list,oldAttr)] = newAttr;\n\t}else{\n\t\tlist[list.length++] = newAttr;\n\t}\n\tif(el){\n\t\tnewAttr.ownerElement = el;\n\t\tvar doc = el.ownerDocument;\n\t\tif(doc){\n\t\t\toldAttr && _onRemoveAttribute(doc,el,oldAttr);\n\t\t\t_onAddAttribute(doc,el,newAttr);\n\t\t}\n\t}\n}\nfunction _removeNamedNode(el,list,attr){\n\t//console.log('remove attr:'+attr)\n\tvar i = _findNodeIndex(list,attr);\n\tif(i>=0){\n\t\tvar lastIndex = list.length-1\n\t\twhile(i<lastIndex){\n\t\t\tlist[i] = list[++i]\n\t\t}\n\t\tlist.length = lastIndex;\n\t\tif(el){\n\t\t\tvar doc = el.ownerDocument;\n\t\t\tif(doc){\n\t\t\t\t_onRemoveAttribute(doc,el,attr);\n\t\t\t\tattr.ownerElement = null;\n\t\t\t}\n\t\t}\n\t}else{\n\t\tthrow new DOMException(NOT_FOUND_ERR,new Error(el.tagName+'@'+attr))\n\t}\n}\nNamedNodeMap.prototype = {\n\tlength:0,\n\titem:NodeList.prototype.item,\n\tgetNamedItem: function(key) {\n//\t\tif(key.indexOf(':')>0 || key == 'xmlns'){\n//\t\t\treturn null;\n//\t\t}\n\t\t//console.log()\n\t\tvar i = this.length;\n\t\twhile(i--){\n\t\t\tvar attr = this[i];\n\t\t\t//console.log(attr.nodeName,key)\n\t\t\tif(attr.nodeName == key){\n\t\t\t\treturn attr;\n\t\t\t}\n\t\t}\n\t},\n\tsetNamedItem: function(attr) {\n\t\tvar el = attr.ownerElement;\n\t\tif(el && el!=this._ownerElement){\n\t\t\tthrow new DOMException(INUSE_ATTRIBUTE_ERR);\n\t\t}\n\t\tvar oldAttr = this.getNamedItem(attr.nodeName);\n\t\t_addNamedNode(this._ownerElement,this,attr,oldAttr);\n\t\treturn oldAttr;\n\t},\n\t/* returns Node */\n\tsetNamedItemNS: function(attr) {// raises: WRONG_DOCUMENT_ERR,NO_MODIFICATION_ALLOWED_ERR,INUSE_ATTRIBUTE_ERR\n\t\tvar el = attr.ownerElement, oldAttr;\n\t\tif(el && el!=this._ownerElement){\n\t\t\tthrow new DOMException(INUSE_ATTRIBUTE_ERR);\n\t\t}\n\t\toldAttr = this.getNamedItemNS(attr.namespaceURI,attr.localName);\n\t\t_addNamedNode(this._ownerElement,this,attr,oldAttr);\n\t\treturn oldAttr;\n\t},\n\n\t/* returns Node */\n\tremoveNamedItem: function(key) {\n\t\tvar attr = this.getNamedItem(key);\n\t\t_removeNamedNode(this._ownerElement,this,attr);\n\t\treturn attr;\n\n\n\t},// raises: NOT_FOUND_ERR,NO_MODIFICATION_ALLOWED_ERR\n\n\t//for level2\n\tremoveNamedItemNS:function(namespaceURI,localName){\n\t\tvar attr = this.getNamedItemNS(namespaceURI,localName);\n\t\t_removeNamedNode(this._ownerElement,this,attr);\n\t\treturn attr;\n\t},\n\tgetNamedItemNS: function(namespaceURI, localName) {\n\t\tvar i = this.length;\n\t\twhile(i--){\n\t\t\tvar node = this[i];\n\t\t\tif(node.localName == localName && node.namespaceURI == namespaceURI){\n\t\t\t\treturn node;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n};\n\n/**\n * The DOMImplementation interface represents an object providing methods\n * which are not dependent on any particular document.\n * Such an object is returned by the `Document.implementation` property.\n *\n * __The individual methods describe the differences compared to the specs.__\n *\n * @constructor\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/DOMImplementation MDN\n * @see https://www.w3.org/TR/REC-DOM-Level-1/level-one-core.html#ID-102161490 DOM Level 1 Core (Initial)\n * @see https://www.w3.org/TR/DOM-Level-2-Core/core.html#ID-102161490 DOM Level 2 Core\n * @see https://www.w3.org/TR/DOM-Level-3-Core/core.html#ID-102161490 DOM Level 3 Core\n * @see https://dom.spec.whatwg.org/#domimplementation DOM Living Standard\n */\nfunction DOMImplementation() {\n}\n\nDOMImplementation.prototype = {\n\t/**\n\t * The DOMImplementation.hasFeature() method returns a Boolean flag indicating if a given feature is supported.\n\t * The different implementations fairly diverged in what kind of features were reported.\n\t * The latest version of the spec settled to force this method to always return true, where the functionality was accurate and in use.\n\t *\n\t * @deprecated It is deprecated and modern browsers return true in all cases.\n\t *\n\t * @param {string} feature\n\t * @param {string} [version]\n\t * @returns {boolean} always true\n\t *\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/DOMImplementation/hasFeature MDN\n\t * @see https://www.w3.org/TR/REC-DOM-Level-1/level-one-core.html#ID-5CED94D7 DOM Level 1 Core\n\t * @see https://dom.spec.whatwg.org/#dom-domimplementation-hasfeature DOM Living Standard\n\t */\n\thasFeature: function(feature, version) {\n\t\t\treturn true;\n\t},\n\t/**\n\t * Creates an XML Document object of the specified type with its document element.\n\t *\n\t * __It behaves slightly different from the description in the living standard__:\n\t * - There is no interface/class `XMLDocument`, it returns a `Document` instance.\n\t * - `contentType`, `encoding`, `mode`, `origin`, `url` fields are currently not declared.\n\t * - this implementation is not validating names or qualified names\n\t *   (when parsing XML strings, the SAX parser takes care of that)\n\t *\n\t * @param {string|null} namespaceURI\n\t * @param {string} qualifiedName\n\t * @param {DocumentType=null} doctype\n\t * @returns {Document}\n\t *\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/DOMImplementation/createDocument MDN\n\t * @see https://www.w3.org/TR/DOM-Level-2-Core/core.html#Level-2-Core-DOM-createDocument DOM Level 2 Core (initial)\n\t * @see https://dom.spec.whatwg.org/#dom-domimplementation-createdocument  DOM Level 2 Core\n\t *\n\t * @see https://dom.spec.whatwg.org/#validate-and-extract DOM: Validate and extract\n\t * @see https://www.w3.org/TR/xml/#NT-NameStartChar XML Spec: Names\n\t * @see https://www.w3.org/TR/xml-names/#ns-qualnames XML Namespaces: Qualified names\n\t */\n\tcreateDocument: function(namespaceURI,  qualifiedName, doctype){\n\t\tvar doc = new Document();\n\t\tdoc.implementation = this;\n\t\tdoc.childNodes = new NodeList();\n\t\tdoc.doctype = doctype || null;\n\t\tif (doctype){\n\t\t\tdoc.appendChild(doctype);\n\t\t}\n\t\tif (qualifiedName){\n\t\t\tvar root = doc.createElementNS(namespaceURI, qualifiedName);\n\t\t\tdoc.appendChild(root);\n\t\t}\n\t\treturn doc;\n\t},\n\t/**\n\t * Returns a doctype, with the given `qualifiedName`, `publicId`, and `systemId`.\n\t *\n\t * __This behavior is slightly different from the in the specs__:\n\t * - this implementation is not validating names or qualified names\n\t *   (when parsing XML strings, the SAX parser takes care of that)\n\t *\n\t * @param {string} qualifiedName\n\t * @param {string} [publicId]\n\t * @param {string} [systemId]\n\t * @returns {DocumentType} which can either be used with `DOMImplementation.createDocument` upon document creation\n\t * \t\t\t\t  or can be put into the document via methods like `Node.insertBefore()` or `Node.replaceChild()`\n\t *\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/DOMImplementation/createDocumentType MDN\n\t * @see https://www.w3.org/TR/DOM-Level-2-Core/core.html#Level-2-Core-DOM-createDocType DOM Level 2 Core\n\t * @see https://dom.spec.whatwg.org/#dom-domimplementation-createdocumenttype DOM Living Standard\n\t *\n\t * @see https://dom.spec.whatwg.org/#validate-and-extract DOM: Validate and extract\n\t * @see https://www.w3.org/TR/xml/#NT-NameStartChar XML Spec: Names\n\t * @see https://www.w3.org/TR/xml-names/#ns-qualnames XML Namespaces: Qualified names\n\t */\n\tcreateDocumentType: function(qualifiedName, publicId, systemId){\n\t\tvar node = new DocumentType();\n\t\tnode.name = qualifiedName;\n\t\tnode.nodeName = qualifiedName;\n\t\tnode.publicId = publicId || '';\n\t\tnode.systemId = systemId || '';\n\n\t\treturn node;\n\t}\n};\n\n\n/**\n * @see http://www.w3.org/TR/2000/REC-DOM-Level-2-Core-20001113/core.html#ID-1950641247\n */\n\nfunction Node() {\n};\n\nNode.prototype = {\n\tfirstChild : null,\n\tlastChild : null,\n\tpreviousSibling : null,\n\tnextSibling : null,\n\tattributes : null,\n\tparentNode : null,\n\tchildNodes : null,\n\townerDocument : null,\n\tnodeValue : null,\n\tnamespaceURI : null,\n\tprefix : null,\n\tlocalName : null,\n\t// Modified in DOM Level 2:\n\tinsertBefore:function(newChild, refChild){//raises\n\t\treturn _insertBefore(this,newChild,refChild);\n\t},\n\treplaceChild:function(newChild, oldChild){//raises\n\t\t_insertBefore(this, newChild,oldChild, assertPreReplacementValidityInDocument);\n\t\tif(oldChild){\n\t\t\tthis.removeChild(oldChild);\n\t\t}\n\t},\n\tremoveChild:function(oldChild){\n\t\treturn _removeChild(this,oldChild);\n\t},\n\tappendChild:function(newChild){\n\t\treturn this.insertBefore(newChild,null);\n\t},\n\thasChildNodes:function(){\n\t\treturn this.firstChild != null;\n\t},\n\tcloneNode:function(deep){\n\t\treturn cloneNode(this.ownerDocument||this,this,deep);\n\t},\n\t// Modified in DOM Level 2:\n\tnormalize:function(){\n\t\tvar child = this.firstChild;\n\t\twhile(child){\n\t\t\tvar next = child.nextSibling;\n\t\t\tif(next && next.nodeType == TEXT_NODE && child.nodeType == TEXT_NODE){\n\t\t\t\tthis.removeChild(next);\n\t\t\t\tchild.appendData(next.data);\n\t\t\t}else{\n\t\t\t\tchild.normalize();\n\t\t\t\tchild = next;\n\t\t\t}\n\t\t}\n\t},\n  \t// Introduced in DOM Level 2:\n\tisSupported:function(feature, version){\n\t\treturn this.ownerDocument.implementation.hasFeature(feature,version);\n\t},\n    // Introduced in DOM Level 2:\n    hasAttributes:function(){\n    \treturn this.attributes.length>0;\n    },\n\t/**\n\t * Look up the prefix associated to the given namespace URI, starting from this node.\n\t * **The default namespace declarations are ignored by this method.**\n\t * See Namespace Prefix Lookup for details on the algorithm used by this method.\n\t *\n\t * _Note: The implementation seems to be incomplete when compared to the algorithm described in the specs._\n\t *\n\t * @param {string | null} namespaceURI\n\t * @returns {string | null}\n\t * @see https://www.w3.org/TR/DOM-Level-3-Core/core.html#Node3-lookupNamespacePrefix\n\t * @see https://www.w3.org/TR/DOM-Level-3-Core/namespaces-algorithms.html#lookupNamespacePrefixAlgo\n\t * @see https://dom.spec.whatwg.org/#dom-node-lookupprefix\n\t * @see https://github.com/xmldom/xmldom/issues/322\n\t */\n    lookupPrefix:function(namespaceURI){\n    \tvar el = this;\n    \twhile(el){\n    \t\tvar map = el._nsMap;\n    \t\t//console.dir(map)\n    \t\tif(map){\n    \t\t\tfor(var n in map){\n\t\t\t\t\t\tif (Object.prototype.hasOwnProperty.call(map, n) && map[n] === namespaceURI) {\n\t\t\t\t\t\t\treturn n;\n\t\t\t\t\t\t}\n    \t\t\t}\n    \t\t}\n    \t\tel = el.nodeType == ATTRIBUTE_NODE?el.ownerDocument : el.parentNode;\n    \t}\n    \treturn null;\n    },\n    // Introduced in DOM Level 3:\n    lookupNamespaceURI:function(prefix){\n    \tvar el = this;\n    \twhile(el){\n    \t\tvar map = el._nsMap;\n    \t\t//console.dir(map)\n    \t\tif(map){\n    \t\t\tif(Object.prototype.hasOwnProperty.call(map, prefix)){\n    \t\t\t\treturn map[prefix] ;\n    \t\t\t}\n    \t\t}\n    \t\tel = el.nodeType == ATTRIBUTE_NODE?el.ownerDocument : el.parentNode;\n    \t}\n    \treturn null;\n    },\n    // Introduced in DOM Level 3:\n    isDefaultNamespace:function(namespaceURI){\n    \tvar prefix = this.lookupPrefix(namespaceURI);\n    \treturn prefix == null;\n    }\n};\n\n\nfunction _xmlEncoder(c){\n\treturn c == '<' && '&lt;' ||\n         c == '>' && '&gt;' ||\n         c == '&' && '&amp;' ||\n         c == '\"' && '&quot;' ||\n         '&#'+c.charCodeAt()+';'\n}\n\n\ncopy(NodeType,Node);\ncopy(NodeType,Node.prototype);\n\n/**\n * @param callback return true for continue,false for break\n * @return boolean true: break visit;\n */\nfunction _visitNode(node,callback){\n\tif(callback(node)){\n\t\treturn true;\n\t}\n\tif(node = node.firstChild){\n\t\tdo{\n\t\t\tif(_visitNode(node,callback)){return true}\n        }while(node=node.nextSibling)\n    }\n}\n\n\n\nfunction Document(){\n\tthis.ownerDocument = this;\n}\n\nfunction _onAddAttribute(doc,el,newAttr){\n\tdoc && doc._inc++;\n\tvar ns = newAttr.namespaceURI ;\n\tif(ns === NAMESPACE.XMLNS){\n\t\t//update namespace\n\t\tel._nsMap[newAttr.prefix?newAttr.localName:''] = newAttr.value\n\t}\n}\n\nfunction _onRemoveAttribute(doc,el,newAttr,remove){\n\tdoc && doc._inc++;\n\tvar ns = newAttr.namespaceURI ;\n\tif(ns === NAMESPACE.XMLNS){\n\t\t//update namespace\n\t\tdelete el._nsMap[newAttr.prefix?newAttr.localName:'']\n\t}\n}\n\n/**\n * Updates `el.childNodes`, updating the indexed items and it's `length`.\n * Passing `newChild` means it will be appended.\n * Otherwise it's assumed that an item has been removed,\n * and `el.firstNode` and it's `.nextSibling` are used\n * to walk the current list of child nodes.\n *\n * @param {Document} doc\n * @param {Node} el\n * @param {Node} [newChild]\n * @private\n */\nfunction _onUpdateChild (doc, el, newChild) {\n\tif(doc && doc._inc){\n\t\tdoc._inc++;\n\t\t//update childNodes\n\t\tvar cs = el.childNodes;\n\t\tif (newChild) {\n\t\t\tcs[cs.length++] = newChild;\n\t\t} else {\n\t\t\tvar child = el.firstChild;\n\t\t\tvar i = 0;\n\t\t\twhile (child) {\n\t\t\t\tcs[i++] = child;\n\t\t\t\tchild = child.nextSibling;\n\t\t\t}\n\t\t\tcs.length = i;\n\t\t\tdelete cs[cs.length];\n\t\t}\n\t}\n}\n\n/**\n * Removes the connections between `parentNode` and `child`\n * and any existing `child.previousSibling` or `child.nextSibling`.\n *\n * @see https://github.com/xmldom/xmldom/issues/135\n * @see https://github.com/xmldom/xmldom/issues/145\n *\n * @param {Node} parentNode\n * @param {Node} child\n * @returns {Node} the child that was removed.\n * @private\n */\nfunction _removeChild (parentNode, child) {\n\tvar previous = child.previousSibling;\n\tvar next = child.nextSibling;\n\tif (previous) {\n\t\tprevious.nextSibling = next;\n\t} else {\n\t\tparentNode.firstChild = next;\n\t}\n\tif (next) {\n\t\tnext.previousSibling = previous;\n\t} else {\n\t\tparentNode.lastChild = previous;\n\t}\n\tchild.parentNode = null;\n\tchild.previousSibling = null;\n\tchild.nextSibling = null;\n\t_onUpdateChild(parentNode.ownerDocument, parentNode);\n\treturn child;\n}\n\n/**\n * Returns `true` if `node` can be a parent for insertion.\n * @param {Node} node\n * @returns {boolean}\n */\nfunction hasValidParentNodeType(node) {\n\treturn (\n\t\tnode &&\n\t\t(node.nodeType === Node.DOCUMENT_NODE || node.nodeType === Node.DOCUMENT_FRAGMENT_NODE || node.nodeType === Node.ELEMENT_NODE)\n\t);\n}\n\n/**\n * Returns `true` if `node` can be inserted according to it's `nodeType`.\n * @param {Node} node\n * @returns {boolean}\n */\nfunction hasInsertableNodeType(node) {\n\treturn (\n\t\tnode &&\n\t\t(isElementNode(node) ||\n\t\t\tisTextNode(node) ||\n\t\t\tisDocTypeNode(node) ||\n\t\t\tnode.nodeType === Node.DOCUMENT_FRAGMENT_NODE ||\n\t\t\tnode.nodeType === Node.COMMENT_NODE ||\n\t\t\tnode.nodeType === Node.PROCESSING_INSTRUCTION_NODE)\n\t);\n}\n\n/**\n * Returns true if `node` is a DOCTYPE node\n * @param {Node} node\n * @returns {boolean}\n */\nfunction isDocTypeNode(node) {\n\treturn node && node.nodeType === Node.DOCUMENT_TYPE_NODE;\n}\n\n/**\n * Returns true if the node is an element\n * @param {Node} node\n * @returns {boolean}\n */\nfunction isElementNode(node) {\n\treturn node && node.nodeType === Node.ELEMENT_NODE;\n}\n/**\n * Returns true if `node` is a text node\n * @param {Node} node\n * @returns {boolean}\n */\nfunction isTextNode(node) {\n\treturn node && node.nodeType === Node.TEXT_NODE;\n}\n\n/**\n * Check if en element node can be inserted before `child`, or at the end if child is falsy,\n * according to the presence and position of a doctype node on the same level.\n *\n * @param {Document} doc The document node\n * @param {Node} child the node that would become the nextSibling if the element would be inserted\n * @returns {boolean} `true` if an element can be inserted before child\n * @private\n * https://dom.spec.whatwg.org/#concept-node-ensure-pre-insertion-validity\n */\nfunction isElementInsertionPossible(doc, child) {\n\tvar parentChildNodes = doc.childNodes || [];\n\tif (find(parentChildNodes, isElementNode) || isDocTypeNode(child)) {\n\t\treturn false;\n\t}\n\tvar docTypeNode = find(parentChildNodes, isDocTypeNode);\n\treturn !(child && docTypeNode && parentChildNodes.indexOf(docTypeNode) > parentChildNodes.indexOf(child));\n}\n\n/**\n * Check if en element node can be inserted before `child`, or at the end if child is falsy,\n * according to the presence and position of a doctype node on the same level.\n *\n * @param {Node} doc The document node\n * @param {Node} child the node that would become the nextSibling if the element would be inserted\n * @returns {boolean} `true` if an element can be inserted before child\n * @private\n * https://dom.spec.whatwg.org/#concept-node-ensure-pre-insertion-validity\n */\nfunction isElementReplacementPossible(doc, child) {\n\tvar parentChildNodes = doc.childNodes || [];\n\n\tfunction hasElementChildThatIsNotChild(node) {\n\t\treturn isElementNode(node) && node !== child;\n\t}\n\n\tif (find(parentChildNodes, hasElementChildThatIsNotChild)) {\n\t\treturn false;\n\t}\n\tvar docTypeNode = find(parentChildNodes, isDocTypeNode);\n\treturn !(child && docTypeNode && parentChildNodes.indexOf(docTypeNode) > parentChildNodes.indexOf(child));\n}\n\n/**\n * @private\n * Steps 1-5 of the checks before inserting and before replacing a child are the same.\n *\n * @param {Node} parent the parent node to insert `node` into\n * @param {Node} node the node to insert\n * @param {Node=} child the node that should become the `nextSibling` of `node`\n * @returns {Node}\n * @throws DOMException for several node combinations that would create a DOM that is not well-formed.\n * @throws DOMException if `child` is provided but is not a child of `parent`.\n * @see https://dom.spec.whatwg.org/#concept-node-ensure-pre-insertion-validity\n * @see https://dom.spec.whatwg.org/#concept-node-replace\n */\nfunction assertPreInsertionValidity1to5(parent, node, child) {\n\t// 1. If `parent` is not a Document, DocumentFragment, or Element node, then throw a \"HierarchyRequestError\" DOMException.\n\tif (!hasValidParentNodeType(parent)) {\n\t\tthrow new DOMException(HIERARCHY_REQUEST_ERR, 'Unexpected parent node type ' + parent.nodeType);\n\t}\n\t// 2. If `node` is a host-including inclusive ancestor of `parent`, then throw a \"HierarchyRequestError\" DOMException.\n\t// not implemented!\n\t// 3. If `child` is non-null and its parent is not `parent`, then throw a \"NotFoundError\" DOMException.\n\tif (child && child.parentNode !== parent) {\n\t\tthrow new DOMException(NOT_FOUND_ERR, 'child not in parent');\n\t}\n\tif (\n\t\t// 4. If `node` is not a DocumentFragment, DocumentType, Element, or CharacterData node, then throw a \"HierarchyRequestError\" DOMException.\n\t\t!hasInsertableNodeType(node) ||\n\t\t// 5. If either `node` is a Text node and `parent` is a document,\n\t\t// the sax parser currently adds top level text nodes, this will be fixed in 0.9.0\n\t\t// || (node.nodeType === Node.TEXT_NODE && parent.nodeType === Node.DOCUMENT_NODE)\n\t\t// or `node` is a doctype and `parent` is not a document, then throw a \"HierarchyRequestError\" DOMException.\n\t\t(isDocTypeNode(node) && parent.nodeType !== Node.DOCUMENT_NODE)\n\t) {\n\t\tthrow new DOMException(\n\t\t\tHIERARCHY_REQUEST_ERR,\n\t\t\t'Unexpected node type ' + node.nodeType + ' for parent node type ' + parent.nodeType\n\t\t);\n\t}\n}\n\n/**\n * @private\n * Step 6 of the checks before inserting and before replacing a child are different.\n *\n * @param {Document} parent the parent node to insert `node` into\n * @param {Node} node the node to insert\n * @param {Node | undefined} child the node that should become the `nextSibling` of `node`\n * @returns {Node}\n * @throws DOMException for several node combinations that would create a DOM that is not well-formed.\n * @throws DOMException if `child` is provided but is not a child of `parent`.\n * @see https://dom.spec.whatwg.org/#concept-node-ensure-pre-insertion-validity\n * @see https://dom.spec.whatwg.org/#concept-node-replace\n */\nfunction assertPreInsertionValidityInDocument(parent, node, child) {\n\tvar parentChildNodes = parent.childNodes || [];\n\tvar nodeChildNodes = node.childNodes || [];\n\n\t// DocumentFragment\n\tif (node.nodeType === Node.DOCUMENT_FRAGMENT_NODE) {\n\t\tvar nodeChildElements = nodeChildNodes.filter(isElementNode);\n\t\t// If node has more than one element child or has a Text node child.\n\t\tif (nodeChildElements.length > 1 || find(nodeChildNodes, isTextNode)) {\n\t\t\tthrow new DOMException(HIERARCHY_REQUEST_ERR, 'More than one element or text in fragment');\n\t\t}\n\t\t// Otherwise, if `node` has one element child and either `parent` has an element child,\n\t\t// `child` is a doctype, or `child` is non-null and a doctype is following `child`.\n\t\tif (nodeChildElements.length === 1 && !isElementInsertionPossible(parent, child)) {\n\t\t\tthrow new DOMException(HIERARCHY_REQUEST_ERR, 'Element in fragment can not be inserted before doctype');\n\t\t}\n\t}\n\t// Element\n\tif (isElementNode(node)) {\n\t\t// `parent` has an element child, `child` is a doctype,\n\t\t// or `child` is non-null and a doctype is following `child`.\n\t\tif (!isElementInsertionPossible(parent, child)) {\n\t\t\tthrow new DOMException(HIERARCHY_REQUEST_ERR, 'Only one element can be added and only after doctype');\n\t\t}\n\t}\n\t// DocumentType\n\tif (isDocTypeNode(node)) {\n\t\t// `parent` has a doctype child,\n\t\tif (find(parentChildNodes, isDocTypeNode)) {\n\t\t\tthrow new DOMException(HIERARCHY_REQUEST_ERR, 'Only one doctype is allowed');\n\t\t}\n\t\tvar parentElementChild = find(parentChildNodes, isElementNode);\n\t\t// `child` is non-null and an element is preceding `child`,\n\t\tif (child && parentChildNodes.indexOf(parentElementChild) < parentChildNodes.indexOf(child)) {\n\t\t\tthrow new DOMException(HIERARCHY_REQUEST_ERR, 'Doctype can only be inserted before an element');\n\t\t}\n\t\t// or `child` is null and `parent` has an element child.\n\t\tif (!child && parentElementChild) {\n\t\t\tthrow new DOMException(HIERARCHY_REQUEST_ERR, 'Doctype can not be appended since element is present');\n\t\t}\n\t}\n}\n\n/**\n * @private\n * Step 6 of the checks before inserting and before replacing a child are different.\n *\n * @param {Document} parent the parent node to insert `node` into\n * @param {Node} node the node to insert\n * @param {Node | undefined} child the node that should become the `nextSibling` of `node`\n * @returns {Node}\n * @throws DOMException for several node combinations that would create a DOM that is not well-formed.\n * @throws DOMException if `child` is provided but is not a child of `parent`.\n * @see https://dom.spec.whatwg.org/#concept-node-ensure-pre-insertion-validity\n * @see https://dom.spec.whatwg.org/#concept-node-replace\n */\nfunction assertPreReplacementValidityInDocument(parent, node, child) {\n\tvar parentChildNodes = parent.childNodes || [];\n\tvar nodeChildNodes = node.childNodes || [];\n\n\t// DocumentFragment\n\tif (node.nodeType === Node.DOCUMENT_FRAGMENT_NODE) {\n\t\tvar nodeChildElements = nodeChildNodes.filter(isElementNode);\n\t\t// If `node` has more than one element child or has a Text node child.\n\t\tif (nodeChildElements.length > 1 || find(nodeChildNodes, isTextNode)) {\n\t\t\tthrow new DOMException(HIERARCHY_REQUEST_ERR, 'More than one element or text in fragment');\n\t\t}\n\t\t// Otherwise, if `node` has one element child and either `parent` has an element child that is not `child` or a doctype is following `child`.\n\t\tif (nodeChildElements.length === 1 && !isElementReplacementPossible(parent, child)) {\n\t\t\tthrow new DOMException(HIERARCHY_REQUEST_ERR, 'Element in fragment can not be inserted before doctype');\n\t\t}\n\t}\n\t// Element\n\tif (isElementNode(node)) {\n\t\t// `parent` has an element child that is not `child` or a doctype is following `child`.\n\t\tif (!isElementReplacementPossible(parent, child)) {\n\t\t\tthrow new DOMException(HIERARCHY_REQUEST_ERR, 'Only one element can be added and only after doctype');\n\t\t}\n\t}\n\t// DocumentType\n\tif (isDocTypeNode(node)) {\n\t\tfunction hasDoctypeChildThatIsNotChild(node) {\n\t\t\treturn isDocTypeNode(node) && node !== child;\n\t\t}\n\n\t\t// `parent` has a doctype child that is not `child`,\n\t\tif (find(parentChildNodes, hasDoctypeChildThatIsNotChild)) {\n\t\t\tthrow new DOMException(HIERARCHY_REQUEST_ERR, 'Only one doctype is allowed');\n\t\t}\n\t\tvar parentElementChild = find(parentChildNodes, isElementNode);\n\t\t// or an element is preceding `child`.\n\t\tif (child && parentChildNodes.indexOf(parentElementChild) < parentChildNodes.indexOf(child)) {\n\t\t\tthrow new DOMException(HIERARCHY_REQUEST_ERR, 'Doctype can only be inserted before an element');\n\t\t}\n\t}\n}\n\n/**\n * @private\n * @param {Node} parent the parent node to insert `node` into\n * @param {Node} node the node to insert\n * @param {Node=} child the node that should become the `nextSibling` of `node`\n * @returns {Node}\n * @throws DOMException for several node combinations that would create a DOM that is not well-formed.\n * @throws DOMException if `child` is provided but is not a child of `parent`.\n * @see https://dom.spec.whatwg.org/#concept-node-ensure-pre-insertion-validity\n */\nfunction _insertBefore(parent, node, child, _inDocumentAssertion) {\n\t// To ensure pre-insertion validity of a node into a parent before a child, run these steps:\n\tassertPreInsertionValidity1to5(parent, node, child);\n\n\t// If parent is a document, and any of the statements below, switched on the interface node implements,\n\t// are true, then throw a \"HierarchyRequestError\" DOMException.\n\tif (parent.nodeType === Node.DOCUMENT_NODE) {\n\t\t(_inDocumentAssertion || assertPreInsertionValidityInDocument)(parent, node, child);\n\t}\n\n\tvar cp = node.parentNode;\n\tif(cp){\n\t\tcp.removeChild(node);//remove and update\n\t}\n\tif(node.nodeType === DOCUMENT_FRAGMENT_NODE){\n\t\tvar newFirst = node.firstChild;\n\t\tif (newFirst == null) {\n\t\t\treturn node;\n\t\t}\n\t\tvar newLast = node.lastChild;\n\t}else{\n\t\tnewFirst = newLast = node;\n\t}\n\tvar pre = child ? child.previousSibling : parent.lastChild;\n\n\tnewFirst.previousSibling = pre;\n\tnewLast.nextSibling = child;\n\n\n\tif(pre){\n\t\tpre.nextSibling = newFirst;\n\t}else{\n\t\tparent.firstChild = newFirst;\n\t}\n\tif(child == null){\n\t\tparent.lastChild = newLast;\n\t}else{\n\t\tchild.previousSibling = newLast;\n\t}\n\tdo{\n\t\tnewFirst.parentNode = parent;\n\t}while(newFirst !== newLast && (newFirst= newFirst.nextSibling))\n\t_onUpdateChild(parent.ownerDocument||parent, parent);\n\t//console.log(parent.lastChild.nextSibling == null)\n\tif (node.nodeType == DOCUMENT_FRAGMENT_NODE) {\n\t\tnode.firstChild = node.lastChild = null;\n\t}\n\treturn node;\n}\n\n/**\n * Appends `newChild` to `parentNode`.\n * If `newChild` is already connected to a `parentNode` it is first removed from it.\n *\n * @see https://github.com/xmldom/xmldom/issues/135\n * @see https://github.com/xmldom/xmldom/issues/145\n * @param {Node} parentNode\n * @param {Node} newChild\n * @returns {Node}\n * @private\n */\nfunction _appendSingleChild (parentNode, newChild) {\n\tif (newChild.parentNode) {\n\t\tnewChild.parentNode.removeChild(newChild);\n\t}\n\tnewChild.parentNode = parentNode;\n\tnewChild.previousSibling = parentNode.lastChild;\n\tnewChild.nextSibling = null;\n\tif (newChild.previousSibling) {\n\t\tnewChild.previousSibling.nextSibling = newChild;\n\t} else {\n\t\tparentNode.firstChild = newChild;\n\t}\n\tparentNode.lastChild = newChild;\n\t_onUpdateChild(parentNode.ownerDocument, parentNode, newChild);\n\treturn newChild;\n}\n\nDocument.prototype = {\n\t//implementation : null,\n\tnodeName :  '#document',\n\tnodeType :  DOCUMENT_NODE,\n\t/**\n\t * The DocumentType node of the document.\n\t *\n\t * @readonly\n\t * @type DocumentType\n\t */\n\tdoctype :  null,\n\tdocumentElement :  null,\n\t_inc : 1,\n\n\tinsertBefore :  function(newChild, refChild){//raises\n\t\tif(newChild.nodeType == DOCUMENT_FRAGMENT_NODE){\n\t\t\tvar child = newChild.firstChild;\n\t\t\twhile(child){\n\t\t\t\tvar next = child.nextSibling;\n\t\t\t\tthis.insertBefore(child,refChild);\n\t\t\t\tchild = next;\n\t\t\t}\n\t\t\treturn newChild;\n\t\t}\n\t\t_insertBefore(this, newChild, refChild);\n\t\tnewChild.ownerDocument = this;\n\t\tif (this.documentElement === null && newChild.nodeType === ELEMENT_NODE) {\n\t\t\tthis.documentElement = newChild;\n\t\t}\n\n\t\treturn newChild;\n\t},\n\tremoveChild :  function(oldChild){\n\t\tif(this.documentElement == oldChild){\n\t\t\tthis.documentElement = null;\n\t\t}\n\t\treturn _removeChild(this,oldChild);\n\t},\n\treplaceChild: function (newChild, oldChild) {\n\t\t//raises\n\t\t_insertBefore(this, newChild, oldChild, assertPreReplacementValidityInDocument);\n\t\tnewChild.ownerDocument = this;\n\t\tif (oldChild) {\n\t\t\tthis.removeChild(oldChild);\n\t\t}\n\t\tif (isElementNode(newChild)) {\n\t\t\tthis.documentElement = newChild;\n\t\t}\n\t},\n\t// Introduced in DOM Level 2:\n\timportNode : function(importedNode,deep){\n\t\treturn importNode(this,importedNode,deep);\n\t},\n\t// Introduced in DOM Level 2:\n\tgetElementById :\tfunction(id){\n\t\tvar rtv = null;\n\t\t_visitNode(this.documentElement,function(node){\n\t\t\tif(node.nodeType == ELEMENT_NODE){\n\t\t\t\tif(node.getAttribute('id') == id){\n\t\t\t\t\trtv = node;\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t\treturn rtv;\n\t},\n\n\t/**\n\t * The `getElementsByClassName` method of `Document` interface returns an array-like object\n\t * of all child elements which have **all** of the given class name(s).\n\t *\n\t * Returns an empty list if `classeNames` is an empty string or only contains HTML white space characters.\n\t *\n\t *\n\t * Warning: This is a live LiveNodeList.\n\t * Changes in the DOM will reflect in the array as the changes occur.\n\t * If an element selected by this array no longer qualifies for the selector,\n\t * it will automatically be removed. Be aware of this for iteration purposes.\n\t *\n\t * @param {string} classNames is a string representing the class name(s) to match; multiple class names are separated by (ASCII-)whitespace\n\t *\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/Document/getElementsByClassName\n\t * @see https://dom.spec.whatwg.org/#concept-getelementsbyclassname\n\t */\n\tgetElementsByClassName: function(classNames) {\n\t\tvar classNamesSet = toOrderedSet(classNames)\n\t\treturn new LiveNodeList(this, function(base) {\n\t\t\tvar ls = [];\n\t\t\tif (classNamesSet.length > 0) {\n\t\t\t\t_visitNode(base.documentElement, function(node) {\n\t\t\t\t\tif(node !== base && node.nodeType === ELEMENT_NODE) {\n\t\t\t\t\t\tvar nodeClassNames = node.getAttribute('class')\n\t\t\t\t\t\t// can be null if the attribute does not exist\n\t\t\t\t\t\tif (nodeClassNames) {\n\t\t\t\t\t\t\t// before splitting and iterating just compare them for the most common case\n\t\t\t\t\t\t\tvar matches = classNames === nodeClassNames;\n\t\t\t\t\t\t\tif (!matches) {\n\t\t\t\t\t\t\t\tvar nodeClassNamesSet = toOrderedSet(nodeClassNames)\n\t\t\t\t\t\t\t\tmatches = classNamesSet.every(arrayIncludes(nodeClassNamesSet))\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(matches) {\n\t\t\t\t\t\t\t\tls.push(node);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn ls;\n\t\t});\n\t},\n\n\t//document factory method:\n\tcreateElement :\tfunction(tagName){\n\t\tvar node = new Element();\n\t\tnode.ownerDocument = this;\n\t\tnode.nodeName = tagName;\n\t\tnode.tagName = tagName;\n\t\tnode.localName = tagName;\n\t\tnode.childNodes = new NodeList();\n\t\tvar attrs\t= node.attributes = new NamedNodeMap();\n\t\tattrs._ownerElement = node;\n\t\treturn node;\n\t},\n\tcreateDocumentFragment :\tfunction(){\n\t\tvar node = new DocumentFragment();\n\t\tnode.ownerDocument = this;\n\t\tnode.childNodes = new NodeList();\n\t\treturn node;\n\t},\n\tcreateTextNode :\tfunction(data){\n\t\tvar node = new Text();\n\t\tnode.ownerDocument = this;\n\t\tnode.appendData(data)\n\t\treturn node;\n\t},\n\tcreateComment :\tfunction(data){\n\t\tvar node = new Comment();\n\t\tnode.ownerDocument = this;\n\t\tnode.appendData(data)\n\t\treturn node;\n\t},\n\tcreateCDATASection :\tfunction(data){\n\t\tvar node = new CDATASection();\n\t\tnode.ownerDocument = this;\n\t\tnode.appendData(data)\n\t\treturn node;\n\t},\n\tcreateProcessingInstruction :\tfunction(target,data){\n\t\tvar node = new ProcessingInstruction();\n\t\tnode.ownerDocument = this;\n\t\tnode.tagName = node.target = target;\n\t\tnode.nodeValue= node.data = data;\n\t\treturn node;\n\t},\n\tcreateAttribute :\tfunction(name){\n\t\tvar node = new Attr();\n\t\tnode.ownerDocument\t= this;\n\t\tnode.name = name;\n\t\tnode.nodeName\t= name;\n\t\tnode.localName = name;\n\t\tnode.specified = true;\n\t\treturn node;\n\t},\n\tcreateEntityReference :\tfunction(name){\n\t\tvar node = new EntityReference();\n\t\tnode.ownerDocument\t= this;\n\t\tnode.nodeName\t= name;\n\t\treturn node;\n\t},\n\t// Introduced in DOM Level 2:\n\tcreateElementNS :\tfunction(namespaceURI,qualifiedName){\n\t\tvar node = new Element();\n\t\tvar pl = qualifiedName.split(':');\n\t\tvar attrs\t= node.attributes = new NamedNodeMap();\n\t\tnode.childNodes = new NodeList();\n\t\tnode.ownerDocument = this;\n\t\tnode.nodeName = qualifiedName;\n\t\tnode.tagName = qualifiedName;\n\t\tnode.namespaceURI = namespaceURI;\n\t\tif(pl.length == 2){\n\t\t\tnode.prefix = pl[0];\n\t\t\tnode.localName = pl[1];\n\t\t}else{\n\t\t\t//el.prefix = null;\n\t\t\tnode.localName = qualifiedName;\n\t\t}\n\t\tattrs._ownerElement = node;\n\t\treturn node;\n\t},\n\t// Introduced in DOM Level 2:\n\tcreateAttributeNS :\tfunction(namespaceURI,qualifiedName){\n\t\tvar node = new Attr();\n\t\tvar pl = qualifiedName.split(':');\n\t\tnode.ownerDocument = this;\n\t\tnode.nodeName = qualifiedName;\n\t\tnode.name = qualifiedName;\n\t\tnode.namespaceURI = namespaceURI;\n\t\tnode.specified = true;\n\t\tif(pl.length == 2){\n\t\t\tnode.prefix = pl[0];\n\t\t\tnode.localName = pl[1];\n\t\t}else{\n\t\t\t//el.prefix = null;\n\t\t\tnode.localName = qualifiedName;\n\t\t}\n\t\treturn node;\n\t}\n};\n_extends(Document,Node);\n\n\nfunction Element() {\n\tthis._nsMap = {};\n};\nElement.prototype = {\n\tnodeType : ELEMENT_NODE,\n\thasAttribute : function(name){\n\t\treturn this.getAttributeNode(name)!=null;\n\t},\n\tgetAttribute : function(name){\n\t\tvar attr = this.getAttributeNode(name);\n\t\treturn attr && attr.value || '';\n\t},\n\tgetAttributeNode : function(name){\n\t\treturn this.attributes.getNamedItem(name);\n\t},\n\tsetAttribute : function(name, value){\n\t\tvar attr = this.ownerDocument.createAttribute(name);\n\t\tattr.value = attr.nodeValue = \"\" + value;\n\t\tthis.setAttributeNode(attr)\n\t},\n\tremoveAttribute : function(name){\n\t\tvar attr = this.getAttributeNode(name)\n\t\tattr && this.removeAttributeNode(attr);\n\t},\n\n\t//four real opeartion method\n\tappendChild:function(newChild){\n\t\tif(newChild.nodeType === DOCUMENT_FRAGMENT_NODE){\n\t\t\treturn this.insertBefore(newChild,null);\n\t\t}else{\n\t\t\treturn _appendSingleChild(this,newChild);\n\t\t}\n\t},\n\tsetAttributeNode : function(newAttr){\n\t\treturn this.attributes.setNamedItem(newAttr);\n\t},\n\tsetAttributeNodeNS : function(newAttr){\n\t\treturn this.attributes.setNamedItemNS(newAttr);\n\t},\n\tremoveAttributeNode : function(oldAttr){\n\t\t//console.log(this == oldAttr.ownerElement)\n\t\treturn this.attributes.removeNamedItem(oldAttr.nodeName);\n\t},\n\t//get real attribute name,and remove it by removeAttributeNode\n\tremoveAttributeNS : function(namespaceURI, localName){\n\t\tvar old = this.getAttributeNodeNS(namespaceURI, localName);\n\t\told && this.removeAttributeNode(old);\n\t},\n\n\thasAttributeNS : function(namespaceURI, localName){\n\t\treturn this.getAttributeNodeNS(namespaceURI, localName)!=null;\n\t},\n\tgetAttributeNS : function(namespaceURI, localName){\n\t\tvar attr = this.getAttributeNodeNS(namespaceURI, localName);\n\t\treturn attr && attr.value || '';\n\t},\n\tsetAttributeNS : function(namespaceURI, qualifiedName, value){\n\t\tvar attr = this.ownerDocument.createAttributeNS(namespaceURI, qualifiedName);\n\t\tattr.value = attr.nodeValue = \"\" + value;\n\t\tthis.setAttributeNode(attr)\n\t},\n\tgetAttributeNodeNS : function(namespaceURI, localName){\n\t\treturn this.attributes.getNamedItemNS(namespaceURI, localName);\n\t},\n\n\tgetElementsByTagName : function(tagName){\n\t\treturn new LiveNodeList(this,function(base){\n\t\t\tvar ls = [];\n\t\t\t_visitNode(base,function(node){\n\t\t\t\tif(node !== base && node.nodeType == ELEMENT_NODE && (tagName === '*' || node.tagName == tagName)){\n\t\t\t\t\tls.push(node);\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn ls;\n\t\t});\n\t},\n\tgetElementsByTagNameNS : function(namespaceURI, localName){\n\t\treturn new LiveNodeList(this,function(base){\n\t\t\tvar ls = [];\n\t\t\t_visitNode(base,function(node){\n\t\t\t\tif(node !== base && node.nodeType === ELEMENT_NODE && (namespaceURI === '*' || node.namespaceURI === namespaceURI) && (localName === '*' || node.localName == localName)){\n\t\t\t\t\tls.push(node);\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn ls;\n\n\t\t});\n\t}\n};\nDocument.prototype.getElementsByTagName = Element.prototype.getElementsByTagName;\nDocument.prototype.getElementsByTagNameNS = Element.prototype.getElementsByTagNameNS;\n\n\n_extends(Element,Node);\nfunction Attr() {\n};\nAttr.prototype.nodeType = ATTRIBUTE_NODE;\n_extends(Attr,Node);\n\n\nfunction CharacterData() {\n};\nCharacterData.prototype = {\n\tdata : '',\n\tsubstringData : function(offset, count) {\n\t\treturn this.data.substring(offset, offset+count);\n\t},\n\tappendData: function(text) {\n\t\ttext = this.data+text;\n\t\tthis.nodeValue = this.data = text;\n\t\tthis.length = text.length;\n\t},\n\tinsertData: function(offset,text) {\n\t\tthis.replaceData(offset,0,text);\n\n\t},\n\tappendChild:function(newChild){\n\t\tthrow new Error(ExceptionMessage[HIERARCHY_REQUEST_ERR])\n\t},\n\tdeleteData: function(offset, count) {\n\t\tthis.replaceData(offset,count,\"\");\n\t},\n\treplaceData: function(offset, count, text) {\n\t\tvar start = this.data.substring(0,offset);\n\t\tvar end = this.data.substring(offset+count);\n\t\ttext = start + text + end;\n\t\tthis.nodeValue = this.data = text;\n\t\tthis.length = text.length;\n\t}\n}\n_extends(CharacterData,Node);\nfunction Text() {\n};\nText.prototype = {\n\tnodeName : \"#text\",\n\tnodeType : TEXT_NODE,\n\tsplitText : function(offset) {\n\t\tvar text = this.data;\n\t\tvar newText = text.substring(offset);\n\t\ttext = text.substring(0, offset);\n\t\tthis.data = this.nodeValue = text;\n\t\tthis.length = text.length;\n\t\tvar newNode = this.ownerDocument.createTextNode(newText);\n\t\tif(this.parentNode){\n\t\t\tthis.parentNode.insertBefore(newNode, this.nextSibling);\n\t\t}\n\t\treturn newNode;\n\t}\n}\n_extends(Text,CharacterData);\nfunction Comment() {\n};\nComment.prototype = {\n\tnodeName : \"#comment\",\n\tnodeType : COMMENT_NODE\n}\n_extends(Comment,CharacterData);\n\nfunction CDATASection() {\n};\nCDATASection.prototype = {\n\tnodeName : \"#cdata-section\",\n\tnodeType : CDATA_SECTION_NODE\n}\n_extends(CDATASection,CharacterData);\n\n\nfunction DocumentType() {\n};\nDocumentType.prototype.nodeType = DOCUMENT_TYPE_NODE;\n_extends(DocumentType,Node);\n\nfunction Notation() {\n};\nNotation.prototype.nodeType = NOTATION_NODE;\n_extends(Notation,Node);\n\nfunction Entity() {\n};\nEntity.prototype.nodeType = ENTITY_NODE;\n_extends(Entity,Node);\n\nfunction EntityReference() {\n};\nEntityReference.prototype.nodeType = ENTITY_REFERENCE_NODE;\n_extends(EntityReference,Node);\n\nfunction DocumentFragment() {\n};\nDocumentFragment.prototype.nodeName =\t\"#document-fragment\";\nDocumentFragment.prototype.nodeType =\tDOCUMENT_FRAGMENT_NODE;\n_extends(DocumentFragment,Node);\n\n\nfunction ProcessingInstruction() {\n}\nProcessingInstruction.prototype.nodeType = PROCESSING_INSTRUCTION_NODE;\n_extends(ProcessingInstruction,Node);\nfunction XMLSerializer(){}\nXMLSerializer.prototype.serializeToString = function(node,isHtml,nodeFilter){\n\treturn nodeSerializeToString.call(node,isHtml,nodeFilter);\n}\nNode.prototype.toString = nodeSerializeToString;\nfunction nodeSerializeToString(isHtml,nodeFilter){\n\tvar buf = [];\n\tvar refNode = this.nodeType == 9 && this.documentElement || this;\n\tvar prefix = refNode.prefix;\n\tvar uri = refNode.namespaceURI;\n\n\tif(uri && prefix == null){\n\t\t//console.log(prefix)\n\t\tvar prefix = refNode.lookupPrefix(uri);\n\t\tif(prefix == null){\n\t\t\t//isHTML = true;\n\t\t\tvar visibleNamespaces=[\n\t\t\t{namespace:uri,prefix:null}\n\t\t\t//{namespace:uri,prefix:''}\n\t\t\t]\n\t\t}\n\t}\n\tserializeToString(this,buf,isHtml,nodeFilter,visibleNamespaces);\n\t//console.log('###',this.nodeType,uri,prefix,buf.join(''))\n\treturn buf.join('');\n}\n\nfunction needNamespaceDefine(node, isHTML, visibleNamespaces) {\n\tvar prefix = node.prefix || '';\n\tvar uri = node.namespaceURI;\n\t// According to [Namespaces in XML 1.0](https://www.w3.org/TR/REC-xml-names/#ns-using) ,\n\t// and more specifically https://www.w3.org/TR/REC-xml-names/#nsc-NoPrefixUndecl :\n\t// > In a namespace declaration for a prefix [...], the attribute value MUST NOT be empty.\n\t// in a similar manner [Namespaces in XML 1.1](https://www.w3.org/TR/xml-names11/#ns-using)\n\t// and more specifically https://www.w3.org/TR/xml-names11/#nsc-NSDeclared :\n\t// > [...] Furthermore, the attribute value [...] must not be an empty string.\n\t// so serializing empty namespace value like xmlns:ds=\"\" would produce an invalid XML document.\n\tif (!uri) {\n\t\treturn false;\n\t}\n\tif (prefix === \"xml\" && uri === NAMESPACE.XML || uri === NAMESPACE.XMLNS) {\n\t\treturn false;\n\t}\n\n\tvar i = visibleNamespaces.length\n\twhile (i--) {\n\t\tvar ns = visibleNamespaces[i];\n\t\t// get namespace prefix\n\t\tif (ns.prefix === prefix) {\n\t\t\treturn ns.namespace !== uri;\n\t\t}\n\t}\n\treturn true;\n}\n/**\n * Well-formed constraint: No < in Attribute Values\n * > The replacement text of any entity referred to directly or indirectly\n * > in an attribute value must not contain a <.\n * @see https://www.w3.org/TR/xml11/#CleanAttrVals\n * @see https://www.w3.org/TR/xml11/#NT-AttValue\n *\n * Literal whitespace other than space that appear in attribute values\n * are serialized as their entity references, so they will be preserved.\n * (In contrast to whitespace literals in the input which are normalized to spaces)\n * @see https://www.w3.org/TR/xml11/#AVNormalize\n * @see https://w3c.github.io/DOM-Parsing/#serializing-an-element-s-attributes\n */\nfunction addSerializedAttribute(buf, qualifiedName, value) {\n\tbuf.push(' ', qualifiedName, '=\"', value.replace(/[<>&\"\\t\\n\\r]/g, _xmlEncoder), '\"')\n}\n\nfunction serializeToString(node,buf,isHTML,nodeFilter,visibleNamespaces){\n\tif (!visibleNamespaces) {\n\t\tvisibleNamespaces = [];\n\t}\n\n\tif(nodeFilter){\n\t\tnode = nodeFilter(node);\n\t\tif(node){\n\t\t\tif(typeof node == 'string'){\n\t\t\t\tbuf.push(node);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}else{\n\t\t\treturn;\n\t\t}\n\t\t//buf.sort.apply(attrs, attributeSorter);\n\t}\n\n\tswitch(node.nodeType){\n\tcase ELEMENT_NODE:\n\t\tvar attrs = node.attributes;\n\t\tvar len = attrs.length;\n\t\tvar child = node.firstChild;\n\t\tvar nodeName = node.tagName;\n\n\t\tisHTML = NAMESPACE.isHTML(node.namespaceURI) || isHTML\n\n\t\tvar prefixedNodeName = nodeName\n\t\tif (!isHTML && !node.prefix && node.namespaceURI) {\n\t\t\tvar defaultNS\n\t\t\t// lookup current default ns from `xmlns` attribute\n\t\t\tfor (var ai = 0; ai < attrs.length; ai++) {\n\t\t\t\tif (attrs.item(ai).name === 'xmlns') {\n\t\t\t\t\tdefaultNS = attrs.item(ai).value\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!defaultNS) {\n\t\t\t\t// lookup current default ns in visibleNamespaces\n\t\t\t\tfor (var nsi = visibleNamespaces.length - 1; nsi >= 0; nsi--) {\n\t\t\t\t\tvar namespace = visibleNamespaces[nsi]\n\t\t\t\t\tif (namespace.prefix === '' && namespace.namespace === node.namespaceURI) {\n\t\t\t\t\t\tdefaultNS = namespace.namespace\n\t\t\t\t\t\tbreak\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (defaultNS !== node.namespaceURI) {\n\t\t\t\tfor (var nsi = visibleNamespaces.length - 1; nsi >= 0; nsi--) {\n\t\t\t\t\tvar namespace = visibleNamespaces[nsi]\n\t\t\t\t\tif (namespace.namespace === node.namespaceURI) {\n\t\t\t\t\t\tif (namespace.prefix) {\n\t\t\t\t\t\t\tprefixedNodeName = namespace.prefix + ':' + nodeName\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tbuf.push('<', prefixedNodeName);\n\n\t\tfor(var i=0;i<len;i++){\n\t\t\t// add namespaces for attributes\n\t\t\tvar attr = attrs.item(i);\n\t\t\tif (attr.prefix == 'xmlns') {\n\t\t\t\tvisibleNamespaces.push({ prefix: attr.localName, namespace: attr.value });\n\t\t\t}else if(attr.nodeName == 'xmlns'){\n\t\t\t\tvisibleNamespaces.push({ prefix: '', namespace: attr.value });\n\t\t\t}\n\t\t}\n\n\t\tfor(var i=0;i<len;i++){\n\t\t\tvar attr = attrs.item(i);\n\t\t\tif (needNamespaceDefine(attr,isHTML, visibleNamespaces)) {\n\t\t\t\tvar prefix = attr.prefix||'';\n\t\t\t\tvar uri = attr.namespaceURI;\n\t\t\t\taddSerializedAttribute(buf, prefix ? 'xmlns:' + prefix : \"xmlns\", uri);\n\t\t\t\tvisibleNamespaces.push({ prefix: prefix, namespace:uri });\n\t\t\t}\n\t\t\tserializeToString(attr,buf,isHTML,nodeFilter,visibleNamespaces);\n\t\t}\n\n\t\t// add namespace for current node\n\t\tif (nodeName === prefixedNodeName && needNamespaceDefine(node, isHTML, visibleNamespaces)) {\n\t\t\tvar prefix = node.prefix||'';\n\t\t\tvar uri = node.namespaceURI;\n\t\t\taddSerializedAttribute(buf, prefix ? 'xmlns:' + prefix : \"xmlns\", uri);\n\t\t\tvisibleNamespaces.push({ prefix: prefix, namespace:uri });\n\t\t}\n\n\t\tif(child || isHTML && !/^(?:meta|link|img|br|hr|input)$/i.test(nodeName)){\n\t\t\tbuf.push('>');\n\t\t\t//if is cdata child node\n\t\t\tif(isHTML && /^script$/i.test(nodeName)){\n\t\t\t\twhile(child){\n\t\t\t\t\tif(child.data){\n\t\t\t\t\t\tbuf.push(child.data);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tserializeToString(child, buf, isHTML, nodeFilter, visibleNamespaces.slice());\n\t\t\t\t\t}\n\t\t\t\t\tchild = child.nextSibling;\n\t\t\t\t}\n\t\t\t}else\n\t\t\t{\n\t\t\t\twhile(child){\n\t\t\t\t\tserializeToString(child, buf, isHTML, nodeFilter, visibleNamespaces.slice());\n\t\t\t\t\tchild = child.nextSibling;\n\t\t\t\t}\n\t\t\t}\n\t\t\tbuf.push('</',prefixedNodeName,'>');\n\t\t}else{\n\t\t\tbuf.push('/>');\n\t\t}\n\t\t// remove added visible namespaces\n\t\t//visibleNamespaces.length = startVisibleNamespaces;\n\t\treturn;\n\tcase DOCUMENT_NODE:\n\tcase DOCUMENT_FRAGMENT_NODE:\n\t\tvar child = node.firstChild;\n\t\twhile(child){\n\t\t\tserializeToString(child, buf, isHTML, nodeFilter, visibleNamespaces.slice());\n\t\t\tchild = child.nextSibling;\n\t\t}\n\t\treturn;\n\tcase ATTRIBUTE_NODE:\n\t\treturn addSerializedAttribute(buf, node.name, node.value);\n\tcase TEXT_NODE:\n\t\t/**\n\t\t * The ampersand character (&) and the left angle bracket (<) must not appear in their literal form,\n\t\t * except when used as markup delimiters, or within a comment, a processing instruction, or a CDATA section.\n\t\t * If they are needed elsewhere, they must be escaped using either numeric character references or the strings\n\t\t * `&amp;` and `&lt;` respectively.\n\t\t * The right angle bracket (>) may be represented using the string \" &gt; \", and must, for compatibility,\n\t\t * be escaped using either `&gt;` or a character reference when it appears in the string `]]>` in content,\n\t\t * when that string is not marking the end of a CDATA section.\n\t\t *\n\t\t * In the content of elements, character data is any string of characters\n\t\t * which does not contain the start-delimiter of any markup\n\t\t * and does not include the CDATA-section-close delimiter, `]]>`.\n\t\t *\n\t\t * @see https://www.w3.org/TR/xml/#NT-CharData\n\t\t * @see https://w3c.github.io/DOM-Parsing/#xml-serializing-a-text-node\n\t\t */\n\t\treturn buf.push(node.data\n\t\t\t.replace(/[<&>]/g,_xmlEncoder)\n\t\t);\n\tcase CDATA_SECTION_NODE:\n\t\treturn buf.push( '<![CDATA[',node.data,']]>');\n\tcase COMMENT_NODE:\n\t\treturn buf.push( \"<!--\",node.data,\"-->\");\n\tcase DOCUMENT_TYPE_NODE:\n\t\tvar pubid = node.publicId;\n\t\tvar sysid = node.systemId;\n\t\tbuf.push('<!DOCTYPE ',node.name);\n\t\tif(pubid){\n\t\t\tbuf.push(' PUBLIC ', pubid);\n\t\t\tif (sysid && sysid!='.') {\n\t\t\t\tbuf.push(' ', sysid);\n\t\t\t}\n\t\t\tbuf.push('>');\n\t\t}else if(sysid && sysid!='.'){\n\t\t\tbuf.push(' SYSTEM ', sysid, '>');\n\t\t}else{\n\t\t\tvar sub = node.internalSubset;\n\t\t\tif(sub){\n\t\t\t\tbuf.push(\" [\",sub,\"]\");\n\t\t\t}\n\t\t\tbuf.push(\">\");\n\t\t}\n\t\treturn;\n\tcase PROCESSING_INSTRUCTION_NODE:\n\t\treturn buf.push( \"<?\",node.target,\" \",node.data,\"?>\");\n\tcase ENTITY_REFERENCE_NODE:\n\t\treturn buf.push( '&',node.nodeName,';');\n\t//case ENTITY_NODE:\n\t//case NOTATION_NODE:\n\tdefault:\n\t\tbuf.push('??',node.nodeName);\n\t}\n}\nfunction importNode(doc,node,deep){\n\tvar node2;\n\tswitch (node.nodeType) {\n\tcase ELEMENT_NODE:\n\t\tnode2 = node.cloneNode(false);\n\t\tnode2.ownerDocument = doc;\n\t\t//var attrs = node2.attributes;\n\t\t//var len = attrs.length;\n\t\t//for(var i=0;i<len;i++){\n\t\t\t//node2.setAttributeNodeNS(importNode(doc,attrs.item(i),deep));\n\t\t//}\n\tcase DOCUMENT_FRAGMENT_NODE:\n\t\tbreak;\n\tcase ATTRIBUTE_NODE:\n\t\tdeep = true;\n\t\tbreak;\n\t//case ENTITY_REFERENCE_NODE:\n\t//case PROCESSING_INSTRUCTION_NODE:\n\t////case TEXT_NODE:\n\t//case CDATA_SECTION_NODE:\n\t//case COMMENT_NODE:\n\t//\tdeep = false;\n\t//\tbreak;\n\t//case DOCUMENT_NODE:\n\t//case DOCUMENT_TYPE_NODE:\n\t//cannot be imported.\n\t//case ENTITY_NODE:\n\t//case NOTATION_NODE\n\t//can not hit in level3\n\t//default:throw e;\n\t}\n\tif(!node2){\n\t\tnode2 = node.cloneNode(false);//false\n\t}\n\tnode2.ownerDocument = doc;\n\tnode2.parentNode = null;\n\tif(deep){\n\t\tvar child = node.firstChild;\n\t\twhile(child){\n\t\t\tnode2.appendChild(importNode(doc,child,deep));\n\t\t\tchild = child.nextSibling;\n\t\t}\n\t}\n\treturn node2;\n}\n//\n//var _relationMap = {firstChild:1,lastChild:1,previousSibling:1,nextSibling:1,\n//\t\t\t\t\tattributes:1,childNodes:1,parentNode:1,documentElement:1,doctype,};\nfunction cloneNode(doc,node,deep){\n\tvar node2 = new node.constructor();\n\tfor (var n in node) {\n\t\tif (Object.prototype.hasOwnProperty.call(node, n)) {\n\t\t\tvar v = node[n];\n\t\t\tif (typeof v != \"object\") {\n\t\t\t\tif (v != node2[n]) {\n\t\t\t\t\tnode2[n] = v;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tif(node.childNodes){\n\t\tnode2.childNodes = new NodeList();\n\t}\n\tnode2.ownerDocument = doc;\n\tswitch (node2.nodeType) {\n\tcase ELEMENT_NODE:\n\t\tvar attrs\t= node.attributes;\n\t\tvar attrs2\t= node2.attributes = new NamedNodeMap();\n\t\tvar len = attrs.length\n\t\tattrs2._ownerElement = node2;\n\t\tfor(var i=0;i<len;i++){\n\t\t\tnode2.setAttributeNode(cloneNode(doc,attrs.item(i),true));\n\t\t}\n\t\tbreak;;\n\tcase ATTRIBUTE_NODE:\n\t\tdeep = true;\n\t}\n\tif(deep){\n\t\tvar child = node.firstChild;\n\t\twhile(child){\n\t\t\tnode2.appendChild(cloneNode(doc,child,deep));\n\t\t\tchild = child.nextSibling;\n\t\t}\n\t}\n\treturn node2;\n}\n\nfunction __set__(object,key,value){\n\tobject[key] = value\n}\n//do dynamic\ntry{\n\tif(Object.defineProperty){\n\t\tObject.defineProperty(LiveNodeList.prototype,'length',{\n\t\t\tget:function(){\n\t\t\t\t_updateLiveList(this);\n\t\t\t\treturn this.$$length;\n\t\t\t}\n\t\t});\n\n\t\tObject.defineProperty(Node.prototype,'textContent',{\n\t\t\tget:function(){\n\t\t\t\treturn getTextContent(this);\n\t\t\t},\n\n\t\t\tset:function(data){\n\t\t\t\tswitch(this.nodeType){\n\t\t\t\tcase ELEMENT_NODE:\n\t\t\t\tcase DOCUMENT_FRAGMENT_NODE:\n\t\t\t\t\twhile(this.firstChild){\n\t\t\t\t\t\tthis.removeChild(this.firstChild);\n\t\t\t\t\t}\n\t\t\t\t\tif(data || String(data)){\n\t\t\t\t\t\tthis.appendChild(this.ownerDocument.createTextNode(data));\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tthis.data = data;\n\t\t\t\t\tthis.value = data;\n\t\t\t\t\tthis.nodeValue = data;\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\n\t\tfunction getTextContent(node){\n\t\t\tswitch(node.nodeType){\n\t\t\tcase ELEMENT_NODE:\n\t\t\tcase DOCUMENT_FRAGMENT_NODE:\n\t\t\t\tvar buf = [];\n\t\t\t\tnode = node.firstChild;\n\t\t\t\twhile(node){\n\t\t\t\t\tif(node.nodeType!==7 && node.nodeType !==8){\n\t\t\t\t\t\tbuf.push(getTextContent(node));\n\t\t\t\t\t}\n\t\t\t\t\tnode = node.nextSibling;\n\t\t\t\t}\n\t\t\t\treturn buf.join('');\n\t\t\tdefault:\n\t\t\t\treturn node.nodeValue;\n\t\t\t}\n\t\t}\n\n\t\t__set__ = function(object,key,value){\n\t\t\t//console.log(value)\n\t\t\tobject['$$'+key] = value\n\t\t}\n\t}\n}catch(e){//ie8\n}\n\n//if(typeof require == 'function'){\n\texports.DocumentType = DocumentType;\n\texports.DOMException = DOMException;\n\texports.DOMImplementation = DOMImplementation;\n\texports.Element = Element;\n\texports.Node = Node;\n\texports.NodeList = NodeList;\n\texports.XMLSerializer = XMLSerializer;\n//}\n","var freeze = require('./conventions').freeze;\n\n/**\n * The entities that are predefined in every XML document.\n *\n * @see https://www.w3.org/TR/2006/REC-xml11-20060816/#sec-predefined-ent W3C XML 1.1\n * @see https://www.w3.org/TR/2008/REC-xml-20081126/#sec-predefined-ent W3C XML 1.0\n * @see https://en.wikipedia.org/wiki/List_of_XML_and_HTML_character_entity_references#Predefined_entities_in_XML Wikipedia\n */\nexports.XML_ENTITIES = freeze({amp:'&', apos:\"'\", gt:'>', lt:'<', quot:'\"'})\n\n/**\n * A map of currently 241 entities that are detected in an HTML document.\n * They contain all entries from `XML_ENTITIES`.\n *\n * @see XML_ENTITIES\n * @see DOMParser.parseFromString\n * @see DOMImplementation.prototype.createHTMLDocument\n * @see https://html.spec.whatwg.org/#named-character-references WHATWG HTML(5) Spec\n * @see https://www.w3.org/TR/xml-entity-names/ W3C XML Entity Names\n * @see https://www.w3.org/TR/html4/sgml/entities.html W3C HTML4/SGML\n * @see https://en.wikipedia.org/wiki/List_of_XML_and_HTML_character_entity_references#Character_entity_references_in_HTML Wikipedia (HTML)\n * @see https://en.wikipedia.org/wiki/List_of_XML_and_HTML_character_entity_references#Entities_representing_special_characters_in_XHTML Wikpedia (XHTML)\n */\nexports.HTML_ENTITIES = freeze({\n       lt: '<',\n       gt: '>',\n       amp: '&',\n       quot: '\"',\n       apos: \"'\",\n       Agrave: \"\",\n       Aacute: \"\",\n       Acirc: \"\",\n       Atilde: \"\",\n       Auml: \"\",\n       Aring: \"\",\n       AElig: \"\",\n       Ccedil: \"\",\n       Egrave: \"\",\n       Eacute: \"\",\n       Ecirc: \"\",\n       Euml: \"\",\n       Igrave: \"\",\n       Iacute: \"\",\n       Icirc: \"\",\n       Iuml: \"\",\n       ETH: \"\",\n       Ntilde: \"\",\n       Ograve: \"\",\n       Oacute: \"\",\n       Ocirc: \"\",\n       Otilde: \"\",\n       Ouml: \"\",\n       Oslash: \"\",\n       Ugrave: \"\",\n       Uacute: \"\",\n       Ucirc: \"\",\n       Uuml: \"\",\n       Yacute: \"\",\n       THORN: \"\",\n       szlig: \"\",\n       agrave: \"\",\n       aacute: \"\",\n       acirc: \"\",\n       atilde: \"\",\n       auml: \"\",\n       aring: \"\",\n       aelig: \"\",\n       ccedil: \"\",\n       egrave: \"\",\n       eacute: \"\",\n       ecirc: \"\",\n       euml: \"\",\n       igrave: \"\",\n       iacute: \"\",\n       icirc: \"\",\n       iuml: \"\",\n       eth: \"\",\n       ntilde: \"\",\n       ograve: \"\",\n       oacute: \"\",\n       ocirc: \"\",\n       otilde: \"\",\n       ouml: \"\",\n       oslash: \"\",\n       ugrave: \"\",\n       uacute: \"\",\n       ucirc: \"\",\n       uuml: \"\",\n       yacute: \"\",\n       thorn: \"\",\n       yuml: \"\",\n       nbsp: \"\\u00a0\",\n       iexcl: \"\",\n       cent: \"\",\n       pound: \"\",\n       curren: \"\",\n       yen: \"\",\n       brvbar: \"\",\n       sect: \"\",\n       uml: \"\",\n       copy: \"\",\n       ordf: \"\",\n       laquo: \"\",\n       not: \"\",\n       shy: \"\",\n       reg: \"\",\n       macr: \"\",\n       deg: \"\",\n       plusmn: \"\",\n       sup2: \"\",\n       sup3: \"\",\n       acute: \"\",\n       micro: \"\",\n       para: \"\",\n       middot: \"\",\n       cedil: \"\",\n       sup1: \"\",\n       ordm: \"\",\n       raquo: \"\",\n       frac14: \"\",\n       frac12: \"\",\n       frac34: \"\",\n       iquest: \"\",\n       times: \"\",\n       divide: \"\",\n       forall: \"\",\n       part: \"\",\n       exist: \"\",\n       empty: \"\",\n       nabla: \"\",\n       isin: \"\",\n       notin: \"\",\n       ni: \"\",\n       prod: \"\",\n       sum: \"\",\n       minus: \"\",\n       lowast: \"\",\n       radic: \"\",\n       prop: \"\",\n       infin: \"\",\n       ang: \"\",\n       and: \"\",\n       or: \"\",\n       cap: \"\",\n       cup: \"\",\n       'int': \"\",\n       there4: \"\",\n       sim: \"\",\n       cong: \"\",\n       asymp: \"\",\n       ne: \"\",\n       equiv: \"\",\n       le: \"\",\n       ge: \"\",\n       sub: \"\",\n       sup: \"\",\n       nsub: \"\",\n       sube: \"\",\n       supe: \"\",\n       oplus: \"\",\n       otimes: \"\",\n       perp: \"\",\n       sdot: \"\",\n       Alpha: \"\",\n       Beta: \"\",\n       Gamma: \"\",\n       Delta: \"\",\n       Epsilon: \"\",\n       Zeta: \"\",\n       Eta: \"\",\n       Theta: \"\",\n       Iota: \"\",\n       Kappa: \"\",\n       Lambda: \"\",\n       Mu: \"\",\n       Nu: \"\",\n       Xi: \"\",\n       Omicron: \"\",\n       Pi: \"\",\n       Rho: \"\",\n       Sigma: \"\",\n       Tau: \"\",\n       Upsilon: \"\",\n       Phi: \"\",\n       Chi: \"\",\n       Psi: \"\",\n       Omega: \"\",\n       alpha: \"\",\n       beta: \"\",\n       gamma: \"\",\n       delta: \"\",\n       epsilon: \"\",\n       zeta: \"\",\n       eta: \"\",\n       theta: \"\",\n       iota: \"\",\n       kappa: \"\",\n       lambda: \"\",\n       mu: \"\",\n       nu: \"\",\n       xi: \"\",\n       omicron: \"\",\n       pi: \"\",\n       rho: \"\",\n       sigmaf: \"\",\n       sigma: \"\",\n       tau: \"\",\n       upsilon: \"\",\n       phi: \"\",\n       chi: \"\",\n       psi: \"\",\n       omega: \"\",\n       thetasym: \"\",\n       upsih: \"\",\n       piv: \"\",\n       OElig: \"\",\n       oelig: \"\",\n       Scaron: \"\",\n       scaron: \"\",\n       Yuml: \"\",\n       fnof: \"\",\n       circ: \"\",\n       tilde: \"\",\n       ensp: \"\",\n       emsp: \"\",\n       thinsp: \"\",\n       zwnj: \"\",\n       zwj: \"\",\n       lrm: \"\",\n       rlm: \"\",\n       ndash: \"\",\n       mdash: \"\",\n       lsquo: \"\",\n       rsquo: \"\",\n       sbquo: \"\",\n       ldquo: \"\",\n       rdquo: \"\",\n       bdquo: \"\",\n       dagger: \"\",\n       Dagger: \"\",\n       bull: \"\",\n       hellip: \"\",\n       permil: \"\",\n       prime: \"\",\n       Prime: \"\",\n       lsaquo: \"\",\n       rsaquo: \"\",\n       oline: \"\",\n       euro: \"\",\n       trade: \"\",\n       larr: \"\",\n       uarr: \"\",\n       rarr: \"\",\n       darr: \"\",\n       harr: \"\",\n       crarr: \"\",\n       lceil: \"\",\n       rceil: \"\",\n       lfloor: \"\",\n       rfloor: \"\",\n       loz: \"\",\n       spades: \"\",\n       clubs: \"\",\n       hearts: \"\",\n       diams: \"\"\n});\n\n/**\n * @deprecated use `HTML_ENTITIES` instead\n * @see HTML_ENTITIES\n */\nexports.entityMap = exports.HTML_ENTITIES\n","var dom = require('./dom')\nexports.DOMImplementation = dom.DOMImplementation\nexports.XMLSerializer = dom.XMLSerializer\nexports.DOMParser = require('./dom-parser').DOMParser\n","var NAMESPACE = require(\"./conventions\").NAMESPACE;\n\n//[4]   \tNameStartChar\t   ::=   \t\":\" | [A-Z] | \"_\" | [a-z] | [#xC0-#xD6] | [#xD8-#xF6] | [#xF8-#x2FF] | [#x370-#x37D] | [#x37F-#x1FFF] | [#x200C-#x200D] | [#x2070-#x218F] | [#x2C00-#x2FEF] | [#x3001-#xD7FF] | [#xF900-#xFDCF] | [#xFDF0-#xFFFD] | [#x10000-#xEFFFF]\n//[4a]   \tNameChar\t   ::=   \tNameStartChar | \"-\" | \".\" | [0-9] | #xB7 | [#x0300-#x036F] | [#x203F-#x2040]\n//[5]   \tName\t   ::=   \tNameStartChar (NameChar)*\nvar nameStartChar = /[A-Z_a-z\\xC0-\\xD6\\xD8-\\xF6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD]///\\u10000-\\uEFFFF\nvar nameChar = new RegExp(\"[\\\\-\\\\.0-9\"+nameStartChar.source.slice(1,-1)+\"\\\\u00B7\\\\u0300-\\\\u036F\\\\u203F-\\\\u2040]\");\nvar tagNamePattern = new RegExp('^'+nameStartChar.source+nameChar.source+'*(?:\\:'+nameStartChar.source+nameChar.source+'*)?$');\n//var tagNamePattern = /^[a-zA-Z_][\\w\\-\\.]*(?:\\:[a-zA-Z_][\\w\\-\\.]*)?$/\n//var handlers = 'resolveEntity,getExternalSubset,characters,endDocument,endElement,endPrefixMapping,ignorableWhitespace,processingInstruction,setDocumentLocator,skippedEntity,startDocument,startElement,startPrefixMapping,notationDecl,unparsedEntityDecl,error,fatalError,warning,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,comment,endCDATA,endDTD,endEntity,startCDATA,startDTD,startEntity'.split(',')\n\n//S_TAG,\tS_ATTR,\tS_EQ,\tS_ATTR_NOQUOT_VALUE\n//S_ATTR_SPACE,\tS_ATTR_END,\tS_TAG_SPACE, S_TAG_CLOSE\nvar S_TAG = 0;//tag name offerring\nvar S_ATTR = 1;//attr name offerring\nvar S_ATTR_SPACE=2;//attr name end and space offer\nvar S_EQ = 3;//=space?\nvar S_ATTR_NOQUOT_VALUE = 4;//attr value(no quot value only)\nvar S_ATTR_END = 5;//attr value end and no space(quot end)\nvar S_TAG_SPACE = 6;//(attr value end || tag end ) && (space offer)\nvar S_TAG_CLOSE = 7;//closed el<el />\n\n/**\n * Creates an error that will not be caught by XMLReader aka the SAX parser.\n *\n * @param {string} message\n * @param {any?} locator Optional, can provide details about the location in the source\n * @constructor\n */\nfunction ParseError(message, locator) {\n\tthis.message = message\n\tthis.locator = locator\n\tif(Error.captureStackTrace) Error.captureStackTrace(this, ParseError);\n}\nParseError.prototype = new Error();\nParseError.prototype.name = ParseError.name\n\nfunction XMLReader(){\n\n}\n\nXMLReader.prototype = {\n\tparse:function(source,defaultNSMap,entityMap){\n\t\tvar domBuilder = this.domBuilder;\n\t\tdomBuilder.startDocument();\n\t\t_copy(defaultNSMap ,defaultNSMap = {})\n\t\tparse(source,defaultNSMap,entityMap,\n\t\t\t\tdomBuilder,this.errorHandler);\n\t\tdomBuilder.endDocument();\n\t}\n}\nfunction parse(source,defaultNSMapCopy,entityMap,domBuilder,errorHandler){\n\tfunction fixedFromCharCode(code) {\n\t\t// String.prototype.fromCharCode does not supports\n\t\t// > 2 bytes unicode chars directly\n\t\tif (code > 0xffff) {\n\t\t\tcode -= 0x10000;\n\t\t\tvar surrogate1 = 0xd800 + (code >> 10)\n\t\t\t\t, surrogate2 = 0xdc00 + (code & 0x3ff);\n\n\t\t\treturn String.fromCharCode(surrogate1, surrogate2);\n\t\t} else {\n\t\t\treturn String.fromCharCode(code);\n\t\t}\n\t}\n\tfunction entityReplacer(a){\n\t\tvar k = a.slice(1,-1);\n\t\tif (Object.hasOwnProperty.call(entityMap, k)) {\n\t\t\treturn entityMap[k];\n\t\t}else if(k.charAt(0) === '#'){\n\t\t\treturn fixedFromCharCode(parseInt(k.substr(1).replace('x','0x')))\n\t\t}else{\n\t\t\terrorHandler.error('entity not found:'+a);\n\t\t\treturn a;\n\t\t}\n\t}\n\tfunction appendText(end){//has some bugs\n\t\tif(end>start){\n\t\t\tvar xt = source.substring(start,end).replace(/&#?\\w+;/g,entityReplacer);\n\t\t\tlocator&&position(start);\n\t\t\tdomBuilder.characters(xt,0,end-start);\n\t\t\tstart = end\n\t\t}\n\t}\n\tfunction position(p,m){\n\t\twhile(p>=lineEnd && (m = linePattern.exec(source))){\n\t\t\tlineStart = m.index;\n\t\t\tlineEnd = lineStart + m[0].length;\n\t\t\tlocator.lineNumber++;\n\t\t\t//console.log('line++:',locator,startPos,endPos)\n\t\t}\n\t\tlocator.columnNumber = p-lineStart+1;\n\t}\n\tvar lineStart = 0;\n\tvar lineEnd = 0;\n\tvar linePattern = /.*(?:\\r\\n?|\\n)|.*$/g\n\tvar locator = domBuilder.locator;\n\n\tvar parseStack = [{currentNSMap:defaultNSMapCopy}]\n\tvar closeMap = {};\n\tvar start = 0;\n\twhile(true){\n\t\ttry{\n\t\t\tvar tagStart = source.indexOf('<',start);\n\t\t\tif(tagStart<0){\n\t\t\t\tif(!source.substr(start).match(/^\\s*$/)){\n\t\t\t\t\tvar doc = domBuilder.doc;\n\t    \t\t\tvar text = doc.createTextNode(source.substr(start));\n\t    \t\t\tdoc.appendChild(text);\n\t    \t\t\tdomBuilder.currentElement = text;\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif(tagStart>start){\n\t\t\t\tappendText(tagStart);\n\t\t\t}\n\t\t\tswitch(source.charAt(tagStart+1)){\n\t\t\tcase '/':\n\t\t\t\tvar end = source.indexOf('>',tagStart+3);\n\t\t\t\tvar tagName = source.substring(tagStart + 2, end).replace(/[ \\t\\n\\r]+$/g, '');\n\t\t\t\tvar config = parseStack.pop();\n\t\t\t\tif(end<0){\n\n\t        \t\ttagName = source.substring(tagStart+2).replace(/[\\s<].*/,'');\n\t        \t\terrorHandler.error(\"end tag name: \"+tagName+' is not complete:'+config.tagName);\n\t        \t\tend = tagStart+1+tagName.length;\n\t        \t}else if(tagName.match(/\\s</)){\n\t        \t\ttagName = tagName.replace(/[\\s<].*/,'');\n\t        \t\terrorHandler.error(\"end tag name: \"+tagName+' maybe not complete');\n\t        \t\tend = tagStart+1+tagName.length;\n\t\t\t\t}\n\t\t\t\tvar localNSMap = config.localNSMap;\n\t\t\t\tvar endMatch = config.tagName == tagName;\n\t\t\t\tvar endIgnoreCaseMach = endMatch || config.tagName&&config.tagName.toLowerCase() == tagName.toLowerCase()\n\t\t        if(endIgnoreCaseMach){\n\t\t        \tdomBuilder.endElement(config.uri,config.localName,tagName);\n\t\t\t\t\tif(localNSMap){\n\t\t\t\t\t\tfor (var prefix in localNSMap) {\n\t\t\t\t\t\t\tif (Object.prototype.hasOwnProperty.call(localNSMap, prefix)) {\n\t\t\t\t\t\t\t\tdomBuilder.endPrefixMapping(prefix);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(!endMatch){\n\t\t            \terrorHandler.fatalError(\"end tag name: \"+tagName+' is not match the current start tagName:'+config.tagName ); // No known test case\n\t\t\t\t\t}\n\t\t        }else{\n\t\t        \tparseStack.push(config)\n\t\t        }\n\n\t\t\t\tend++;\n\t\t\t\tbreak;\n\t\t\t\t// end elment\n\t\t\tcase '?':// <?...?>\n\t\t\t\tlocator&&position(tagStart);\n\t\t\t\tend = parseInstruction(source,tagStart,domBuilder);\n\t\t\t\tbreak;\n\t\t\tcase '!':// <!doctype,<![CDATA,<!--\n\t\t\t\tlocator&&position(tagStart);\n\t\t\t\tend = parseDCC(source,tagStart,domBuilder,errorHandler);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tlocator&&position(tagStart);\n\t\t\t\tvar el = new ElementAttributes();\n\t\t\t\tvar currentNSMap = parseStack[parseStack.length-1].currentNSMap;\n\t\t\t\t//elStartEnd\n\t\t\t\tvar end = parseElementStartPart(source,tagStart,el,currentNSMap,entityReplacer,errorHandler);\n\t\t\t\tvar len = el.length;\n\n\n\t\t\t\tif(!el.closed && fixSelfClosed(source,end,el.tagName,closeMap)){\n\t\t\t\t\tel.closed = true;\n\t\t\t\t\tif(!entityMap.nbsp){\n\t\t\t\t\t\terrorHandler.warning('unclosed xml attribute');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(locator && len){\n\t\t\t\t\tvar locator2 = copyLocator(locator,{});\n\t\t\t\t\t//try{//attribute position fixed\n\t\t\t\t\tfor(var i = 0;i<len;i++){\n\t\t\t\t\t\tvar a = el[i];\n\t\t\t\t\t\tposition(a.offset);\n\t\t\t\t\t\ta.locator = copyLocator(locator,{});\n\t\t\t\t\t}\n\t\t\t\t\tdomBuilder.locator = locator2\n\t\t\t\t\tif(appendElement(el,domBuilder,currentNSMap)){\n\t\t\t\t\t\tparseStack.push(el)\n\t\t\t\t\t}\n\t\t\t\t\tdomBuilder.locator = locator;\n\t\t\t\t}else{\n\t\t\t\t\tif(appendElement(el,domBuilder,currentNSMap)){\n\t\t\t\t\t\tparseStack.push(el)\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (NAMESPACE.isHTML(el.uri) && !el.closed) {\n\t\t\t\t\tend = parseHtmlSpecialContent(source,end,el.tagName,entityReplacer,domBuilder)\n\t\t\t\t} else {\n\t\t\t\t\tend++;\n\t\t\t\t}\n\t\t\t}\n\t\t}catch(e){\n\t\t\tif (e instanceof ParseError) {\n\t\t\t\tthrow e;\n\t\t\t}\n\t\t\terrorHandler.error('element parse error: '+e)\n\t\t\tend = -1;\n\t\t}\n\t\tif(end>start){\n\t\t\tstart = end;\n\t\t}else{\n\t\t\t//TODO: sax\n\t\t\tappendText(Math.max(tagStart,start)+1);\n\t\t}\n\t}\n}\nfunction copyLocator(f,t){\n\tt.lineNumber = f.lineNumber;\n\tt.columnNumber = f.columnNumber;\n\treturn t;\n}\n\n/**\n * @see #appendElement(source,elStartEnd,el,selfClosed,entityReplacer,domBuilder,parseStack);\n * @return end of the elementStartPart(end of elementEndPart for selfClosed el)\n */\nfunction parseElementStartPart(source,start,el,currentNSMap,entityReplacer,errorHandler){\n\n\t/**\n\t * @param {string} qname\n\t * @param {string} value\n\t * @param {number} startIndex\n\t */\n\tfunction addAttribute(qname, value, startIndex) {\n\t\tif (el.attributeNames.hasOwnProperty(qname)) {\n\t\t\terrorHandler.fatalError('Attribute ' + qname + ' redefined')\n\t\t}\n\t\tel.addValue(\n\t\t\tqname,\n\t\t\t// @see https://www.w3.org/TR/xml/#AVNormalize\n\t\t\t// since the xmldom sax parser does not \"interpret\" DTD the following is not implemented:\n\t\t\t// - recursive replacement of (DTD) entity references\n\t\t\t// - trimming and collapsing multiple spaces into a single one for attributes that are not of type CDATA\n\t\t\tvalue.replace(/[\\t\\n\\r]/g, ' ').replace(/&#?\\w+;/g, entityReplacer),\n\t\t\tstartIndex\n\t\t)\n\t}\n\tvar attrName;\n\tvar value;\n\tvar p = ++start;\n\tvar s = S_TAG;//status\n\twhile(true){\n\t\tvar c = source.charAt(p);\n\t\tswitch(c){\n\t\tcase '=':\n\t\t\tif(s === S_ATTR){//attrName\n\t\t\t\tattrName = source.slice(start,p);\n\t\t\t\ts = S_EQ;\n\t\t\t}else if(s === S_ATTR_SPACE){\n\t\t\t\ts = S_EQ;\n\t\t\t}else{\n\t\t\t\t//fatalError: equal must after attrName or space after attrName\n\t\t\t\tthrow new Error('attribute equal must after attrName'); // No known test case\n\t\t\t}\n\t\t\tbreak;\n\t\tcase '\\'':\n\t\tcase '\"':\n\t\t\tif(s === S_EQ || s === S_ATTR //|| s == S_ATTR_SPACE\n\t\t\t\t){//equal\n\t\t\t\tif(s === S_ATTR){\n\t\t\t\t\terrorHandler.warning('attribute value must after \"=\"')\n\t\t\t\t\tattrName = source.slice(start,p)\n\t\t\t\t}\n\t\t\t\tstart = p+1;\n\t\t\t\tp = source.indexOf(c,start)\n\t\t\t\tif(p>0){\n\t\t\t\t\tvalue = source.slice(start, p);\n\t\t\t\t\taddAttribute(attrName, value, start-1);\n\t\t\t\t\ts = S_ATTR_END;\n\t\t\t\t}else{\n\t\t\t\t\t//fatalError: no end quot match\n\t\t\t\t\tthrow new Error('attribute value no end \\''+c+'\\' match');\n\t\t\t\t}\n\t\t\t}else if(s == S_ATTR_NOQUOT_VALUE){\n\t\t\t\tvalue = source.slice(start, p);\n\t\t\t\taddAttribute(attrName, value, start);\n\t\t\t\terrorHandler.warning('attribute \"'+attrName+'\" missed start quot('+c+')!!');\n\t\t\t\tstart = p+1;\n\t\t\t\ts = S_ATTR_END\n\t\t\t}else{\n\t\t\t\t//fatalError: no equal before\n\t\t\t\tthrow new Error('attribute value must after \"=\"'); // No known test case\n\t\t\t}\n\t\t\tbreak;\n\t\tcase '/':\n\t\t\tswitch(s){\n\t\t\tcase S_TAG:\n\t\t\t\tel.setTagName(source.slice(start,p));\n\t\t\tcase S_ATTR_END:\n\t\t\tcase S_TAG_SPACE:\n\t\t\tcase S_TAG_CLOSE:\n\t\t\t\ts =S_TAG_CLOSE;\n\t\t\t\tel.closed = true;\n\t\t\tcase S_ATTR_NOQUOT_VALUE:\n\t\t\tcase S_ATTR:\n\t\t\tcase S_ATTR_SPACE:\n\t\t\t\tbreak;\n\t\t\t//case S_EQ:\n\t\t\tdefault:\n\t\t\t\tthrow new Error(\"attribute invalid close char('/')\") // No known test case\n\t\t\t}\n\t\t\tbreak;\n\t\tcase ''://end document\n\t\t\terrorHandler.error('unexpected end of input');\n\t\t\tif(s == S_TAG){\n\t\t\t\tel.setTagName(source.slice(start,p));\n\t\t\t}\n\t\t\treturn p;\n\t\tcase '>':\n\t\t\tswitch(s){\n\t\t\tcase S_TAG:\n\t\t\t\tel.setTagName(source.slice(start,p));\n\t\t\tcase S_ATTR_END:\n\t\t\tcase S_TAG_SPACE:\n\t\t\tcase S_TAG_CLOSE:\n\t\t\t\tbreak;//normal\n\t\t\tcase S_ATTR_NOQUOT_VALUE://Compatible state\n\t\t\tcase S_ATTR:\n\t\t\t\tvalue = source.slice(start,p);\n\t\t\t\tif(value.slice(-1) === '/'){\n\t\t\t\t\tel.closed  = true;\n\t\t\t\t\tvalue = value.slice(0,-1)\n\t\t\t\t}\n\t\t\tcase S_ATTR_SPACE:\n\t\t\t\tif(s === S_ATTR_SPACE){\n\t\t\t\t\tvalue = attrName;\n\t\t\t\t}\n\t\t\t\tif(s == S_ATTR_NOQUOT_VALUE){\n\t\t\t\t\terrorHandler.warning('attribute \"'+value+'\" missed quot(\")!');\n\t\t\t\t\taddAttribute(attrName, value, start)\n\t\t\t\t}else{\n\t\t\t\t\tif(!NAMESPACE.isHTML(currentNSMap['']) || !value.match(/^(?:disabled|checked|selected)$/i)){\n\t\t\t\t\t\terrorHandler.warning('attribute \"'+value+'\" missed value!! \"'+value+'\" instead!!')\n\t\t\t\t\t}\n\t\t\t\t\taddAttribute(value, value, start)\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase S_EQ:\n\t\t\t\tthrow new Error('attribute value missed!!');\n\t\t\t}\n//\t\t\tconsole.log(tagName,tagNamePattern,tagNamePattern.test(tagName))\n\t\t\treturn p;\n\t\t/*xml space '\\x20' | #x9 | #xD | #xA; */\n\t\tcase '\\u0080':\n\t\t\tc = ' ';\n\t\tdefault:\n\t\t\tif(c<= ' '){//space\n\t\t\t\tswitch(s){\n\t\t\t\tcase S_TAG:\n\t\t\t\t\tel.setTagName(source.slice(start,p));//tagName\n\t\t\t\t\ts = S_TAG_SPACE;\n\t\t\t\t\tbreak;\n\t\t\t\tcase S_ATTR:\n\t\t\t\t\tattrName = source.slice(start,p)\n\t\t\t\t\ts = S_ATTR_SPACE;\n\t\t\t\t\tbreak;\n\t\t\t\tcase S_ATTR_NOQUOT_VALUE:\n\t\t\t\t\tvar value = source.slice(start, p);\n\t\t\t\t\terrorHandler.warning('attribute \"'+value+'\" missed quot(\")!!');\n\t\t\t\t\taddAttribute(attrName, value, start)\n\t\t\t\tcase S_ATTR_END:\n\t\t\t\t\ts = S_TAG_SPACE;\n\t\t\t\t\tbreak;\n\t\t\t\t//case S_TAG_SPACE:\n\t\t\t\t//case S_EQ:\n\t\t\t\t//case S_ATTR_SPACE:\n\t\t\t\t//\tvoid();break;\n\t\t\t\t//case S_TAG_CLOSE:\n\t\t\t\t\t//ignore warning\n\t\t\t\t}\n\t\t\t}else{//not space\n//S_TAG,\tS_ATTR,\tS_EQ,\tS_ATTR_NOQUOT_VALUE\n//S_ATTR_SPACE,\tS_ATTR_END,\tS_TAG_SPACE, S_TAG_CLOSE\n\t\t\t\tswitch(s){\n\t\t\t\t//case S_TAG:void();break;\n\t\t\t\t//case S_ATTR:void();break;\n\t\t\t\t//case S_ATTR_NOQUOT_VALUE:void();break;\n\t\t\t\tcase S_ATTR_SPACE:\n\t\t\t\t\tvar tagName =  el.tagName;\n\t\t\t\t\tif (!NAMESPACE.isHTML(currentNSMap['']) || !attrName.match(/^(?:disabled|checked|selected)$/i)) {\n\t\t\t\t\t\terrorHandler.warning('attribute \"'+attrName+'\" missed value!! \"'+attrName+'\" instead2!!')\n\t\t\t\t\t}\n\t\t\t\t\taddAttribute(attrName, attrName, start);\n\t\t\t\t\tstart = p;\n\t\t\t\t\ts = S_ATTR;\n\t\t\t\t\tbreak;\n\t\t\t\tcase S_ATTR_END:\n\t\t\t\t\terrorHandler.warning('attribute space is required\"'+attrName+'\"!!')\n\t\t\t\tcase S_TAG_SPACE:\n\t\t\t\t\ts = S_ATTR;\n\t\t\t\t\tstart = p;\n\t\t\t\t\tbreak;\n\t\t\t\tcase S_EQ:\n\t\t\t\t\ts = S_ATTR_NOQUOT_VALUE;\n\t\t\t\t\tstart = p;\n\t\t\t\t\tbreak;\n\t\t\t\tcase S_TAG_CLOSE:\n\t\t\t\t\tthrow new Error(\"elements closed character '/' and '>' must be connected to\");\n\t\t\t\t}\n\t\t\t}\n\t\t}//end outer switch\n\t\t//console.log('p++',p)\n\t\tp++;\n\t}\n}\n/**\n * @return true if has new namespace define\n */\nfunction appendElement(el,domBuilder,currentNSMap){\n\tvar tagName = el.tagName;\n\tvar localNSMap = null;\n\t//var currentNSMap = parseStack[parseStack.length-1].currentNSMap;\n\tvar i = el.length;\n\twhile(i--){\n\t\tvar a = el[i];\n\t\tvar qName = a.qName;\n\t\tvar value = a.value;\n\t\tvar nsp = qName.indexOf(':');\n\t\tif(nsp>0){\n\t\t\tvar prefix = a.prefix = qName.slice(0,nsp);\n\t\t\tvar localName = qName.slice(nsp+1);\n\t\t\tvar nsPrefix = prefix === 'xmlns' && localName\n\t\t}else{\n\t\t\tlocalName = qName;\n\t\t\tprefix = null\n\t\t\tnsPrefix = qName === 'xmlns' && ''\n\t\t}\n\t\t//can not set prefix,because prefix !== ''\n\t\ta.localName = localName ;\n\t\t//prefix == null for no ns prefix attribute\n\t\tif(nsPrefix !== false){//hack!!\n\t\t\tif(localNSMap == null){\n\t\t\t\tlocalNSMap = {}\n\t\t\t\t//console.log(currentNSMap,0)\n\t\t\t\t_copy(currentNSMap,currentNSMap={})\n\t\t\t\t//console.log(currentNSMap,1)\n\t\t\t}\n\t\t\tcurrentNSMap[nsPrefix] = localNSMap[nsPrefix] = value;\n\t\t\ta.uri = NAMESPACE.XMLNS\n\t\t\tdomBuilder.startPrefixMapping(nsPrefix, value)\n\t\t}\n\t}\n\tvar i = el.length;\n\twhile(i--){\n\t\ta = el[i];\n\t\tvar prefix = a.prefix;\n\t\tif(prefix){//no prefix attribute has no namespace\n\t\t\tif(prefix === 'xml'){\n\t\t\t\ta.uri = NAMESPACE.XML;\n\t\t\t}if(prefix !== 'xmlns'){\n\t\t\t\ta.uri = currentNSMap[prefix || '']\n\n\t\t\t\t//{console.log('###'+a.qName,domBuilder.locator.systemId+'',currentNSMap,a.uri)}\n\t\t\t}\n\t\t}\n\t}\n\tvar nsp = tagName.indexOf(':');\n\tif(nsp>0){\n\t\tprefix = el.prefix = tagName.slice(0,nsp);\n\t\tlocalName = el.localName = tagName.slice(nsp+1);\n\t}else{\n\t\tprefix = null;//important!!\n\t\tlocalName = el.localName = tagName;\n\t}\n\t//no prefix element has default namespace\n\tvar ns = el.uri = currentNSMap[prefix || ''];\n\tdomBuilder.startElement(ns,localName,tagName,el);\n\t//endPrefixMapping and startPrefixMapping have not any help for dom builder\n\t//localNSMap = null\n\tif(el.closed){\n\t\tdomBuilder.endElement(ns,localName,tagName);\n\t\tif(localNSMap){\n\t\t\tfor (prefix in localNSMap) {\n\t\t\t\tif (Object.prototype.hasOwnProperty.call(localNSMap, prefix)) {\n\t\t\t\t\tdomBuilder.endPrefixMapping(prefix);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}else{\n\t\tel.currentNSMap = currentNSMap;\n\t\tel.localNSMap = localNSMap;\n\t\t//parseStack.push(el);\n\t\treturn true;\n\t}\n}\nfunction parseHtmlSpecialContent(source,elStartEnd,tagName,entityReplacer,domBuilder){\n\tif(/^(?:script|textarea)$/i.test(tagName)){\n\t\tvar elEndStart =  source.indexOf('</'+tagName+'>',elStartEnd);\n\t\tvar text = source.substring(elStartEnd+1,elEndStart);\n\t\tif(/[&<]/.test(text)){\n\t\t\tif(/^script$/i.test(tagName)){\n\t\t\t\t//if(!/\\]\\]>/.test(text)){\n\t\t\t\t\t//lexHandler.startCDATA();\n\t\t\t\t\tdomBuilder.characters(text,0,text.length);\n\t\t\t\t\t//lexHandler.endCDATA();\n\t\t\t\t\treturn elEndStart;\n\t\t\t\t//}\n\t\t\t}//}else{//text area\n\t\t\t\ttext = text.replace(/&#?\\w+;/g,entityReplacer);\n\t\t\t\tdomBuilder.characters(text,0,text.length);\n\t\t\t\treturn elEndStart;\n\t\t\t//}\n\n\t\t}\n\t}\n\treturn elStartEnd+1;\n}\nfunction fixSelfClosed(source,elStartEnd,tagName,closeMap){\n\t//if(tagName in closeMap){\n\tvar pos = closeMap[tagName];\n\tif(pos == null){\n\t\t//console.log(tagName)\n\t\tpos =  source.lastIndexOf('</'+tagName+'>')\n\t\tif(pos<elStartEnd){//\n\t\t\tpos = source.lastIndexOf('</'+tagName)\n\t\t}\n\t\tcloseMap[tagName] =pos\n\t}\n\treturn pos<elStartEnd;\n\t//}\n}\n\nfunction _copy (source, target) {\n\tfor (var n in source) {\n\t\tif (Object.prototype.hasOwnProperty.call(source, n)) {\n\t\t\ttarget[n] = source[n];\n\t\t}\n\t}\n}\n\nfunction parseDCC(source,start,domBuilder,errorHandler){//sure start with '<!'\n\tvar next= source.charAt(start+2)\n\tswitch(next){\n\tcase '-':\n\t\tif(source.charAt(start + 3) === '-'){\n\t\t\tvar end = source.indexOf('-->',start+4);\n\t\t\t//append comment source.substring(4,end)//<!--\n\t\t\tif(end>start){\n\t\t\t\tdomBuilder.comment(source,start+4,end-start-4);\n\t\t\t\treturn end+3;\n\t\t\t}else{\n\t\t\t\terrorHandler.error(\"Unclosed comment\");\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t}else{\n\t\t\t//error\n\t\t\treturn -1;\n\t\t}\n\tdefault:\n\t\tif(source.substr(start+3,6) == 'CDATA['){\n\t\t\tvar end = source.indexOf(']]>',start+9);\n\t\t\tdomBuilder.startCDATA();\n\t\t\tdomBuilder.characters(source,start+9,end-start-9);\n\t\t\tdomBuilder.endCDATA()\n\t\t\treturn end+3;\n\t\t}\n\t\t//<!DOCTYPE\n\t\t//startDTD(java.lang.String name, java.lang.String publicId, java.lang.String systemId)\n\t\tvar matchs = split(source,start);\n\t\tvar len = matchs.length;\n\t\tif(len>1 && /!doctype/i.test(matchs[0][0])){\n\t\t\tvar name = matchs[1][0];\n\t\t\tvar pubid = false;\n\t\t\tvar sysid = false;\n\t\t\tif(len>3){\n\t\t\t\tif(/^public$/i.test(matchs[2][0])){\n\t\t\t\t\tpubid = matchs[3][0];\n\t\t\t\t\tsysid = len>4 && matchs[4][0];\n\t\t\t\t}else if(/^system$/i.test(matchs[2][0])){\n\t\t\t\t\tsysid = matchs[3][0];\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar lastMatch = matchs[len-1]\n\t\t\tdomBuilder.startDTD(name, pubid, sysid);\n\t\t\tdomBuilder.endDTD();\n\n\t\t\treturn lastMatch.index+lastMatch[0].length\n\t\t}\n\t}\n\treturn -1;\n}\n\n\n\nfunction parseInstruction(source,start,domBuilder){\n\tvar end = source.indexOf('?>',start);\n\tif(end){\n\t\tvar match = source.substring(start,end).match(/^<\\?(\\S*)\\s*([\\s\\S]*?)\\s*$/);\n\t\tif(match){\n\t\t\tvar len = match[0].length;\n\t\t\tdomBuilder.processingInstruction(match[1], match[2]) ;\n\t\t\treturn end+2;\n\t\t}else{//error\n\t\t\treturn -1;\n\t\t}\n\t}\n\treturn -1;\n}\n\nfunction ElementAttributes(){\n\tthis.attributeNames = {}\n}\nElementAttributes.prototype = {\n\tsetTagName:function(tagName){\n\t\tif(!tagNamePattern.test(tagName)){\n\t\t\tthrow new Error('invalid tagName:'+tagName)\n\t\t}\n\t\tthis.tagName = tagName\n\t},\n\taddValue:function(qName, value, offset) {\n\t\tif(!tagNamePattern.test(qName)){\n\t\t\tthrow new Error('invalid attribute:'+qName)\n\t\t}\n\t\tthis.attributeNames[qName] = this.length;\n\t\tthis[this.length++] = {qName:qName,value:value,offset:offset}\n\t},\n\tlength:0,\n\tgetLocalName:function(i){return this[i].localName},\n\tgetLocator:function(i){return this[i].locator},\n\tgetQName:function(i){return this[i].qName},\n\tgetURI:function(i){return this[i].uri},\n\tgetValue:function(i){return this[i].value}\n//\t,getIndex:function(uri, localName)){\n//\t\tif(localName){\n//\n//\t\t}else{\n//\t\t\tvar qName = uri\n//\t\t}\n//\t},\n//\tgetValue:function(){return this.getValue(this.getIndex.apply(this,arguments))},\n//\tgetType:function(uri,localName){}\n//\tgetType:function(i){},\n}\n\n\n\nfunction split(source,start){\n\tvar match;\n\tvar buf = [];\n\tvar reg = /'[^']+'|\"[^\"]+\"|[^\\s<>\\/=]+=?|(\\/?\\s*>|<)/g;\n\treg.lastIndex = start;\n\treg.exec(source);//skip <\n\twhile(match = reg.exec(source)){\n\t\tbuf.push(match);\n\t\tif(match[1])return buf;\n\t}\n}\n\nexports.XMLReader = XMLReader;\nexports.ParseError = ParseError;\n","var win;\n\nif (typeof window !== \"undefined\") {\n    win = window;\n} else if (typeof global !== \"undefined\") {\n    win = global;\n} else if (typeof self !== \"undefined\"){\n    win = self;\n} else {\n    win = {};\n}\n\nmodule.exports = win;\n","/*! @name mpd-parser @version 1.0.1 @license Apache-2.0 */\nimport resolveUrl from '@videojs/vhs-utils/es/resolve-url';\nimport window from 'global/window';\nimport { forEachMediaGroup } from '@videojs/vhs-utils/es/media-groups';\nimport decodeB64ToUint8Array from '@videojs/vhs-utils/es/decode-b64-to-uint8-array';\nimport { DOMParser } from '@xmldom/xmldom';\n\nvar version = \"1.0.1\";\n\nconst isObject = obj => {\n  return !!obj && typeof obj === 'object';\n};\n\nconst merge = (...objects) => {\n  return objects.reduce((result, source) => {\n    if (typeof source !== 'object') {\n      return result;\n    }\n\n    Object.keys(source).forEach(key => {\n      if (Array.isArray(result[key]) && Array.isArray(source[key])) {\n        result[key] = result[key].concat(source[key]);\n      } else if (isObject(result[key]) && isObject(source[key])) {\n        result[key] = merge(result[key], source[key]);\n      } else {\n        result[key] = source[key];\n      }\n    });\n    return result;\n  }, {});\n};\nconst values = o => Object.keys(o).map(k => o[k]);\n\nconst range = (start, end) => {\n  const result = [];\n\n  for (let i = start; i < end; i++) {\n    result.push(i);\n  }\n\n  return result;\n};\nconst flatten = lists => lists.reduce((x, y) => x.concat(y), []);\nconst from = list => {\n  if (!list.length) {\n    return [];\n  }\n\n  const result = [];\n\n  for (let i = 0; i < list.length; i++) {\n    result.push(list[i]);\n  }\n\n  return result;\n};\nconst findIndexes = (l, key) => l.reduce((a, e, i) => {\n  if (e[key]) {\n    a.push(i);\n  }\n\n  return a;\n}, []);\n/**\n * Returns a union of the included lists provided each element can be identified by a key.\n *\n * @param {Array} list - list of lists to get the union of\n * @param {Function} keyFunction - the function to use as a key for each element\n *\n * @return {Array} the union of the arrays\n */\n\nconst union = (lists, keyFunction) => {\n  return values(lists.reduce((acc, list) => {\n    list.forEach(el => {\n      acc[keyFunction(el)] = el;\n    });\n    return acc;\n  }, {}));\n};\n\nvar errors = {\n  INVALID_NUMBER_OF_PERIOD: 'INVALID_NUMBER_OF_PERIOD',\n  DASH_EMPTY_MANIFEST: 'DASH_EMPTY_MANIFEST',\n  DASH_INVALID_XML: 'DASH_INVALID_XML',\n  NO_BASE_URL: 'NO_BASE_URL',\n  MISSING_SEGMENT_INFORMATION: 'MISSING_SEGMENT_INFORMATION',\n  SEGMENT_TIME_UNSPECIFIED: 'SEGMENT_TIME_UNSPECIFIED',\n  UNSUPPORTED_UTC_TIMING_SCHEME: 'UNSUPPORTED_UTC_TIMING_SCHEME'\n};\n\n/**\n * @typedef {Object} SingleUri\n * @property {string} uri - relative location of segment\n * @property {string} resolvedUri - resolved location of segment\n * @property {Object} byterange - Object containing information on how to make byte range\n *   requests following byte-range-spec per RFC2616.\n * @property {String} byterange.length - length of range request\n * @property {String} byterange.offset - byte offset of range request\n *\n * @see https://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.35.1\n */\n\n/**\n * Converts a URLType node (5.3.9.2.3 Table 13) to a segment object\n * that conforms to how m3u8-parser is structured\n *\n * @see https://github.com/videojs/m3u8-parser\n *\n * @param {string} baseUrl - baseUrl provided by <BaseUrl> nodes\n * @param {string} source - source url for segment\n * @param {string} range - optional range used for range calls,\n *   follows  RFC 2616, Clause 14.35.1\n * @return {SingleUri} full segment information transformed into a format similar\n *   to m3u8-parser\n */\n\nconst urlTypeToSegment = ({\n  baseUrl = '',\n  source = '',\n  range = '',\n  indexRange = ''\n}) => {\n  const segment = {\n    uri: source,\n    resolvedUri: resolveUrl(baseUrl || '', source)\n  };\n\n  if (range || indexRange) {\n    const rangeStr = range ? range : indexRange;\n    const ranges = rangeStr.split('-'); // default to parsing this as a BigInt if possible\n\n    let startRange = window.BigInt ? window.BigInt(ranges[0]) : parseInt(ranges[0], 10);\n    let endRange = window.BigInt ? window.BigInt(ranges[1]) : parseInt(ranges[1], 10); // convert back to a number if less than MAX_SAFE_INTEGER\n\n    if (startRange < Number.MAX_SAFE_INTEGER && typeof startRange === 'bigint') {\n      startRange = Number(startRange);\n    }\n\n    if (endRange < Number.MAX_SAFE_INTEGER && typeof endRange === 'bigint') {\n      endRange = Number(endRange);\n    }\n\n    let length;\n\n    if (typeof endRange === 'bigint' || typeof startRange === 'bigint') {\n      length = window.BigInt(endRange) - window.BigInt(startRange) + window.BigInt(1);\n    } else {\n      length = endRange - startRange + 1;\n    }\n\n    if (typeof length === 'bigint' && length < Number.MAX_SAFE_INTEGER) {\n      length = Number(length);\n    } // byterange should be inclusive according to\n    // RFC 2616, Clause 14.35.1\n\n\n    segment.byterange = {\n      length,\n      offset: startRange\n    };\n  }\n\n  return segment;\n};\nconst byteRangeToString = byterange => {\n  // `endRange` is one less than `offset + length` because the HTTP range\n  // header uses inclusive ranges\n  let endRange;\n\n  if (typeof byterange.offset === 'bigint' || typeof byterange.length === 'bigint') {\n    endRange = window.BigInt(byterange.offset) + window.BigInt(byterange.length) - window.BigInt(1);\n  } else {\n    endRange = byterange.offset + byterange.length - 1;\n  }\n\n  return `${byterange.offset}-${endRange}`;\n};\n\n/**\n * parse the end number attribue that can be a string\n * number, or undefined.\n *\n * @param {string|number|undefined} endNumber\n *        The end number attribute.\n *\n * @return {number|null}\n *          The result of parsing the end number.\n */\n\nconst parseEndNumber = endNumber => {\n  if (endNumber && typeof endNumber !== 'number') {\n    endNumber = parseInt(endNumber, 10);\n  }\n\n  if (isNaN(endNumber)) {\n    return null;\n  }\n\n  return endNumber;\n};\n/**\n * Functions for calculating the range of available segments in static and dynamic\n * manifests.\n */\n\n\nconst segmentRange = {\n  /**\n   * Returns the entire range of available segments for a static MPD\n   *\n   * @param {Object} attributes\n   *        Inheritied MPD attributes\n   * @return {{ start: number, end: number }}\n   *         The start and end numbers for available segments\n   */\n  static(attributes) {\n    const {\n      duration,\n      timescale = 1,\n      sourceDuration,\n      periodDuration\n    } = attributes;\n    const endNumber = parseEndNumber(attributes.endNumber);\n    const segmentDuration = duration / timescale;\n\n    if (typeof endNumber === 'number') {\n      return {\n        start: 0,\n        end: endNumber\n      };\n    }\n\n    if (typeof periodDuration === 'number') {\n      return {\n        start: 0,\n        end: periodDuration / segmentDuration\n      };\n    }\n\n    return {\n      start: 0,\n      end: sourceDuration / segmentDuration\n    };\n  },\n\n  /**\n   * Returns the current live window range of available segments for a dynamic MPD\n   *\n   * @param {Object} attributes\n   *        Inheritied MPD attributes\n   * @return {{ start: number, end: number }}\n   *         The start and end numbers for available segments\n   */\n  dynamic(attributes) {\n    const {\n      NOW,\n      clientOffset,\n      availabilityStartTime,\n      timescale = 1,\n      duration,\n      periodStart = 0,\n      minimumUpdatePeriod = 0,\n      timeShiftBufferDepth = Infinity\n    } = attributes;\n    const endNumber = parseEndNumber(attributes.endNumber); // clientOffset is passed in at the top level of mpd-parser and is an offset calculated\n    // after retrieving UTC server time.\n\n    const now = (NOW + clientOffset) / 1000; // WC stands for Wall Clock.\n    // Convert the period start time to EPOCH.\n\n    const periodStartWC = availabilityStartTime + periodStart; // Period end in EPOCH is manifest's retrieval time + time until next update.\n\n    const periodEndWC = now + minimumUpdatePeriod;\n    const periodDuration = periodEndWC - periodStartWC;\n    const segmentCount = Math.ceil(periodDuration * timescale / duration);\n    const availableStart = Math.floor((now - periodStartWC - timeShiftBufferDepth) * timescale / duration);\n    const availableEnd = Math.floor((now - periodStartWC) * timescale / duration);\n    return {\n      start: Math.max(0, availableStart),\n      end: typeof endNumber === 'number' ? endNumber : Math.min(segmentCount, availableEnd)\n    };\n  }\n\n};\n/**\n * Maps a range of numbers to objects with information needed to build the corresponding\n * segment list\n *\n * @name toSegmentsCallback\n * @function\n * @param {number} number\n *        Number of the segment\n * @param {number} index\n *        Index of the number in the range list\n * @return {{ number: Number, duration: Number, timeline: Number, time: Number }}\n *         Object with segment timing and duration info\n */\n\n/**\n * Returns a callback for Array.prototype.map for mapping a range of numbers to\n * information needed to build the segment list.\n *\n * @param {Object} attributes\n *        Inherited MPD attributes\n * @return {toSegmentsCallback}\n *         Callback map function\n */\n\nconst toSegments = attributes => number => {\n  const {\n    duration,\n    timescale = 1,\n    periodStart,\n    startNumber = 1\n  } = attributes;\n  return {\n    number: startNumber + number,\n    duration: duration / timescale,\n    timeline: periodStart,\n    time: number * duration\n  };\n};\n/**\n * Returns a list of objects containing segment timing and duration info used for\n * building the list of segments. This uses the @duration attribute specified\n * in the MPD manifest to derive the range of segments.\n *\n * @param {Object} attributes\n *        Inherited MPD attributes\n * @return {{number: number, duration: number, time: number, timeline: number}[]}\n *         List of Objects with segment timing and duration info\n */\n\nconst parseByDuration = attributes => {\n  const {\n    type,\n    duration,\n    timescale = 1,\n    periodDuration,\n    sourceDuration\n  } = attributes;\n  const {\n    start,\n    end\n  } = segmentRange[type](attributes);\n  const segments = range(start, end).map(toSegments(attributes));\n\n  if (type === 'static') {\n    const index = segments.length - 1; // section is either a period or the full source\n\n    const sectionDuration = typeof periodDuration === 'number' ? periodDuration : sourceDuration; // final segment may be less than full segment duration\n\n    segments[index].duration = sectionDuration - duration / timescale * index;\n  }\n\n  return segments;\n};\n\n/**\n * Translates SegmentBase into a set of segments.\n * (DASH SPEC Section 5.3.9.3.2) contains a set of <SegmentURL> nodes.  Each\n * node should be translated into segment.\n *\n * @param {Object} attributes\n *   Object containing all inherited attributes from parent elements with attribute\n *   names as keys\n * @return {Object.<Array>} list of segments\n */\n\nconst segmentsFromBase = attributes => {\n  const {\n    baseUrl,\n    initialization = {},\n    sourceDuration,\n    indexRange = '',\n    periodStart,\n    presentationTime,\n    number = 0,\n    duration\n  } = attributes; // base url is required for SegmentBase to work, per spec (Section 5.3.9.2.1)\n\n  if (!baseUrl) {\n    throw new Error(errors.NO_BASE_URL);\n  }\n\n  const initSegment = urlTypeToSegment({\n    baseUrl,\n    source: initialization.sourceURL,\n    range: initialization.range\n  });\n  const segment = urlTypeToSegment({\n    baseUrl,\n    source: baseUrl,\n    indexRange\n  });\n  segment.map = initSegment; // If there is a duration, use it, otherwise use the given duration of the source\n  // (since SegmentBase is only for one total segment)\n\n  if (duration) {\n    const segmentTimeInfo = parseByDuration(attributes);\n\n    if (segmentTimeInfo.length) {\n      segment.duration = segmentTimeInfo[0].duration;\n      segment.timeline = segmentTimeInfo[0].timeline;\n    }\n  } else if (sourceDuration) {\n    segment.duration = sourceDuration;\n    segment.timeline = periodStart;\n  } // If presentation time is provided, these segments are being generated by SIDX\n  // references, and should use the time provided. For the general case of SegmentBase,\n  // there should only be one segment in the period, so its presentation time is the same\n  // as its period start.\n\n\n  segment.presentationTime = presentationTime || periodStart;\n  segment.number = number;\n  return [segment];\n};\n/**\n * Given a playlist, a sidx box, and a baseUrl, update the segment list of the playlist\n * according to the sidx information given.\n *\n * playlist.sidx has metadadata about the sidx where-as the sidx param\n * is the parsed sidx box itself.\n *\n * @param {Object} playlist the playlist to update the sidx information for\n * @param {Object} sidx the parsed sidx box\n * @return {Object} the playlist object with the updated sidx information\n */\n\nconst addSidxSegmentsToPlaylist$1 = (playlist, sidx, baseUrl) => {\n  // Retain init segment information\n  const initSegment = playlist.sidx.map ? playlist.sidx.map : null; // Retain source duration from initial main manifest parsing\n\n  const sourceDuration = playlist.sidx.duration; // Retain source timeline\n\n  const timeline = playlist.timeline || 0;\n  const sidxByteRange = playlist.sidx.byterange;\n  const sidxEnd = sidxByteRange.offset + sidxByteRange.length; // Retain timescale of the parsed sidx\n\n  const timescale = sidx.timescale; // referenceType 1 refers to other sidx boxes\n\n  const mediaReferences = sidx.references.filter(r => r.referenceType !== 1);\n  const segments = [];\n  const type = playlist.endList ? 'static' : 'dynamic';\n  const periodStart = playlist.sidx.timeline;\n  let presentationTime = periodStart;\n  let number = playlist.mediaSequence || 0; // firstOffset is the offset from the end of the sidx box\n\n  let startIndex; // eslint-disable-next-line\n\n  if (typeof sidx.firstOffset === 'bigint') {\n    startIndex = window.BigInt(sidxEnd) + sidx.firstOffset;\n  } else {\n    startIndex = sidxEnd + sidx.firstOffset;\n  }\n\n  for (let i = 0; i < mediaReferences.length; i++) {\n    const reference = sidx.references[i]; // size of the referenced (sub)segment\n\n    const size = reference.referencedSize; // duration of the referenced (sub)segment, in  the  timescale\n    // this will be converted to seconds when generating segments\n\n    const duration = reference.subsegmentDuration; // should be an inclusive range\n\n    let endIndex; // eslint-disable-next-line\n\n    if (typeof startIndex === 'bigint') {\n      endIndex = startIndex + window.BigInt(size) - window.BigInt(1);\n    } else {\n      endIndex = startIndex + size - 1;\n    }\n\n    const indexRange = `${startIndex}-${endIndex}`;\n    const attributes = {\n      baseUrl,\n      timescale,\n      timeline,\n      periodStart,\n      presentationTime,\n      number,\n      duration,\n      sourceDuration,\n      indexRange,\n      type\n    };\n    const segment = segmentsFromBase(attributes)[0];\n\n    if (initSegment) {\n      segment.map = initSegment;\n    }\n\n    segments.push(segment);\n\n    if (typeof startIndex === 'bigint') {\n      startIndex += window.BigInt(size);\n    } else {\n      startIndex += size;\n    }\n\n    presentationTime += duration / timescale;\n    number++;\n  }\n\n  playlist.segments = segments;\n  return playlist;\n};\n\nconst SUPPORTED_MEDIA_TYPES = ['AUDIO', 'SUBTITLES']; // allow one 60fps frame as leniency (arbitrarily chosen)\n\nconst TIME_FUDGE = 1 / 60;\n/**\n * Given a list of timelineStarts, combines, dedupes, and sorts them.\n *\n * @param {TimelineStart[]} timelineStarts - list of timeline starts\n *\n * @return {TimelineStart[]} the combined and deduped timeline starts\n */\n\nconst getUniqueTimelineStarts = timelineStarts => {\n  return union(timelineStarts, ({\n    timeline\n  }) => timeline).sort((a, b) => a.timeline > b.timeline ? 1 : -1);\n};\n/**\n * Finds the playlist with the matching NAME attribute.\n *\n * @param {Array} playlists - playlists to search through\n * @param {string} name - the NAME attribute to search for\n *\n * @return {Object|null} the matching playlist object, or null\n */\n\nconst findPlaylistWithName = (playlists, name) => {\n  for (let i = 0; i < playlists.length; i++) {\n    if (playlists[i].attributes.NAME === name) {\n      return playlists[i];\n    }\n  }\n\n  return null;\n};\n/**\n * Gets a flattened array of media group playlists.\n *\n * @param {Object} manifest - the main manifest object\n *\n * @return {Array} the media group playlists\n */\n\nconst getMediaGroupPlaylists = manifest => {\n  let mediaGroupPlaylists = [];\n  forEachMediaGroup(manifest, SUPPORTED_MEDIA_TYPES, (properties, type, group, label) => {\n    mediaGroupPlaylists = mediaGroupPlaylists.concat(properties.playlists || []);\n  });\n  return mediaGroupPlaylists;\n};\n/**\n * Updates the playlist's media sequence numbers.\n *\n * @param {Object} config - options object\n * @param {Object} config.playlist - the playlist to update\n * @param {number} config.mediaSequence - the mediaSequence number to start with\n */\n\nconst updateMediaSequenceForPlaylist = ({\n  playlist,\n  mediaSequence\n}) => {\n  playlist.mediaSequence = mediaSequence;\n  playlist.segments.forEach((segment, index) => {\n    segment.number = playlist.mediaSequence + index;\n  });\n};\n/**\n * Updates the media and discontinuity sequence numbers of newPlaylists given oldPlaylists\n * and a complete list of timeline starts.\n *\n * If no matching playlist is found, only the discontinuity sequence number of the playlist\n * will be updated.\n *\n * Since early available timelines are not supported, at least one segment must be present.\n *\n * @param {Object} config - options object\n * @param {Object[]} oldPlaylists - the old playlists to use as a reference\n * @param {Object[]} newPlaylists - the new playlists to update\n * @param {Object} timelineStarts - all timelineStarts seen in the stream to this point\n */\n\nconst updateSequenceNumbers = ({\n  oldPlaylists,\n  newPlaylists,\n  timelineStarts\n}) => {\n  newPlaylists.forEach(playlist => {\n    playlist.discontinuitySequence = timelineStarts.findIndex(function ({\n      timeline\n    }) {\n      return timeline === playlist.timeline;\n    }); // Playlists NAMEs come from DASH Representation IDs, which are mandatory\n    // (see ISO_23009-1-2012 5.3.5.2).\n    //\n    // If the same Representation existed in a prior Period, it will retain the same NAME.\n\n    const oldPlaylist = findPlaylistWithName(oldPlaylists, playlist.attributes.NAME);\n\n    if (!oldPlaylist) {\n      // Since this is a new playlist, the media sequence values can start from 0 without\n      // consequence.\n      return;\n    } // TODO better support for live SIDX\n    //\n    // As of this writing, mpd-parser does not support multiperiod SIDX (in live or VOD).\n    // This is evident by a playlist only having a single SIDX reference. In a multiperiod\n    // playlist there would need to be multiple SIDX references. In addition, live SIDX is\n    // not supported when the SIDX properties change on refreshes.\n    //\n    // In the future, if support needs to be added, the merging logic here can be called\n    // after SIDX references are resolved. For now, exit early to prevent exceptions being\n    // thrown due to undefined references.\n\n\n    if (playlist.sidx) {\n      return;\n    } // Since we don't yet support early available timelines, we don't need to support\n    // playlists with no segments.\n\n\n    const firstNewSegment = playlist.segments[0];\n    const oldMatchingSegmentIndex = oldPlaylist.segments.findIndex(function (oldSegment) {\n      return Math.abs(oldSegment.presentationTime - firstNewSegment.presentationTime) < TIME_FUDGE;\n    }); // No matching segment from the old playlist means the entire playlist was refreshed.\n    // In this case the media sequence should account for this update, and the new segments\n    // should be marked as discontinuous from the prior content, since the last prior\n    // timeline was removed.\n\n    if (oldMatchingSegmentIndex === -1) {\n      updateMediaSequenceForPlaylist({\n        playlist,\n        mediaSequence: oldPlaylist.mediaSequence + oldPlaylist.segments.length\n      });\n      playlist.segments[0].discontinuity = true;\n      playlist.discontinuityStarts.unshift(0); // No matching segment does not necessarily mean there's missing content.\n      //\n      // If the new playlist's timeline is the same as the last seen segment's timeline,\n      // then a discontinuity can be added to identify that there's potentially missing\n      // content. If there's no missing content, the discontinuity should still be rather\n      // harmless. It's possible that if segment durations are accurate enough, that the\n      // existence of a gap can be determined using the presentation times and durations,\n      // but if the segment timing info is off, it may introduce more problems than simply\n      // adding the discontinuity.\n      //\n      // If the new playlist's timeline is different from the last seen segment's timeline,\n      // then a discontinuity can be added to identify that this is the first seen segment\n      // of a new timeline. However, the logic at the start of this function that\n      // determined the disconinuity sequence by timeline index is now off by one (the\n      // discontinuity of the newest timeline hasn't yet fallen off the manifest...since\n      // we added it), so the disconinuity sequence must be decremented.\n      //\n      // A period may also have a duration of zero, so the case of no segments is handled\n      // here even though we don't yet support early available periods.\n\n      if (!oldPlaylist.segments.length && playlist.timeline > oldPlaylist.timeline || oldPlaylist.segments.length && playlist.timeline > oldPlaylist.segments[oldPlaylist.segments.length - 1].timeline) {\n        playlist.discontinuitySequence--;\n      }\n\n      return;\n    } // If the first segment matched with a prior segment on a discontinuity (it's matching\n    // on the first segment of a period), then the discontinuitySequence shouldn't be the\n    // timeline's matching one, but instead should be the one prior, and the first segment\n    // of the new manifest should be marked with a discontinuity.\n    //\n    // The reason for this special case is that discontinuity sequence shows how many\n    // discontinuities have fallen off of the playlist, and discontinuities are marked on\n    // the first segment of a new \"timeline.\" Because of this, while DASH will retain that\n    // Period while the \"timeline\" exists, HLS keeps track of it via the discontinuity\n    // sequence, and that first segment is an indicator, but can be removed before that\n    // timeline is gone.\n\n\n    const oldMatchingSegment = oldPlaylist.segments[oldMatchingSegmentIndex];\n\n    if (oldMatchingSegment.discontinuity && !firstNewSegment.discontinuity) {\n      firstNewSegment.discontinuity = true;\n      playlist.discontinuityStarts.unshift(0);\n      playlist.discontinuitySequence--;\n    }\n\n    updateMediaSequenceForPlaylist({\n      playlist,\n      mediaSequence: oldPlaylist.segments[oldMatchingSegmentIndex].number\n    });\n  });\n};\n/**\n * Given an old parsed manifest object and a new parsed manifest object, updates the\n * sequence and timing values within the new manifest to ensure that it lines up with the\n * old.\n *\n * @param {Array} oldManifest - the old main manifest object\n * @param {Array} newManifest - the new main manifest object\n *\n * @return {Object} the updated new manifest object\n */\n\nconst positionManifestOnTimeline = ({\n  oldManifest,\n  newManifest\n}) => {\n  // Starting from v4.1.2 of the IOP, section 4.4.3.3 states:\n  //\n  // \"MPD@availabilityStartTime and Period@start shall not be changed over MPD updates.\"\n  //\n  // This was added from https://github.com/Dash-Industry-Forum/DASH-IF-IOP/issues/160\n  //\n  // Because of this change, and the difficulty of supporting periods with changing start\n  // times, periods with changing start times are not supported. This makes the logic much\n  // simpler, since periods with the same start time can be considerred the same period\n  // across refreshes.\n  //\n  // To give an example as to the difficulty of handling periods where the start time may\n  // change, if a single period manifest is refreshed with another manifest with a single\n  // period, and both the start and end times are increased, then the only way to determine\n  // if it's a new period or an old one that has changed is to look through the segments of\n  // each playlist and determine the presentation time bounds to find a match. In addition,\n  // if the period start changed to exceed the old period end, then there would be no\n  // match, and it would not be possible to determine whether the refreshed period is a new\n  // one or the old one.\n  const oldPlaylists = oldManifest.playlists.concat(getMediaGroupPlaylists(oldManifest));\n  const newPlaylists = newManifest.playlists.concat(getMediaGroupPlaylists(newManifest)); // Save all seen timelineStarts to the new manifest. Although this potentially means that\n  // there's a \"memory leak\" in that it will never stop growing, in reality, only a couple\n  // of properties are saved for each seen Period. Even long running live streams won't\n  // generate too many Periods, unless the stream is watched for decades. In the future,\n  // this can be optimized by mapping to discontinuity sequence numbers for each timeline,\n  // but it may not become an issue, and the additional info can be useful for debugging.\n\n  newManifest.timelineStarts = getUniqueTimelineStarts([oldManifest.timelineStarts, newManifest.timelineStarts]);\n  updateSequenceNumbers({\n    oldPlaylists,\n    newPlaylists,\n    timelineStarts: newManifest.timelineStarts\n  });\n  return newManifest;\n};\n\nconst generateSidxKey = sidx => sidx && sidx.uri + '-' + byteRangeToString(sidx.byterange);\n\nconst mergeDiscontiguousPlaylists = playlists => {\n  const mergedPlaylists = values(playlists.reduce((acc, playlist) => {\n    // assuming playlist IDs are the same across periods\n    // TODO: handle multiperiod where representation sets are not the same\n    // across periods\n    const name = playlist.attributes.id + (playlist.attributes.lang || '');\n\n    if (!acc[name]) {\n      // First Period\n      acc[name] = playlist;\n      acc[name].attributes.timelineStarts = [];\n    } else {\n      // Subsequent Periods\n      if (playlist.segments) {\n        // first segment of subsequent periods signal a discontinuity\n        if (playlist.segments[0]) {\n          playlist.segments[0].discontinuity = true;\n        }\n\n        acc[name].segments.push(...playlist.segments);\n      } // bubble up contentProtection, this assumes all DRM content\n      // has the same contentProtection\n\n\n      if (playlist.attributes.contentProtection) {\n        acc[name].attributes.contentProtection = playlist.attributes.contentProtection;\n      }\n    }\n\n    acc[name].attributes.timelineStarts.push({\n      // Although they represent the same number, it's important to have both to make it\n      // compatible with HLS potentially having a similar attribute.\n      start: playlist.attributes.periodStart,\n      timeline: playlist.attributes.periodStart\n    });\n    return acc;\n  }, {}));\n  return mergedPlaylists.map(playlist => {\n    playlist.discontinuityStarts = findIndexes(playlist.segments || [], 'discontinuity');\n    return playlist;\n  });\n};\n\nconst addSidxSegmentsToPlaylist = (playlist, sidxMapping) => {\n  const sidxKey = generateSidxKey(playlist.sidx);\n  const sidxMatch = sidxKey && sidxMapping[sidxKey] && sidxMapping[sidxKey].sidx;\n\n  if (sidxMatch) {\n    addSidxSegmentsToPlaylist$1(playlist, sidxMatch, playlist.sidx.resolvedUri);\n  }\n\n  return playlist;\n};\nconst addSidxSegmentsToPlaylists = (playlists, sidxMapping = {}) => {\n  if (!Object.keys(sidxMapping).length) {\n    return playlists;\n  }\n\n  for (const i in playlists) {\n    playlists[i] = addSidxSegmentsToPlaylist(playlists[i], sidxMapping);\n  }\n\n  return playlists;\n};\nconst formatAudioPlaylist = ({\n  attributes,\n  segments,\n  sidx,\n  mediaSequence,\n  discontinuitySequence,\n  discontinuityStarts\n}, isAudioOnly) => {\n  const playlist = {\n    attributes: {\n      NAME: attributes.id,\n      BANDWIDTH: attributes.bandwidth,\n      CODECS: attributes.codecs,\n      ['PROGRAM-ID']: 1\n    },\n    uri: '',\n    endList: attributes.type === 'static',\n    timeline: attributes.periodStart,\n    resolvedUri: '',\n    targetDuration: attributes.duration,\n    discontinuitySequence,\n    discontinuityStarts,\n    timelineStarts: attributes.timelineStarts,\n    mediaSequence,\n    segments\n  };\n\n  if (attributes.contentProtection) {\n    playlist.contentProtection = attributes.contentProtection;\n  }\n\n  if (sidx) {\n    playlist.sidx = sidx;\n  }\n\n  if (isAudioOnly) {\n    playlist.attributes.AUDIO = 'audio';\n    playlist.attributes.SUBTITLES = 'subs';\n  }\n\n  return playlist;\n};\nconst formatVttPlaylist = ({\n  attributes,\n  segments,\n  mediaSequence,\n  discontinuityStarts,\n  discontinuitySequence\n}) => {\n  if (typeof segments === 'undefined') {\n    // vtt tracks may use single file in BaseURL\n    segments = [{\n      uri: attributes.baseUrl,\n      timeline: attributes.periodStart,\n      resolvedUri: attributes.baseUrl || '',\n      duration: attributes.sourceDuration,\n      number: 0\n    }]; // targetDuration should be the same duration as the only segment\n\n    attributes.duration = attributes.sourceDuration;\n  }\n\n  const m3u8Attributes = {\n    NAME: attributes.id,\n    BANDWIDTH: attributes.bandwidth,\n    ['PROGRAM-ID']: 1\n  };\n\n  if (attributes.codecs) {\n    m3u8Attributes.CODECS = attributes.codecs;\n  }\n\n  return {\n    attributes: m3u8Attributes,\n    uri: '',\n    endList: attributes.type === 'static',\n    timeline: attributes.periodStart,\n    resolvedUri: attributes.baseUrl || '',\n    targetDuration: attributes.duration,\n    timelineStarts: attributes.timelineStarts,\n    discontinuityStarts,\n    discontinuitySequence,\n    mediaSequence,\n    segments\n  };\n};\nconst organizeAudioPlaylists = (playlists, sidxMapping = {}, isAudioOnly = false) => {\n  let mainPlaylist;\n  const formattedPlaylists = playlists.reduce((a, playlist) => {\n    const role = playlist.attributes.role && playlist.attributes.role.value || '';\n    const language = playlist.attributes.lang || '';\n    let label = playlist.attributes.label || 'main';\n\n    if (language && !playlist.attributes.label) {\n      const roleLabel = role ? ` (${role})` : '';\n      label = `${playlist.attributes.lang}${roleLabel}`;\n    }\n\n    if (!a[label]) {\n      a[label] = {\n        language,\n        autoselect: true,\n        default: role === 'main',\n        playlists: [],\n        uri: ''\n      };\n    }\n\n    const formatted = addSidxSegmentsToPlaylist(formatAudioPlaylist(playlist, isAudioOnly), sidxMapping);\n    a[label].playlists.push(formatted);\n\n    if (typeof mainPlaylist === 'undefined' && role === 'main') {\n      mainPlaylist = playlist;\n      mainPlaylist.default = true;\n    }\n\n    return a;\n  }, {}); // if no playlists have role \"main\", mark the first as main\n\n  if (!mainPlaylist) {\n    const firstLabel = Object.keys(formattedPlaylists)[0];\n    formattedPlaylists[firstLabel].default = true;\n  }\n\n  return formattedPlaylists;\n};\nconst organizeVttPlaylists = (playlists, sidxMapping = {}) => {\n  return playlists.reduce((a, playlist) => {\n    const label = playlist.attributes.lang || 'text';\n\n    if (!a[label]) {\n      a[label] = {\n        language: label,\n        default: false,\n        autoselect: false,\n        playlists: [],\n        uri: ''\n      };\n    }\n\n    a[label].playlists.push(addSidxSegmentsToPlaylist(formatVttPlaylist(playlist), sidxMapping));\n    return a;\n  }, {});\n};\n\nconst organizeCaptionServices = captionServices => captionServices.reduce((svcObj, svc) => {\n  if (!svc) {\n    return svcObj;\n  }\n\n  svc.forEach(service => {\n    const {\n      channel,\n      language\n    } = service;\n    svcObj[language] = {\n      autoselect: false,\n      default: false,\n      instreamId: channel,\n      language\n    };\n\n    if (service.hasOwnProperty('aspectRatio')) {\n      svcObj[language].aspectRatio = service.aspectRatio;\n    }\n\n    if (service.hasOwnProperty('easyReader')) {\n      svcObj[language].easyReader = service.easyReader;\n    }\n\n    if (service.hasOwnProperty('3D')) {\n      svcObj[language]['3D'] = service['3D'];\n    }\n  });\n  return svcObj;\n}, {});\n\nconst formatVideoPlaylist = ({\n  attributes,\n  segments,\n  sidx,\n  discontinuityStarts\n}) => {\n  const playlist = {\n    attributes: {\n      NAME: attributes.id,\n      AUDIO: 'audio',\n      SUBTITLES: 'subs',\n      RESOLUTION: {\n        width: attributes.width,\n        height: attributes.height\n      },\n      CODECS: attributes.codecs,\n      BANDWIDTH: attributes.bandwidth,\n      ['PROGRAM-ID']: 1\n    },\n    uri: '',\n    endList: attributes.type === 'static',\n    timeline: attributes.periodStart,\n    resolvedUri: '',\n    targetDuration: attributes.duration,\n    discontinuityStarts,\n    timelineStarts: attributes.timelineStarts,\n    segments\n  };\n\n  if (attributes.frameRate) {\n    playlist.attributes['FRAME-RATE'] = attributes.frameRate;\n  }\n\n  if (attributes.contentProtection) {\n    playlist.contentProtection = attributes.contentProtection;\n  }\n\n  if (sidx) {\n    playlist.sidx = sidx;\n  }\n\n  return playlist;\n};\n\nconst videoOnly = ({\n  attributes\n}) => attributes.mimeType === 'video/mp4' || attributes.mimeType === 'video/webm' || attributes.contentType === 'video';\n\nconst audioOnly = ({\n  attributes\n}) => attributes.mimeType === 'audio/mp4' || attributes.mimeType === 'audio/webm' || attributes.contentType === 'audio';\n\nconst vttOnly = ({\n  attributes\n}) => attributes.mimeType === 'text/vtt' || attributes.contentType === 'text';\n/**\n * Contains start and timeline properties denoting a timeline start. For DASH, these will\n * be the same number.\n *\n * @typedef {Object} TimelineStart\n * @property {number} start - the start time of the timeline\n * @property {number} timeline - the timeline number\n */\n\n/**\n * Adds appropriate media and discontinuity sequence values to the segments and playlists.\n *\n * Throughout mpd-parser, the `number` attribute is used in relation to `startNumber`, a\n * DASH specific attribute used in constructing segment URI's from templates. However, from\n * an HLS perspective, the `number` attribute on a segment would be its `mediaSequence`\n * value, which should start at the original media sequence value (or 0) and increment by 1\n * for each segment thereafter. Since DASH's `startNumber` values are independent per\n * period, it doesn't make sense to use it for `number`. Instead, assume everything starts\n * from a 0 mediaSequence value and increment from there.\n *\n * Note that VHS currently doesn't use the `number` property, but it can be helpful for\n * debugging and making sense of the manifest.\n *\n * For live playlists, to account for values increasing in manifests when periods are\n * removed on refreshes, merging logic should be used to update the numbers to their\n * appropriate values (to ensure they're sequential and increasing).\n *\n * @param {Object[]} playlists - the playlists to update\n * @param {TimelineStart[]} timelineStarts - the timeline starts for the manifest\n */\n\n\nconst addMediaSequenceValues = (playlists, timelineStarts) => {\n  // increment all segments sequentially\n  playlists.forEach(playlist => {\n    playlist.mediaSequence = 0;\n    playlist.discontinuitySequence = timelineStarts.findIndex(function ({\n      timeline\n    }) {\n      return timeline === playlist.timeline;\n    });\n\n    if (!playlist.segments) {\n      return;\n    }\n\n    playlist.segments.forEach((segment, index) => {\n      segment.number = index;\n    });\n  });\n};\n/**\n * Given a media group object, flattens all playlists within the media group into a single\n * array.\n *\n * @param {Object} mediaGroupObject - the media group object\n *\n * @return {Object[]}\n *         The media group playlists\n */\n\nconst flattenMediaGroupPlaylists = mediaGroupObject => {\n  if (!mediaGroupObject) {\n    return [];\n  }\n\n  return Object.keys(mediaGroupObject).reduce((acc, label) => {\n    const labelContents = mediaGroupObject[label];\n    return acc.concat(labelContents.playlists);\n  }, []);\n};\nconst toM3u8 = ({\n  dashPlaylists,\n  locations,\n  sidxMapping = {},\n  previousManifest\n}) => {\n  if (!dashPlaylists.length) {\n    return {};\n  } // grab all main manifest attributes\n\n\n  const {\n    sourceDuration: duration,\n    type,\n    suggestedPresentationDelay,\n    minimumUpdatePeriod\n  } = dashPlaylists[0].attributes;\n  const videoPlaylists = mergeDiscontiguousPlaylists(dashPlaylists.filter(videoOnly)).map(formatVideoPlaylist);\n  const audioPlaylists = mergeDiscontiguousPlaylists(dashPlaylists.filter(audioOnly));\n  const vttPlaylists = mergeDiscontiguousPlaylists(dashPlaylists.filter(vttOnly));\n  const captions = dashPlaylists.map(playlist => playlist.attributes.captionServices).filter(Boolean);\n  const manifest = {\n    allowCache: true,\n    discontinuityStarts: [],\n    segments: [],\n    endList: true,\n    mediaGroups: {\n      AUDIO: {},\n      VIDEO: {},\n      ['CLOSED-CAPTIONS']: {},\n      SUBTITLES: {}\n    },\n    uri: '',\n    duration,\n    playlists: addSidxSegmentsToPlaylists(videoPlaylists, sidxMapping)\n  };\n\n  if (minimumUpdatePeriod >= 0) {\n    manifest.minimumUpdatePeriod = minimumUpdatePeriod * 1000;\n  }\n\n  if (locations) {\n    manifest.locations = locations;\n  }\n\n  if (type === 'dynamic') {\n    manifest.suggestedPresentationDelay = suggestedPresentationDelay;\n  }\n\n  const isAudioOnly = manifest.playlists.length === 0;\n  const organizedAudioGroup = audioPlaylists.length ? organizeAudioPlaylists(audioPlaylists, sidxMapping, isAudioOnly) : null;\n  const organizedVttGroup = vttPlaylists.length ? organizeVttPlaylists(vttPlaylists, sidxMapping) : null;\n  const formattedPlaylists = videoPlaylists.concat(flattenMediaGroupPlaylists(organizedAudioGroup), flattenMediaGroupPlaylists(organizedVttGroup));\n  const playlistTimelineStarts = formattedPlaylists.map(({\n    timelineStarts\n  }) => timelineStarts);\n  manifest.timelineStarts = getUniqueTimelineStarts(playlistTimelineStarts);\n  addMediaSequenceValues(formattedPlaylists, manifest.timelineStarts);\n\n  if (organizedAudioGroup) {\n    manifest.mediaGroups.AUDIO.audio = organizedAudioGroup;\n  }\n\n  if (organizedVttGroup) {\n    manifest.mediaGroups.SUBTITLES.subs = organizedVttGroup;\n  }\n\n  if (captions.length) {\n    manifest.mediaGroups['CLOSED-CAPTIONS'].cc = organizeCaptionServices(captions);\n  }\n\n  if (previousManifest) {\n    return positionManifestOnTimeline({\n      oldManifest: previousManifest,\n      newManifest: manifest\n    });\n  }\n\n  return manifest;\n};\n\n/**\n * Calculates the R (repetition) value for a live stream (for the final segment\n * in a manifest where the r value is negative 1)\n *\n * @param {Object} attributes\n *        Object containing all inherited attributes from parent elements with attribute\n *        names as keys\n * @param {number} time\n *        current time (typically the total time up until the final segment)\n * @param {number} duration\n *        duration property for the given <S />\n *\n * @return {number}\n *        R value to reach the end of the given period\n */\nconst getLiveRValue = (attributes, time, duration) => {\n  const {\n    NOW,\n    clientOffset,\n    availabilityStartTime,\n    timescale = 1,\n    periodStart = 0,\n    minimumUpdatePeriod = 0\n  } = attributes;\n  const now = (NOW + clientOffset) / 1000;\n  const periodStartWC = availabilityStartTime + periodStart;\n  const periodEndWC = now + minimumUpdatePeriod;\n  const periodDuration = periodEndWC - periodStartWC;\n  return Math.ceil((periodDuration * timescale - time) / duration);\n};\n/**\n * Uses information provided by SegmentTemplate.SegmentTimeline to determine segment\n * timing and duration\n *\n * @param {Object} attributes\n *        Object containing all inherited attributes from parent elements with attribute\n *        names as keys\n * @param {Object[]} segmentTimeline\n *        List of objects representing the attributes of each S element contained within\n *\n * @return {{number: number, duration: number, time: number, timeline: number}[]}\n *         List of Objects with segment timing and duration info\n */\n\n\nconst parseByTimeline = (attributes, segmentTimeline) => {\n  const {\n    type,\n    minimumUpdatePeriod = 0,\n    media = '',\n    sourceDuration,\n    timescale = 1,\n    startNumber = 1,\n    periodStart: timeline\n  } = attributes;\n  const segments = [];\n  let time = -1;\n\n  for (let sIndex = 0; sIndex < segmentTimeline.length; sIndex++) {\n    const S = segmentTimeline[sIndex];\n    const duration = S.d;\n    const repeat = S.r || 0;\n    const segmentTime = S.t || 0;\n\n    if (time < 0) {\n      // first segment\n      time = segmentTime;\n    }\n\n    if (segmentTime && segmentTime > time) {\n      // discontinuity\n      // TODO: How to handle this type of discontinuity\n      // timeline++ here would treat it like HLS discontuity and content would\n      // get appended without gap\n      // E.G.\n      //  <S t=\"0\" d=\"1\" />\n      //  <S d=\"1\" />\n      //  <S d=\"1\" />\n      //  <S t=\"5\" d=\"1\" />\n      // would have $Time$ values of [0, 1, 2, 5]\n      // should this be appened at time positions [0, 1, 2, 3],(#EXT-X-DISCONTINUITY)\n      // or [0, 1, 2, gap, gap, 5]? (#EXT-X-GAP)\n      // does the value of sourceDuration consider this when calculating arbitrary\n      // negative @r repeat value?\n      // E.G. Same elements as above with this added at the end\n      //  <S d=\"1\" r=\"-1\" />\n      //  with a sourceDuration of 10\n      // Would the 2 gaps be included in the time duration calculations resulting in\n      // 8 segments with $Time$ values of [0, 1, 2, 5, 6, 7, 8, 9] or 10 segments\n      // with $Time$ values of [0, 1, 2, 5, 6, 7, 8, 9, 10, 11] ?\n      time = segmentTime;\n    }\n\n    let count;\n\n    if (repeat < 0) {\n      const nextS = sIndex + 1;\n\n      if (nextS === segmentTimeline.length) {\n        // last segment\n        if (type === 'dynamic' && minimumUpdatePeriod > 0 && media.indexOf('$Number$') > 0) {\n          count = getLiveRValue(attributes, time, duration);\n        } else {\n          // TODO: This may be incorrect depending on conclusion of TODO above\n          count = (sourceDuration * timescale - time) / duration;\n        }\n      } else {\n        count = (segmentTimeline[nextS].t - time) / duration;\n      }\n    } else {\n      count = repeat + 1;\n    }\n\n    const end = startNumber + segments.length + count;\n    let number = startNumber + segments.length;\n\n    while (number < end) {\n      segments.push({\n        number,\n        duration: duration / timescale,\n        time,\n        timeline\n      });\n      time += duration;\n      number++;\n    }\n  }\n\n  return segments;\n};\n\nconst identifierPattern = /\\$([A-z]*)(?:(%0)([0-9]+)d)?\\$/g;\n/**\n * Replaces template identifiers with corresponding values. To be used as the callback\n * for String.prototype.replace\n *\n * @name replaceCallback\n * @function\n * @param {string} match\n *        Entire match of identifier\n * @param {string} identifier\n *        Name of matched identifier\n * @param {string} format\n *        Format tag string. Its presence indicates that padding is expected\n * @param {string} width\n *        Desired length of the replaced value. Values less than this width shall be left\n *        zero padded\n * @return {string}\n *         Replacement for the matched identifier\n */\n\n/**\n * Returns a function to be used as a callback for String.prototype.replace to replace\n * template identifiers\n *\n * @param {Obect} values\n *        Object containing values that shall be used to replace known identifiers\n * @param {number} values.RepresentationID\n *        Value of the Representation@id attribute\n * @param {number} values.Number\n *        Number of the corresponding segment\n * @param {number} values.Bandwidth\n *        Value of the Representation@bandwidth attribute.\n * @param {number} values.Time\n *        Timestamp value of the corresponding segment\n * @return {replaceCallback}\n *         Callback to be used with String.prototype.replace to replace identifiers\n */\n\nconst identifierReplacement = values => (match, identifier, format, width) => {\n  if (match === '$$') {\n    // escape sequence\n    return '$';\n  }\n\n  if (typeof values[identifier] === 'undefined') {\n    return match;\n  }\n\n  const value = '' + values[identifier];\n\n  if (identifier === 'RepresentationID') {\n    // Format tag shall not be present with RepresentationID\n    return value;\n  }\n\n  if (!format) {\n    width = 1;\n  } else {\n    width = parseInt(width, 10);\n  }\n\n  if (value.length >= width) {\n    return value;\n  }\n\n  return `${new Array(width - value.length + 1).join('0')}${value}`;\n};\n/**\n * Constructs a segment url from a template string\n *\n * @param {string} url\n *        Template string to construct url from\n * @param {Obect} values\n *        Object containing values that shall be used to replace known identifiers\n * @param {number} values.RepresentationID\n *        Value of the Representation@id attribute\n * @param {number} values.Number\n *        Number of the corresponding segment\n * @param {number} values.Bandwidth\n *        Value of the Representation@bandwidth attribute.\n * @param {number} values.Time\n *        Timestamp value of the corresponding segment\n * @return {string}\n *         Segment url with identifiers replaced\n */\n\nconst constructTemplateUrl = (url, values) => url.replace(identifierPattern, identifierReplacement(values));\n/**\n * Generates a list of objects containing timing and duration information about each\n * segment needed to generate segment uris and the complete segment object\n *\n * @param {Object} attributes\n *        Object containing all inherited attributes from parent elements with attribute\n *        names as keys\n * @param {Object[]|undefined} segmentTimeline\n *        List of objects representing the attributes of each S element contained within\n *        the SegmentTimeline element\n * @return {{number: number, duration: number, time: number, timeline: number}[]}\n *         List of Objects with segment timing and duration info\n */\n\nconst parseTemplateInfo = (attributes, segmentTimeline) => {\n  if (!attributes.duration && !segmentTimeline) {\n    // if neither @duration or SegmentTimeline are present, then there shall be exactly\n    // one media segment\n    return [{\n      number: attributes.startNumber || 1,\n      duration: attributes.sourceDuration,\n      time: 0,\n      timeline: attributes.periodStart\n    }];\n  }\n\n  if (attributes.duration) {\n    return parseByDuration(attributes);\n  }\n\n  return parseByTimeline(attributes, segmentTimeline);\n};\n/**\n * Generates a list of segments using information provided by the SegmentTemplate element\n *\n * @param {Object} attributes\n *        Object containing all inherited attributes from parent elements with attribute\n *        names as keys\n * @param {Object[]|undefined} segmentTimeline\n *        List of objects representing the attributes of each S element contained within\n *        the SegmentTimeline element\n * @return {Object[]}\n *         List of segment objects\n */\n\nconst segmentsFromTemplate = (attributes, segmentTimeline) => {\n  const templateValues = {\n    RepresentationID: attributes.id,\n    Bandwidth: attributes.bandwidth || 0\n  };\n  const {\n    initialization = {\n      sourceURL: '',\n      range: ''\n    }\n  } = attributes;\n  const mapSegment = urlTypeToSegment({\n    baseUrl: attributes.baseUrl,\n    source: constructTemplateUrl(initialization.sourceURL, templateValues),\n    range: initialization.range\n  });\n  const segments = parseTemplateInfo(attributes, segmentTimeline);\n  return segments.map(segment => {\n    templateValues.Number = segment.number;\n    templateValues.Time = segment.time;\n    const uri = constructTemplateUrl(attributes.media || '', templateValues); // See DASH spec section 5.3.9.2.2\n    // - if timescale isn't present on any level, default to 1.\n\n    const timescale = attributes.timescale || 1; // - if presentationTimeOffset isn't present on any level, default to 0\n\n    const presentationTimeOffset = attributes.presentationTimeOffset || 0;\n    const presentationTime = // Even if the @t attribute is not specified for the segment, segment.time is\n    // calculated in mpd-parser prior to this, so it's assumed to be available.\n    attributes.periodStart + (segment.time - presentationTimeOffset) / timescale;\n    const map = {\n      uri,\n      timeline: segment.timeline,\n      duration: segment.duration,\n      resolvedUri: resolveUrl(attributes.baseUrl || '', uri),\n      map: mapSegment,\n      number: segment.number,\n      presentationTime\n    };\n    return map;\n  });\n};\n\n/**\n * Converts a <SegmentUrl> (of type URLType from the DASH spec 5.3.9.2 Table 14)\n * to an object that matches the output of a segment in videojs/mpd-parser\n *\n * @param {Object} attributes\n *   Object containing all inherited attributes from parent elements with attribute\n *   names as keys\n * @param {Object} segmentUrl\n *   <SegmentURL> node to translate into a segment object\n * @return {Object} translated segment object\n */\n\nconst SegmentURLToSegmentObject = (attributes, segmentUrl) => {\n  const {\n    baseUrl,\n    initialization = {}\n  } = attributes;\n  const initSegment = urlTypeToSegment({\n    baseUrl,\n    source: initialization.sourceURL,\n    range: initialization.range\n  });\n  const segment = urlTypeToSegment({\n    baseUrl,\n    source: segmentUrl.media,\n    range: segmentUrl.mediaRange\n  });\n  segment.map = initSegment;\n  return segment;\n};\n/**\n * Generates a list of segments using information provided by the SegmentList element\n * SegmentList (DASH SPEC Section 5.3.9.3.2) contains a set of <SegmentURL> nodes.  Each\n * node should be translated into segment.\n *\n * @param {Object} attributes\n *   Object containing all inherited attributes from parent elements with attribute\n *   names as keys\n * @param {Object[]|undefined} segmentTimeline\n *        List of objects representing the attributes of each S element contained within\n *        the SegmentTimeline element\n * @return {Object.<Array>} list of segments\n */\n\n\nconst segmentsFromList = (attributes, segmentTimeline) => {\n  const {\n    duration,\n    segmentUrls = [],\n    periodStart\n  } = attributes; // Per spec (5.3.9.2.1) no way to determine segment duration OR\n  // if both SegmentTimeline and @duration are defined, it is outside of spec.\n\n  if (!duration && !segmentTimeline || duration && segmentTimeline) {\n    throw new Error(errors.SEGMENT_TIME_UNSPECIFIED);\n  }\n\n  const segmentUrlMap = segmentUrls.map(segmentUrlObject => SegmentURLToSegmentObject(attributes, segmentUrlObject));\n  let segmentTimeInfo;\n\n  if (duration) {\n    segmentTimeInfo = parseByDuration(attributes);\n  }\n\n  if (segmentTimeline) {\n    segmentTimeInfo = parseByTimeline(attributes, segmentTimeline);\n  }\n\n  const segments = segmentTimeInfo.map((segmentTime, index) => {\n    if (segmentUrlMap[index]) {\n      const segment = segmentUrlMap[index]; // See DASH spec section 5.3.9.2.2\n      // - if timescale isn't present on any level, default to 1.\n\n      const timescale = attributes.timescale || 1; // - if presentationTimeOffset isn't present on any level, default to 0\n\n      const presentationTimeOffset = attributes.presentationTimeOffset || 0;\n      segment.timeline = segmentTime.timeline;\n      segment.duration = segmentTime.duration;\n      segment.number = segmentTime.number;\n      segment.presentationTime = periodStart + (segmentTime.time - presentationTimeOffset) / timescale;\n      return segment;\n    } // Since we're mapping we should get rid of any blank segments (in case\n    // the given SegmentTimeline is handling for more elements than we have\n    // SegmentURLs for).\n\n  }).filter(segment => segment);\n  return segments;\n};\n\nconst generateSegments = ({\n  attributes,\n  segmentInfo\n}) => {\n  let segmentAttributes;\n  let segmentsFn;\n\n  if (segmentInfo.template) {\n    segmentsFn = segmentsFromTemplate;\n    segmentAttributes = merge(attributes, segmentInfo.template);\n  } else if (segmentInfo.base) {\n    segmentsFn = segmentsFromBase;\n    segmentAttributes = merge(attributes, segmentInfo.base);\n  } else if (segmentInfo.list) {\n    segmentsFn = segmentsFromList;\n    segmentAttributes = merge(attributes, segmentInfo.list);\n  }\n\n  const segmentsInfo = {\n    attributes\n  };\n\n  if (!segmentsFn) {\n    return segmentsInfo;\n  }\n\n  const segments = segmentsFn(segmentAttributes, segmentInfo.segmentTimeline); // The @duration attribute will be used to determin the playlist's targetDuration which\n  // must be in seconds. Since we've generated the segment list, we no longer need\n  // @duration to be in @timescale units, so we can convert it here.\n\n  if (segmentAttributes.duration) {\n    const {\n      duration,\n      timescale = 1\n    } = segmentAttributes;\n    segmentAttributes.duration = duration / timescale;\n  } else if (segments.length) {\n    // if there is no @duration attribute, use the largest segment duration as\n    // as target duration\n    segmentAttributes.duration = segments.reduce((max, segment) => {\n      return Math.max(max, Math.ceil(segment.duration));\n    }, 0);\n  } else {\n    segmentAttributes.duration = 0;\n  }\n\n  segmentsInfo.attributes = segmentAttributes;\n  segmentsInfo.segments = segments; // This is a sidx box without actual segment information\n\n  if (segmentInfo.base && segmentAttributes.indexRange) {\n    segmentsInfo.sidx = segments[0];\n    segmentsInfo.segments = [];\n  }\n\n  return segmentsInfo;\n};\nconst toPlaylists = representations => representations.map(generateSegments);\n\nconst findChildren = (element, name) => from(element.childNodes).filter(({\n  tagName\n}) => tagName === name);\nconst getContent = element => element.textContent.trim();\n\n/**\n * Converts the provided string that may contain a division operation to a number.\n *\n * @param {string} value - the provided string value\n *\n * @return {number} the parsed string value\n */\nconst parseDivisionValue = value => {\n  return parseFloat(value.split('/').reduce((prev, current) => prev / current));\n};\n\nconst parseDuration = str => {\n  const SECONDS_IN_YEAR = 365 * 24 * 60 * 60;\n  const SECONDS_IN_MONTH = 30 * 24 * 60 * 60;\n  const SECONDS_IN_DAY = 24 * 60 * 60;\n  const SECONDS_IN_HOUR = 60 * 60;\n  const SECONDS_IN_MIN = 60; // P10Y10M10DT10H10M10.1S\n\n  const durationRegex = /P(?:(\\d*)Y)?(?:(\\d*)M)?(?:(\\d*)D)?(?:T(?:(\\d*)H)?(?:(\\d*)M)?(?:([\\d.]*)S)?)?/;\n  const match = durationRegex.exec(str);\n\n  if (!match) {\n    return 0;\n  }\n\n  const [year, month, day, hour, minute, second] = match.slice(1);\n  return parseFloat(year || 0) * SECONDS_IN_YEAR + parseFloat(month || 0) * SECONDS_IN_MONTH + parseFloat(day || 0) * SECONDS_IN_DAY + parseFloat(hour || 0) * SECONDS_IN_HOUR + parseFloat(minute || 0) * SECONDS_IN_MIN + parseFloat(second || 0);\n};\nconst parseDate = str => {\n  // Date format without timezone according to ISO 8601\n  // YYY-MM-DDThh:mm:ss.ssssss\n  const dateRegex = /^\\d+-\\d+-\\d+T\\d+:\\d+:\\d+(\\.\\d+)?$/; // If the date string does not specifiy a timezone, we must specifiy UTC. This is\n  // expressed by ending with 'Z'\n\n  if (dateRegex.test(str)) {\n    str += 'Z';\n  }\n\n  return Date.parse(str);\n};\n\nconst parsers = {\n  /**\n   * Specifies the duration of the entire Media Presentation. Format is a duration string\n   * as specified in ISO 8601\n   *\n   * @param {string} value\n   *        value of attribute as a string\n   * @return {number}\n   *         The duration in seconds\n   */\n  mediaPresentationDuration(value) {\n    return parseDuration(value);\n  },\n\n  /**\n   * Specifies the Segment availability start time for all Segments referred to in this\n   * MPD. For a dynamic manifest, it specifies the anchor for the earliest availability\n   * time. Format is a date string as specified in ISO 8601\n   *\n   * @param {string} value\n   *        value of attribute as a string\n   * @return {number}\n   *         The date as seconds from unix epoch\n   */\n  availabilityStartTime(value) {\n    return parseDate(value) / 1000;\n  },\n\n  /**\n   * Specifies the smallest period between potential changes to the MPD. Format is a\n   * duration string as specified in ISO 8601\n   *\n   * @param {string} value\n   *        value of attribute as a string\n   * @return {number}\n   *         The duration in seconds\n   */\n  minimumUpdatePeriod(value) {\n    return parseDuration(value);\n  },\n\n  /**\n   * Specifies the suggested presentation delay. Format is a\n   * duration string as specified in ISO 8601\n   *\n   * @param {string} value\n   *        value of attribute as a string\n   * @return {number}\n   *         The duration in seconds\n   */\n  suggestedPresentationDelay(value) {\n    return parseDuration(value);\n  },\n\n  /**\n   * specifices the type of mpd. Can be either \"static\" or \"dynamic\"\n   *\n   * @param {string} value\n   *        value of attribute as a string\n   *\n   * @return {string}\n   *         The type as a string\n   */\n  type(value) {\n    return value;\n  },\n\n  /**\n   * Specifies the duration of the smallest time shifting buffer for any Representation\n   * in the MPD. Format is a duration string as specified in ISO 8601\n   *\n   * @param {string} value\n   *        value of attribute as a string\n   * @return {number}\n   *         The duration in seconds\n   */\n  timeShiftBufferDepth(value) {\n    return parseDuration(value);\n  },\n\n  /**\n   * Specifies the PeriodStart time of the Period relative to the availabilityStarttime.\n   * Format is a duration string as specified in ISO 8601\n   *\n   * @param {string} value\n   *        value of attribute as a string\n   * @return {number}\n   *         The duration in seconds\n   */\n  start(value) {\n    return parseDuration(value);\n  },\n\n  /**\n   * Specifies the width of the visual presentation\n   *\n   * @param {string} value\n   *        value of attribute as a string\n   * @return {number}\n   *         The parsed width\n   */\n  width(value) {\n    return parseInt(value, 10);\n  },\n\n  /**\n   * Specifies the height of the visual presentation\n   *\n   * @param {string} value\n   *        value of attribute as a string\n   * @return {number}\n   *         The parsed height\n   */\n  height(value) {\n    return parseInt(value, 10);\n  },\n\n  /**\n   * Specifies the bitrate of the representation\n   *\n   * @param {string} value\n   *        value of attribute as a string\n   * @return {number}\n   *         The parsed bandwidth\n   */\n  bandwidth(value) {\n    return parseInt(value, 10);\n  },\n\n  /**\n   * Specifies the frame rate of the representation\n   *\n   * @param {string} value\n   *        value of attribute as a string\n   * @return {number}\n   *         The parsed frame rate\n   */\n  frameRate(value) {\n    return parseDivisionValue(value);\n  },\n\n  /**\n   * Specifies the number of the first Media Segment in this Representation in the Period\n   *\n   * @param {string} value\n   *        value of attribute as a string\n   * @return {number}\n   *         The parsed number\n   */\n  startNumber(value) {\n    return parseInt(value, 10);\n  },\n\n  /**\n   * Specifies the timescale in units per seconds\n   *\n   * @param {string} value\n   *        value of attribute as a string\n   * @return {number}\n   *         The parsed timescale\n   */\n  timescale(value) {\n    return parseInt(value, 10);\n  },\n\n  /**\n   * Specifies the presentationTimeOffset.\n   *\n   * @param {string} value\n   *        value of the attribute as a string\n   *\n   * @return {number}\n   *         The parsed presentationTimeOffset\n   */\n  presentationTimeOffset(value) {\n    return parseInt(value, 10);\n  },\n\n  /**\n   * Specifies the constant approximate Segment duration\n   * NOTE: The <Period> element also contains an @duration attribute. This duration\n   *       specifies the duration of the Period. This attribute is currently not\n   *       supported by the rest of the parser, however we still check for it to prevent\n   *       errors.\n   *\n   * @param {string} value\n   *        value of attribute as a string\n   * @return {number}\n   *         The parsed duration\n   */\n  duration(value) {\n    const parsedValue = parseInt(value, 10);\n\n    if (isNaN(parsedValue)) {\n      return parseDuration(value);\n    }\n\n    return parsedValue;\n  },\n\n  /**\n   * Specifies the Segment duration, in units of the value of the @timescale.\n   *\n   * @param {string} value\n   *        value of attribute as a string\n   * @return {number}\n   *         The parsed duration\n   */\n  d(value) {\n    return parseInt(value, 10);\n  },\n\n  /**\n   * Specifies the MPD start time, in @timescale units, the first Segment in the series\n   * starts relative to the beginning of the Period\n   *\n   * @param {string} value\n   *        value of attribute as a string\n   * @return {number}\n   *         The parsed time\n   */\n  t(value) {\n    return parseInt(value, 10);\n  },\n\n  /**\n   * Specifies the repeat count of the number of following contiguous Segments with the\n   * same duration expressed by the value of @d\n   *\n   * @param {string} value\n   *        value of attribute as a string\n   * @return {number}\n   *         The parsed number\n   */\n  r(value) {\n    return parseInt(value, 10);\n  },\n\n  /**\n   * Default parser for all other attributes. Acts as a no-op and just returns the value\n   * as a string\n   *\n   * @param {string} value\n   *        value of attribute as a string\n   * @return {string}\n   *         Unparsed value\n   */\n  DEFAULT(value) {\n    return value;\n  }\n\n};\n/**\n * Gets all the attributes and values of the provided node, parses attributes with known\n * types, and returns an object with attribute names mapped to values.\n *\n * @param {Node} el\n *        The node to parse attributes from\n * @return {Object}\n *         Object with all attributes of el parsed\n */\n\nconst parseAttributes = el => {\n  if (!(el && el.attributes)) {\n    return {};\n  }\n\n  return from(el.attributes).reduce((a, e) => {\n    const parseFn = parsers[e.name] || parsers.DEFAULT;\n    a[e.name] = parseFn(e.value);\n    return a;\n  }, {});\n};\n\nconst keySystemsMap = {\n  'urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b': 'org.w3.clearkey',\n  'urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed': 'com.widevine.alpha',\n  'urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95': 'com.microsoft.playready',\n  'urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb': 'com.adobe.primetime'\n};\n/**\n * Builds a list of urls that is the product of the reference urls and BaseURL values\n *\n * @param {string[]} referenceUrls\n *        List of reference urls to resolve to\n * @param {Node[]} baseUrlElements\n *        List of BaseURL nodes from the mpd\n * @return {string[]}\n *         List of resolved urls\n */\n\nconst buildBaseUrls = (referenceUrls, baseUrlElements) => {\n  if (!baseUrlElements.length) {\n    return referenceUrls;\n  }\n\n  return flatten(referenceUrls.map(function (reference) {\n    return baseUrlElements.map(function (baseUrlElement) {\n      return resolveUrl(reference, getContent(baseUrlElement));\n    });\n  }));\n};\n/**\n * Contains all Segment information for its containing AdaptationSet\n *\n * @typedef {Object} SegmentInformation\n * @property {Object|undefined} template\n *           Contains the attributes for the SegmentTemplate node\n * @property {Object[]|undefined} segmentTimeline\n *           Contains a list of atrributes for each S node within the SegmentTimeline node\n * @property {Object|undefined} list\n *           Contains the attributes for the SegmentList node\n * @property {Object|undefined} base\n *           Contains the attributes for the SegmentBase node\n */\n\n/**\n * Returns all available Segment information contained within the AdaptationSet node\n *\n * @param {Node} adaptationSet\n *        The AdaptationSet node to get Segment information from\n * @return {SegmentInformation}\n *         The Segment information contained within the provided AdaptationSet\n */\n\nconst getSegmentInformation = adaptationSet => {\n  const segmentTemplate = findChildren(adaptationSet, 'SegmentTemplate')[0];\n  const segmentList = findChildren(adaptationSet, 'SegmentList')[0];\n  const segmentUrls = segmentList && findChildren(segmentList, 'SegmentURL').map(s => merge({\n    tag: 'SegmentURL'\n  }, parseAttributes(s)));\n  const segmentBase = findChildren(adaptationSet, 'SegmentBase')[0];\n  const segmentTimelineParentNode = segmentList || segmentTemplate;\n  const segmentTimeline = segmentTimelineParentNode && findChildren(segmentTimelineParentNode, 'SegmentTimeline')[0];\n  const segmentInitializationParentNode = segmentList || segmentBase || segmentTemplate;\n  const segmentInitialization = segmentInitializationParentNode && findChildren(segmentInitializationParentNode, 'Initialization')[0]; // SegmentTemplate is handled slightly differently, since it can have both\n  // @initialization and an <Initialization> node.  @initialization can be templated,\n  // while the node can have a url and range specified.  If the <SegmentTemplate> has\n  // both @initialization and an <Initialization> subelement we opt to override with\n  // the node, as this interaction is not defined in the spec.\n\n  const template = segmentTemplate && parseAttributes(segmentTemplate);\n\n  if (template && segmentInitialization) {\n    template.initialization = segmentInitialization && parseAttributes(segmentInitialization);\n  } else if (template && template.initialization) {\n    // If it is @initialization we convert it to an object since this is the format that\n    // later functions will rely on for the initialization segment.  This is only valid\n    // for <SegmentTemplate>\n    template.initialization = {\n      sourceURL: template.initialization\n    };\n  }\n\n  const segmentInfo = {\n    template,\n    segmentTimeline: segmentTimeline && findChildren(segmentTimeline, 'S').map(s => parseAttributes(s)),\n    list: segmentList && merge(parseAttributes(segmentList), {\n      segmentUrls,\n      initialization: parseAttributes(segmentInitialization)\n    }),\n    base: segmentBase && merge(parseAttributes(segmentBase), {\n      initialization: parseAttributes(segmentInitialization)\n    })\n  };\n  Object.keys(segmentInfo).forEach(key => {\n    if (!segmentInfo[key]) {\n      delete segmentInfo[key];\n    }\n  });\n  return segmentInfo;\n};\n/**\n * Contains Segment information and attributes needed to construct a Playlist object\n * from a Representation\n *\n * @typedef {Object} RepresentationInformation\n * @property {SegmentInformation} segmentInfo\n *           Segment information for this Representation\n * @property {Object} attributes\n *           Inherited attributes for this Representation\n */\n\n/**\n * Maps a Representation node to an object containing Segment information and attributes\n *\n * @name inheritBaseUrlsCallback\n * @function\n * @param {Node} representation\n *        Representation node from the mpd\n * @return {RepresentationInformation}\n *         Representation information needed to construct a Playlist object\n */\n\n/**\n * Returns a callback for Array.prototype.map for mapping Representation nodes to\n * Segment information and attributes using inherited BaseURL nodes.\n *\n * @param {Object} adaptationSetAttributes\n *        Contains attributes inherited by the AdaptationSet\n * @param {string[]} adaptationSetBaseUrls\n *        Contains list of resolved base urls inherited by the AdaptationSet\n * @param {SegmentInformation} adaptationSetSegmentInfo\n *        Contains Segment information for the AdaptationSet\n * @return {inheritBaseUrlsCallback}\n *         Callback map function\n */\n\nconst inheritBaseUrls = (adaptationSetAttributes, adaptationSetBaseUrls, adaptationSetSegmentInfo) => representation => {\n  const repBaseUrlElements = findChildren(representation, 'BaseURL');\n  const repBaseUrls = buildBaseUrls(adaptationSetBaseUrls, repBaseUrlElements);\n  const attributes = merge(adaptationSetAttributes, parseAttributes(representation));\n  const representationSegmentInfo = getSegmentInformation(representation);\n  return repBaseUrls.map(baseUrl => {\n    return {\n      segmentInfo: merge(adaptationSetSegmentInfo, representationSegmentInfo),\n      attributes: merge(attributes, {\n        baseUrl\n      })\n    };\n  });\n};\n/**\n * Tranforms a series of content protection nodes to\n * an object containing pssh data by key system\n *\n * @param {Node[]} contentProtectionNodes\n *        Content protection nodes\n * @return {Object}\n *        Object containing pssh data by key system\n */\n\nconst generateKeySystemInformation = contentProtectionNodes => {\n  return contentProtectionNodes.reduce((acc, node) => {\n    const attributes = parseAttributes(node); // Although it could be argued that according to the UUID RFC spec the UUID string (a-f chars) should be generated\n    // as a lowercase string it also mentions it should be treated as case-insensitive on input. Since the key system\n    // UUIDs in the keySystemsMap are hardcoded as lowercase in the codebase there isn't any reason not to do\n    // .toLowerCase() on the input UUID string from the manifest (at least I could not think of one).\n\n    if (attributes.schemeIdUri) {\n      attributes.schemeIdUri = attributes.schemeIdUri.toLowerCase();\n    }\n\n    const keySystem = keySystemsMap[attributes.schemeIdUri];\n\n    if (keySystem) {\n      acc[keySystem] = {\n        attributes\n      };\n      const psshNode = findChildren(node, 'cenc:pssh')[0];\n\n      if (psshNode) {\n        const pssh = getContent(psshNode);\n        acc[keySystem].pssh = pssh && decodeB64ToUint8Array(pssh);\n      }\n    }\n\n    return acc;\n  }, {});\n}; // defined in ANSI_SCTE 214-1 2016\n\n\nconst parseCaptionServiceMetadata = service => {\n  // 608 captions\n  if (service.schemeIdUri === 'urn:scte:dash:cc:cea-608:2015') {\n    const values = typeof service.value !== 'string' ? [] : service.value.split(';');\n    return values.map(value => {\n      let channel;\n      let language; // default language to value\n\n      language = value;\n\n      if (/^CC\\d=/.test(value)) {\n        [channel, language] = value.split('=');\n      } else if (/^CC\\d$/.test(value)) {\n        channel = value;\n      }\n\n      return {\n        channel,\n        language\n      };\n    });\n  } else if (service.schemeIdUri === 'urn:scte:dash:cc:cea-708:2015') {\n    const values = typeof service.value !== 'string' ? [] : service.value.split(';');\n    return values.map(value => {\n      const flags = {\n        // service or channel number 1-63\n        'channel': undefined,\n        // language is a 3ALPHA per ISO 639.2/B\n        // field is required\n        'language': undefined,\n        // BIT 1/0 or ?\n        // default value is 1, meaning 16:9 aspect ratio, 0 is 4:3, ? is unknown\n        'aspectRatio': 1,\n        // BIT 1/0\n        // easy reader flag indicated the text is tailed to the needs of beginning readers\n        // default 0, or off\n        'easyReader': 0,\n        // BIT 1/0\n        // If 3d metadata is present (CEA-708.1) then 1\n        // default 0\n        '3D': 0\n      };\n\n      if (/=/.test(value)) {\n        const [channel, opts = ''] = value.split('=');\n        flags.channel = channel;\n        flags.language = value;\n        opts.split(',').forEach(opt => {\n          const [name, val] = opt.split(':');\n\n          if (name === 'lang') {\n            flags.language = val; // er for easyReadery\n          } else if (name === 'er') {\n            flags.easyReader = Number(val); // war for wide aspect ratio\n          } else if (name === 'war') {\n            flags.aspectRatio = Number(val);\n          } else if (name === '3D') {\n            flags['3D'] = Number(val);\n          }\n        });\n      } else {\n        flags.language = value;\n      }\n\n      if (flags.channel) {\n        flags.channel = 'SERVICE' + flags.channel;\n      }\n\n      return flags;\n    });\n  }\n};\n/**\n * Maps an AdaptationSet node to a list of Representation information objects\n *\n * @name toRepresentationsCallback\n * @function\n * @param {Node} adaptationSet\n *        AdaptationSet node from the mpd\n * @return {RepresentationInformation[]}\n *         List of objects containing Representaion information\n */\n\n/**\n * Returns a callback for Array.prototype.map for mapping AdaptationSet nodes to a list of\n * Representation information objects\n *\n * @param {Object} periodAttributes\n *        Contains attributes inherited by the Period\n * @param {string[]} periodBaseUrls\n *        Contains list of resolved base urls inherited by the Period\n * @param {string[]} periodSegmentInfo\n *        Contains Segment Information at the period level\n * @return {toRepresentationsCallback}\n *         Callback map function\n */\n\nconst toRepresentations = (periodAttributes, periodBaseUrls, periodSegmentInfo) => adaptationSet => {\n  const adaptationSetAttributes = parseAttributes(adaptationSet);\n  const adaptationSetBaseUrls = buildBaseUrls(periodBaseUrls, findChildren(adaptationSet, 'BaseURL'));\n  const role = findChildren(adaptationSet, 'Role')[0];\n  const roleAttributes = {\n    role: parseAttributes(role)\n  };\n  let attrs = merge(periodAttributes, adaptationSetAttributes, roleAttributes);\n  const accessibility = findChildren(adaptationSet, 'Accessibility')[0];\n  const captionServices = parseCaptionServiceMetadata(parseAttributes(accessibility));\n\n  if (captionServices) {\n    attrs = merge(attrs, {\n      captionServices\n    });\n  }\n\n  const label = findChildren(adaptationSet, 'Label')[0];\n\n  if (label && label.childNodes.length) {\n    const labelVal = label.childNodes[0].nodeValue.trim();\n    attrs = merge(attrs, {\n      label: labelVal\n    });\n  }\n\n  const contentProtection = generateKeySystemInformation(findChildren(adaptationSet, 'ContentProtection'));\n\n  if (Object.keys(contentProtection).length) {\n    attrs = merge(attrs, {\n      contentProtection\n    });\n  }\n\n  const segmentInfo = getSegmentInformation(adaptationSet);\n  const representations = findChildren(adaptationSet, 'Representation');\n  const adaptationSetSegmentInfo = merge(periodSegmentInfo, segmentInfo);\n  return flatten(representations.map(inheritBaseUrls(attrs, adaptationSetBaseUrls, adaptationSetSegmentInfo)));\n};\n/**\n * Contains all period information for mapping nodes onto adaptation sets.\n *\n * @typedef {Object} PeriodInformation\n * @property {Node} period.node\n *           Period node from the mpd\n * @property {Object} period.attributes\n *           Parsed period attributes from node plus any added\n */\n\n/**\n * Maps a PeriodInformation object to a list of Representation information objects for all\n * AdaptationSet nodes contained within the Period.\n *\n * @name toAdaptationSetsCallback\n * @function\n * @param {PeriodInformation} period\n *        Period object containing necessary period information\n * @param {number} periodStart\n *        Start time of the Period within the mpd\n * @return {RepresentationInformation[]}\n *         List of objects containing Representaion information\n */\n\n/**\n * Returns a callback for Array.prototype.map for mapping Period nodes to a list of\n * Representation information objects\n *\n * @param {Object} mpdAttributes\n *        Contains attributes inherited by the mpd\n * @param {string[]} mpdBaseUrls\n *        Contains list of resolved base urls inherited by the mpd\n * @return {toAdaptationSetsCallback}\n *         Callback map function\n */\n\nconst toAdaptationSets = (mpdAttributes, mpdBaseUrls) => (period, index) => {\n  const periodBaseUrls = buildBaseUrls(mpdBaseUrls, findChildren(period.node, 'BaseURL'));\n  const periodAttributes = merge(mpdAttributes, {\n    periodStart: period.attributes.start\n  });\n\n  if (typeof period.attributes.duration === 'number') {\n    periodAttributes.periodDuration = period.attributes.duration;\n  }\n\n  const adaptationSets = findChildren(period.node, 'AdaptationSet');\n  const periodSegmentInfo = getSegmentInformation(period.node);\n  return flatten(adaptationSets.map(toRepresentations(periodAttributes, periodBaseUrls, periodSegmentInfo)));\n};\n/**\n * Gets Period@start property for a given period.\n *\n * @param {Object} options\n *        Options object\n * @param {Object} options.attributes\n *        Period attributes\n * @param {Object} [options.priorPeriodAttributes]\n *        Prior period attributes (if prior period is available)\n * @param {string} options.mpdType\n *        The MPD@type these periods came from\n * @return {number|null}\n *         The period start, or null if it's an early available period or error\n */\n\nconst getPeriodStart = ({\n  attributes,\n  priorPeriodAttributes,\n  mpdType\n}) => {\n  // Summary of period start time calculation from DASH spec section 5.3.2.1\n  //\n  // A period's start is the first period's start + time elapsed after playing all\n  // prior periods to this one. Periods continue one after the other in time (without\n  // gaps) until the end of the presentation.\n  //\n  // The value of Period@start should be:\n  // 1. if Period@start is present: value of Period@start\n  // 2. if previous period exists and it has @duration: previous Period@start +\n  //    previous Period@duration\n  // 3. if this is first period and MPD@type is 'static': 0\n  // 4. in all other cases, consider the period an \"early available period\" (note: not\n  //    currently supported)\n  // (1)\n  if (typeof attributes.start === 'number') {\n    return attributes.start;\n  } // (2)\n\n\n  if (priorPeriodAttributes && typeof priorPeriodAttributes.start === 'number' && typeof priorPeriodAttributes.duration === 'number') {\n    return priorPeriodAttributes.start + priorPeriodAttributes.duration;\n  } // (3)\n\n\n  if (!priorPeriodAttributes && mpdType === 'static') {\n    return 0;\n  } // (4)\n  // There is currently no logic for calculating the Period@start value if there is\n  // no Period@start or prior Period@start and Period@duration available. This is not made\n  // explicit by the DASH interop guidelines or the DASH spec, however, since there's\n  // nothing about any other resolution strategies, it's implied. Thus, this case should\n  // be considered an early available period, or error, and null should suffice for both\n  // of those cases.\n\n\n  return null;\n};\n/**\n * Traverses the mpd xml tree to generate a list of Representation information objects\n * that have inherited attributes from parent nodes\n *\n * @param {Node} mpd\n *        The root node of the mpd\n * @param {Object} options\n *        Available options for inheritAttributes\n * @param {string} options.manifestUri\n *        The uri source of the mpd\n * @param {number} options.NOW\n *        Current time per DASH IOP.  Default is current time in ms since epoch\n * @param {number} options.clientOffset\n *        Client time difference from NOW (in milliseconds)\n * @return {RepresentationInformation[]}\n *         List of objects containing Representation information\n */\n\nconst inheritAttributes = (mpd, options = {}) => {\n  const {\n    manifestUri = '',\n    NOW = Date.now(),\n    clientOffset = 0\n  } = options;\n  const periodNodes = findChildren(mpd, 'Period');\n\n  if (!periodNodes.length) {\n    throw new Error(errors.INVALID_NUMBER_OF_PERIOD);\n  }\n\n  const locations = findChildren(mpd, 'Location');\n  const mpdAttributes = parseAttributes(mpd);\n  const mpdBaseUrls = buildBaseUrls([manifestUri], findChildren(mpd, 'BaseURL')); // See DASH spec section 5.3.1.2, Semantics of MPD element. Default type to 'static'.\n\n  mpdAttributes.type = mpdAttributes.type || 'static';\n  mpdAttributes.sourceDuration = mpdAttributes.mediaPresentationDuration || 0;\n  mpdAttributes.NOW = NOW;\n  mpdAttributes.clientOffset = clientOffset;\n\n  if (locations.length) {\n    mpdAttributes.locations = locations.map(getContent);\n  }\n\n  const periods = []; // Since toAdaptationSets acts on individual periods right now, the simplest approach to\n  // adding properties that require looking at prior periods is to parse attributes and add\n  // missing ones before toAdaptationSets is called. If more such properties are added, it\n  // may be better to refactor toAdaptationSets.\n\n  periodNodes.forEach((node, index) => {\n    const attributes = parseAttributes(node); // Use the last modified prior period, as it may contain added information necessary\n    // for this period.\n\n    const priorPeriod = periods[index - 1];\n    attributes.start = getPeriodStart({\n      attributes,\n      priorPeriodAttributes: priorPeriod ? priorPeriod.attributes : null,\n      mpdType: mpdAttributes.type\n    });\n    periods.push({\n      node,\n      attributes\n    });\n  });\n  return {\n    locations: mpdAttributes.locations,\n    representationInfo: flatten(periods.map(toAdaptationSets(mpdAttributes, mpdBaseUrls)))\n  };\n};\n\nconst stringToMpdXml = manifestString => {\n  if (manifestString === '') {\n    throw new Error(errors.DASH_EMPTY_MANIFEST);\n  }\n\n  const parser = new DOMParser();\n  let xml;\n  let mpd;\n\n  try {\n    xml = parser.parseFromString(manifestString, 'application/xml');\n    mpd = xml && xml.documentElement.tagName === 'MPD' ? xml.documentElement : null;\n  } catch (e) {// ie 11 throwsw on invalid xml\n  }\n\n  if (!mpd || mpd && mpd.getElementsByTagName('parsererror').length > 0) {\n    throw new Error(errors.DASH_INVALID_XML);\n  }\n\n  return mpd;\n};\n\n/**\n * Parses the manifest for a UTCTiming node, returning the nodes attributes if found\n *\n * @param {string} mpd\n *        XML string of the MPD manifest\n * @return {Object|null}\n *         Attributes of UTCTiming node specified in the manifest. Null if none found\n */\n\nconst parseUTCTimingScheme = mpd => {\n  const UTCTimingNode = findChildren(mpd, 'UTCTiming')[0];\n\n  if (!UTCTimingNode) {\n    return null;\n  }\n\n  const attributes = parseAttributes(UTCTimingNode);\n\n  switch (attributes.schemeIdUri) {\n    case 'urn:mpeg:dash:utc:http-head:2014':\n    case 'urn:mpeg:dash:utc:http-head:2012':\n      attributes.method = 'HEAD';\n      break;\n\n    case 'urn:mpeg:dash:utc:http-xsdate:2014':\n    case 'urn:mpeg:dash:utc:http-iso:2014':\n    case 'urn:mpeg:dash:utc:http-xsdate:2012':\n    case 'urn:mpeg:dash:utc:http-iso:2012':\n      attributes.method = 'GET';\n      break;\n\n    case 'urn:mpeg:dash:utc:direct:2014':\n    case 'urn:mpeg:dash:utc:direct:2012':\n      attributes.method = 'DIRECT';\n      attributes.value = Date.parse(attributes.value);\n      break;\n\n    case 'urn:mpeg:dash:utc:http-ntp:2014':\n    case 'urn:mpeg:dash:utc:ntp:2014':\n    case 'urn:mpeg:dash:utc:sntp:2014':\n    default:\n      throw new Error(errors.UNSUPPORTED_UTC_TIMING_SCHEME);\n  }\n\n  return attributes;\n};\n\nconst VERSION = version;\n/*\n * Given a DASH manifest string and options, parses the DASH manifest into an object in the\n * form outputed by m3u8-parser and accepted by videojs/http-streaming.\n *\n * For live DASH manifests, if `previousManifest` is provided in options, then the newly\n * parsed DASH manifest will have its media sequence and discontinuity sequence values\n * updated to reflect its position relative to the prior manifest.\n *\n * @param {string} manifestString - the DASH manifest as a string\n * @param {options} [options] - any options\n *\n * @return {Object} the manifest object\n */\n\nconst parse = (manifestString, options = {}) => {\n  const parsedManifestInfo = inheritAttributes(stringToMpdXml(manifestString), options);\n  const playlists = toPlaylists(parsedManifestInfo.representationInfo);\n  return toM3u8({\n    dashPlaylists: playlists,\n    locations: parsedManifestInfo.locations,\n    sidxMapping: options.sidxMapping,\n    previousManifest: options.previousManifest\n  });\n};\n/**\n * Parses the manifest for a UTCTiming node, returning the nodes attributes if found\n *\n * @param {string} manifestString\n *        XML string of the MPD manifest\n * @return {Object|null}\n *         Attributes of UTCTiming node specified in the manifest. Null if none found\n */\n\n\nconst parseUTCTiming = manifestString => parseUTCTimingScheme(stringToMpdXml(manifestString));\n\nexport { VERSION, addSidxSegmentsToPlaylist$1 as addSidxSegmentsToPlaylist, generateSidxKey, inheritAttributes, parse, parseUTCTiming, stringToMpdXml, toM3u8, toPlaylists };\n","// see https://tools.ietf.org/html/rfc1808\n\n(function (root) {\n  var URL_REGEX =\n    /^(?=((?:[a-zA-Z0-9+\\-.]+:)?))\\1(?=((?:\\/\\/[^\\/?#]*)?))\\2(?=((?:(?:[^?#\\/]*\\/)*[^;?#\\/]*)?))\\3((?:;[^?#]*)?)(\\?[^#]*)?(#[^]*)?$/;\n  var FIRST_SEGMENT_REGEX = /^(?=([^\\/?#]*))\\1([^]*)$/;\n  var SLASH_DOT_REGEX = /(?:\\/|^)\\.(?=\\/)/g;\n  var SLASH_DOT_DOT_REGEX = /(?:\\/|^)\\.\\.\\/(?!\\.\\.\\/)[^\\/]*(?=\\/)/g;\n\n  var URLToolkit = {\n    // If opts.alwaysNormalize is true then the path will always be normalized even when it starts with / or //\n    // E.g\n    // With opts.alwaysNormalize = false (default, spec compliant)\n    // http://a.com/b/cd + /e/f/../g => http://a.com/e/f/../g\n    // With opts.alwaysNormalize = true (not spec compliant)\n    // http://a.com/b/cd + /e/f/../g => http://a.com/e/g\n    buildAbsoluteURL: function (baseURL, relativeURL, opts) {\n      opts = opts || {};\n      // remove any remaining space and CRLF\n      baseURL = baseURL.trim();\n      relativeURL = relativeURL.trim();\n      if (!relativeURL) {\n        // 2a) If the embedded URL is entirely empty, it inherits the\n        // entire base URL (i.e., is set equal to the base URL)\n        // and we are done.\n        if (!opts.alwaysNormalize) {\n          return baseURL;\n        }\n        var basePartsForNormalise = URLToolkit.parseURL(baseURL);\n        if (!basePartsForNormalise) {\n          throw new Error('Error trying to parse base URL.');\n        }\n        basePartsForNormalise.path = URLToolkit.normalizePath(\n          basePartsForNormalise.path\n        );\n        return URLToolkit.buildURLFromParts(basePartsForNormalise);\n      }\n      var relativeParts = URLToolkit.parseURL(relativeURL);\n      if (!relativeParts) {\n        throw new Error('Error trying to parse relative URL.');\n      }\n      if (relativeParts.scheme) {\n        // 2b) If the embedded URL starts with a scheme name, it is\n        // interpreted as an absolute URL and we are done.\n        if (!opts.alwaysNormalize) {\n          return relativeURL;\n        }\n        relativeParts.path = URLToolkit.normalizePath(relativeParts.path);\n        return URLToolkit.buildURLFromParts(relativeParts);\n      }\n      var baseParts = URLToolkit.parseURL(baseURL);\n      if (!baseParts) {\n        throw new Error('Error trying to parse base URL.');\n      }\n      if (!baseParts.netLoc && baseParts.path && baseParts.path[0] !== '/') {\n        // If netLoc missing and path doesn't start with '/', assume everthing before the first '/' is the netLoc\n        // This causes 'example.com/a' to be handled as '//example.com/a' instead of '/example.com/a'\n        var pathParts = FIRST_SEGMENT_REGEX.exec(baseParts.path);\n        baseParts.netLoc = pathParts[1];\n        baseParts.path = pathParts[2];\n      }\n      if (baseParts.netLoc && !baseParts.path) {\n        baseParts.path = '/';\n      }\n      var builtParts = {\n        // 2c) Otherwise, the embedded URL inherits the scheme of\n        // the base URL.\n        scheme: baseParts.scheme,\n        netLoc: relativeParts.netLoc,\n        path: null,\n        params: relativeParts.params,\n        query: relativeParts.query,\n        fragment: relativeParts.fragment,\n      };\n      if (!relativeParts.netLoc) {\n        // 3) If the embedded URL's <net_loc> is non-empty, we skip to\n        // Step 7.  Otherwise, the embedded URL inherits the <net_loc>\n        // (if any) of the base URL.\n        builtParts.netLoc = baseParts.netLoc;\n        // 4) If the embedded URL path is preceded by a slash \"/\", the\n        // path is not relative and we skip to Step 7.\n        if (relativeParts.path[0] !== '/') {\n          if (!relativeParts.path) {\n            // 5) If the embedded URL path is empty (and not preceded by a\n            // slash), then the embedded URL inherits the base URL path\n            builtParts.path = baseParts.path;\n            // 5a) if the embedded URL's <params> is non-empty, we skip to\n            // step 7; otherwise, it inherits the <params> of the base\n            // URL (if any) and\n            if (!relativeParts.params) {\n              builtParts.params = baseParts.params;\n              // 5b) if the embedded URL's <query> is non-empty, we skip to\n              // step 7; otherwise, it inherits the <query> of the base\n              // URL (if any) and we skip to step 7.\n              if (!relativeParts.query) {\n                builtParts.query = baseParts.query;\n              }\n            }\n          } else {\n            // 6) The last segment of the base URL's path (anything\n            // following the rightmost slash \"/\", or the entire path if no\n            // slash is present) is removed and the embedded URL's path is\n            // appended in its place.\n            var baseURLPath = baseParts.path;\n            var newPath =\n              baseURLPath.substring(0, baseURLPath.lastIndexOf('/') + 1) +\n              relativeParts.path;\n            builtParts.path = URLToolkit.normalizePath(newPath);\n          }\n        }\n      }\n      if (builtParts.path === null) {\n        builtParts.path = opts.alwaysNormalize\n          ? URLToolkit.normalizePath(relativeParts.path)\n          : relativeParts.path;\n      }\n      return URLToolkit.buildURLFromParts(builtParts);\n    },\n    parseURL: function (url) {\n      var parts = URL_REGEX.exec(url);\n      if (!parts) {\n        return null;\n      }\n      return {\n        scheme: parts[1] || '',\n        netLoc: parts[2] || '',\n        path: parts[3] || '',\n        params: parts[4] || '',\n        query: parts[5] || '',\n        fragment: parts[6] || '',\n      };\n    },\n    normalizePath: function (path) {\n      // The following operations are\n      // then applied, in order, to the new path:\n      // 6a) All occurrences of \"./\", where \".\" is a complete path\n      // segment, are removed.\n      // 6b) If the path ends with \".\" as a complete path segment,\n      // that \".\" is removed.\n      path = path.split('').reverse().join('').replace(SLASH_DOT_REGEX, '');\n      // 6c) All occurrences of \"<segment>/../\", where <segment> is a\n      // complete path segment not equal to \"..\", are removed.\n      // Removal of these path segments is performed iteratively,\n      // removing the leftmost matching pattern on each iteration,\n      // until no matching pattern remains.\n      // 6d) If the path ends with \"<segment>/..\", where <segment> is a\n      // complete path segment not equal to \"..\", that\n      // \"<segment>/..\" is removed.\n      while (\n        path.length !== (path = path.replace(SLASH_DOT_DOT_REGEX, '')).length\n      ) {}\n      return path.split('').reverse().join('');\n    },\n    buildURLFromParts: function (parts) {\n      return (\n        parts.scheme +\n        parts.netLoc +\n        parts.path +\n        parts.params +\n        parts.query +\n        parts.fragment\n      );\n    },\n  };\n\n  if (typeof exports === 'object' && typeof module === 'object')\n    module.exports = URLToolkit;\n  else if (typeof define === 'function' && define.amd)\n    define([], function () {\n      return URLToolkit;\n    });\n  else if (typeof exports === 'object') exports['URLToolkit'] = URLToolkit;\n  else root['URLToolkit'] = URLToolkit;\n})(this);\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { parse } from 'mpd-parser';\n\n(async function() {\n    let manifestUri = document.getElementById(\"ads-text\").dataset.manifest;\n\n    let res = await fetch(manifestUri);\n    let manifest = await res.text();\n    let parsedManifest = null;\n    let rootPath = \"\";\n\n    try{\n        parsedManifest = parse(manifest, manifestUri);\n    } catch(e) {\n        console.log('ERROR MANIFEST', e);\n    }\n    \n    if (parsedManifest.playlists && parsedManifest.playlists.length) {\n        let ll = parsedManifest.playlists[0];\n        let audio = parsedManifest.mediaGroups.AUDIO.audio;\n        let segmentsAudio = [];\n\n        if (audio) {\n            let aa = audio[Object.keys(audio)[0]];\n            segmentsAudio = aa.playlists[0].segments;\n        }\n\n        if (ll.segments && ll.segments.length && segmentsAudio.length) {\n\n            let filename = manifestUri\n                .replace(/^.*[\\\\\\/]/, '')\n                .replace(/\\?.*/, '');\n\n            rootPath = manifestUri.split(filename)[0].replace(filename, \"\");\n        }\n\n        let a = ll;\n\n        if (a.segments) {\n            let data3 = null;\n            let data4 = null;\n\n            for (let i = 0; i < a.segments.length; i++) {\n\n                let uriSegment = a.segments[i].uri;\n                let fullPathSegment = rootPath + uriSegment;\n                if (a.segments[i].resolvedUri &&\n                    a.segments[i].resolvedUri.toLowerCase().indexOf(\"instadownloader.site\") === -1) {\n                    fullPathSegment = a.segments[i].resolvedUri;\n                }\n                let response3 = await fetch(fullPathSegment);\n                let datas = await response3.arrayBuffer();\n                if (data3) {\n                    console.log(fullPathSegment, data3);\n                    data3 = _appendBuffer(data3, datas);\n                } else {\n                    console.log(fullPathSegment, datas);\n                    data3 = await initSegment(rootPath, a.segments[i], datas);\n                    console.log('dataInit', data3);\n                }\n            }\n            window.sourceBufferVideo = data3;\n\n\n            if (segmentsAudio && segmentsAudio.length) {\n                data4 = null;\n                for (let j = 0; j < segmentsAudio.length; j++) {\n\n                    let _uriSegment = segmentsAudio[j].uri;\n                    let _fullPathSegment = rootPath + _uriSegment;\n                    if (segmentsAudio[j].resolvedUri &&\n                        segmentsAudio[j].resolvedUri.toLowerCase().indexOf(\"instadownloader.site\") === -1) {\n                        _fullPathSegment = segmentsAudio[j].resolvedUri;\n                    }\n                    console.log(_fullPathSegment);\n                    let _response = await fetch(_fullPathSegment);\n                    let _datas = await _response.arrayBuffer();\n                    if (data4) {\n                        data4 = _appendBuffer(data4, _datas);\n                    } else {\n                        //data4 = _datas;\n                        data4 = await initSegment(rootPath, segmentsAudio[j], _datas);\n                    }\n                }\n            }\n            window.sourceBufferAudio = data4;\n\n\n            // var ffmpeg = createFFmpeg({\n            //     log: true,\n            //     corePath: '/js/vendor/ffmpeg-core.js'\n            // });\n            // await ffmpeg.load();\n            //\n            // ffmpeg.setLogger(({ type, message }) => {\n            //     console.log('logger', type, message);\n            //     //logprogress.innerHTML = message;\n            // });\n            //\n            // await ffmpeg.FS(\"writeFile\", \"video\", new Uint8Array(sourceBufferVideo, 0, sourceBufferVideo.byteLength));\n            // await ffmpeg.FS(\"writeFile\", \"audio\", new Uint8Array(sourceBufferAudio, 0, sourceBufferAudio.byteLength));\n            //\n            // await ffmpeg.run(\"-i\", \"video\", \"-i\", \"audio\", \"-c:v\", \"copy\", \"-c:a\", \"aac\", \"output.mp4\");\n            //\n            // const output = await ffmpeg.FS(\"readFile\", \"output.mp4\");\n            // download(output.buffer, 'finish.mp4', 'video/mp4');\n            //headtitle.innerHTML = \"Video downloaded to your computer...\"\n        }\n    }\n    \n})();\n\nfunction download(data, filename, type) {\n    var file = new Blob([data], {type: type});\n\n    var a = document.createElement(\"a\"),\n        url = URL.createObjectURL(file);\n    a.href = url;\n    a.download = filename;\n    document.body.appendChild(a);\n    a.click();\n    setTimeout(function() {\n        document.body.removeChild(a);\n        window.URL.revokeObjectURL(url);\n    }, 0);\n\n}\n\n// function download(data, filename, type) {\n//\n//     var blob = new Blob([data], {type: type});\n//\n//     const fileStream = streamSaver.createWriteStream(filename, {\n//         size: blob.size // Makes the procentage visiable in the downloadHls\n//     })\n//\n//     const readableStream = blob.stream()\n//     if (WritableStream && readableStream.pipeTo) {\n//         return readableStream.pipeTo(fileStream)\n//             .then(() => console.log('done writing'))\n//     }\n// }\n\nvar _appendBuffer = function(buffer1, buffer2) {\n    let tmp = new Uint8Array(buffer1.byteLength + buffer2.byteLength);\n    tmp.set(new Uint8Array(buffer1), 0);\n    tmp.set(new Uint8Array(buffer2), buffer1.byteLength);\n    return tmp.buffer;\n};\n\nasync function initSegment(rootPath, init, datas) {\n    if(init.map) {\n        let uriSegment = init.map.uri;\n        let fullPathSegment = rootPath + uriSegment;\n        if (init.map.resolvedUri &&\n            init.map.resolvedUri.toLowerCase().indexOf(\"instadownloader.site\") === -1) {\n            fullPathSegment = init.map.resolvedUri;\n        }\n        console.log(fullPathSegment);\n        let response3 = await fetch(fullPathSegment);\n        let dataInit = await response3.arrayBuffer();\n        console.log('dataInit', dataInit);\n        if(dataInit) {\n            return _appendBuffer(dataInit, datas);\n        }\n        return datas;\n    }\n};\n"],"names":["window","atob","s","Buffer","from","toString","decodeB64ToUint8Array","b64Text","decodedString","array","Uint8Array","length","i","charCodeAt","forEachMediaGroup","master","groups","callback","forEach","mediaType","groupKey","mediaGroups","labelKey","mediaProperties","URLToolkit","DEFAULT_LOCATION","resolveUrl","baseUrl","relativeUrl","test","location","href","nativeURL","URL","protocolLess","removeLocation","buildAbsoluteURL","newUrl","slice","protocol","find","list","predicate","ac","undefined","Array","prototype","call","Object","hasOwnProperty","item","freeze","object","oc","assign","target","source","TypeError","key","MIME_TYPE","HTML","isHTML","value","XML_APPLICATION","XML_TEXT","XML_XHTML_APPLICATION","XML_SVG_IMAGE","NAMESPACE","uri","SVG","XML","XMLNS","exports","conventions","require","dom","entities","sax","DOMImplementation","ParseError","XMLReader","normalizeLineEndings","input","replace","DOMParser","options","locator","parseFromString","mimeType","domBuilder","DOMHandler","errorHandler","defaultNSMap","xmlns","entityMap","HTML_ENTITIES","XML_ENTITIES","setDocumentLocator","buildErrorHandler","xml","normalize","parse","error","doc","errorImpl","isCallback","Function","build","fn","msg","_locator","cdata","position","node","lineNumber","columnNumber","startDocument","createDocument","documentURI","systemId","startElement","namespaceURI","localName","qName","attrs","el","createElementNS","len","appendElement","currentElement","getURI","getValue","getQName","attr","createAttributeNS","getLocator","nodeValue","setAttributeNode","endElement","current","tagName","parentNode","startPrefixMapping","prefix","endPrefixMapping","processingInstruction","data","ins","createProcessingInstruction","ignorableWhitespace","ch","start","characters","chars","_toString","apply","arguments","charNode","createCDATASection","createTextNode","appendChild","skippedEntity","name","endDocument","comment","comm","createComment","startCDATA","endCDATA","startDTD","publicId","impl","implementation","createDocumentType","dt","doctype","warning","console","warn","fatalError","l","substr","java","lang","String","hander","__DOMHandler","notEmptyString","splitOnASCIIWhitespace","split","filter","orderedSetReducer","element","toOrderedSet","keys","reduce","arrayIncludes","indexOf","copy","src","dest","p","_extends","Class","Super","pt","t","constructor","NodeType","ELEMENT_NODE","ATTRIBUTE_NODE","TEXT_NODE","CDATA_SECTION_NODE","ENTITY_REFERENCE_NODE","ENTITY_NODE","PROCESSING_INSTRUCTION_NODE","COMMENT_NODE","DOCUMENT_NODE","DOCUMENT_TYPE_NODE","DOCUMENT_FRAGMENT_NODE","NOTATION_NODE","ExceptionCode","ExceptionMessage","INDEX_SIZE_ERR","DOMSTRING_SIZE_ERR","HIERARCHY_REQUEST_ERR","WRONG_DOCUMENT_ERR","INVALID_CHARACTER_ERR","NO_DATA_ALLOWED_ERR","NO_MODIFICATION_ALLOWED_ERR","NOT_FOUND_ERR","NOT_SUPPORTED_ERR","INUSE_ATTRIBUTE_ERR","INVALID_STATE_ERR","SYNTAX_ERR","INVALID_MODIFICATION_ERR","NAMESPACE_ERR","INVALID_ACCESS_ERR","DOMException","code","message","Error","captureStackTrace","NodeList","index","nodeFilter","buf","serializeToString","join","LiveNodeList","refresh","_node","_refresh","_updateLiveList","inc","_inc","ownerDocument","ls","__set__","NamedNodeMap","_findNodeIndex","_addNamedNode","newAttr","oldAttr","ownerElement","_onRemoveAttribute","_onAddAttribute","_removeNamedNode","lastIndex","getNamedItem","nodeName","setNamedItem","_ownerElement","setNamedItemNS","getNamedItemNS","removeNamedItem","removeNamedItemNS","hasFeature","feature","version","qualifiedName","Document","childNodes","root","DocumentType","Node","firstChild","lastChild","previousSibling","nextSibling","attributes","insertBefore","newChild","refChild","_insertBefore","replaceChild","oldChild","assertPreReplacementValidityInDocument","removeChild","_removeChild","hasChildNodes","cloneNode","deep","child","next","nodeType","appendData","isSupported","hasAttributes","lookupPrefix","map","_nsMap","n","lookupNamespaceURI","isDefaultNamespace","_xmlEncoder","c","_visitNode","ns","remove","_onUpdateChild","cs","previous","hasValidParentNodeType","hasInsertableNodeType","isElementNode","isTextNode","isDocTypeNode","isElementInsertionPossible","parentChildNodes","docTypeNode","isElementReplacementPossible","hasElementChildThatIsNotChild","assertPreInsertionValidity1to5","parent","assertPreInsertionValidityInDocument","nodeChildNodes","nodeChildElements","parentElementChild","hasDoctypeChildThatIsNotChild","_inDocumentAssertion","cp","newFirst","newLast","pre","_appendSingleChild","documentElement","importNode","importedNode","getElementById","id","rtv","getAttribute","getElementsByClassName","classNames","classNamesSet","base","nodeClassNames","matches","nodeClassNamesSet","every","push","createElement","Element","createDocumentFragment","DocumentFragment","Text","Comment","CDATASection","ProcessingInstruction","createAttribute","Attr","specified","createEntityReference","EntityReference","pl","hasAttribute","getAttributeNode","setAttribute","removeAttribute","removeAttributeNode","setAttributeNodeNS","removeAttributeNS","old","getAttributeNodeNS","hasAttributeNS","getAttributeNS","setAttributeNS","getElementsByTagName","getElementsByTagNameNS","CharacterData","substringData","offset","count","substring","text","insertData","replaceData","deleteData","end","splitText","newText","newNode","Notation","Entity","XMLSerializer","isHtml","nodeSerializeToString","refNode","visibleNamespaces","namespace","needNamespaceDefine","addSerializedAttribute","prefixedNodeName","defaultNS","ai","nsi","pubid","sysid","sub","internalSubset","node2","v","attrs2","defineProperty","get","$$length","getTextContent","set","e","amp","apos","gt","lt","quot","Agrave","Aacute","Acirc","Atilde","Auml","Aring","AElig","Ccedil","Egrave","Eacute","Ecirc","Euml","Igrave","Iacute","Icirc","Iuml","ETH","Ntilde","Ograve","Oacute","Ocirc","Otilde","Ouml","Oslash","Ugrave","Uacute","Ucirc","Uuml","Yacute","THORN","szlig","agrave","aacute","acirc","atilde","auml","aring","aelig","ccedil","egrave","eacute","ecirc","euml","igrave","iacute","icirc","iuml","eth","ntilde","ograve","oacute","ocirc","otilde","ouml","oslash","ugrave","uacute","ucirc","uuml","yacute","thorn","yuml","nbsp","iexcl","cent","pound","curren","yen","brvbar","sect","uml","ordf","laquo","not","shy","reg","macr","deg","plusmn","sup2","sup3","acute","micro","para","middot","cedil","sup1","ordm","raquo","frac14","frac12","frac34","iquest","times","divide","forall","part","exist","empty","nabla","isin","notin","ni","prod","sum","minus","lowast","radic","prop","infin","ang","and","or","cap","cup","there4","sim","cong","asymp","ne","equiv","le","ge","sup","nsub","sube","supe","oplus","otimes","perp","sdot","Alpha","Beta","Gamma","Delta","Epsilon","Zeta","Eta","Theta","Iota","Kappa","Lambda","Mu","Nu","Xi","Omicron","Pi","Rho","Sigma","Tau","Upsilon","Phi","Chi","Psi","Omega","alpha","beta","gamma","delta","epsilon","zeta","eta","theta","iota","kappa","lambda","mu","nu","xi","omicron","pi","rho","sigmaf","sigma","tau","upsilon","phi","chi","psi","omega","thetasym","upsih","piv","OElig","oelig","Scaron","scaron","Yuml","fnof","circ","tilde","ensp","emsp","thinsp","zwnj","zwj","lrm","rlm","ndash","mdash","lsquo","rsquo","sbquo","ldquo","rdquo","bdquo","dagger","Dagger","bull","hellip","permil","prime","Prime","lsaquo","rsaquo","oline","euro","trade","larr","uarr","rarr","darr","harr","crarr","lceil","rceil","lfloor","rfloor","loz","spades","clubs","hearts","diams","nameStartChar","nameChar","RegExp","tagNamePattern","S_TAG","S_ATTR","S_ATTR_SPACE","S_EQ","S_ATTR_NOQUOT_VALUE","S_ATTR_END","S_TAG_SPACE","S_TAG_CLOSE","_copy","defaultNSMapCopy","fixedFromCharCode","surrogate1","surrogate2","fromCharCode","entityReplacer","a","k","charAt","parseInt","appendText","xt","m","lineEnd","linePattern","exec","lineStart","parseStack","currentNSMap","closeMap","tagStart","match","config","pop","localNSMap","endMatch","endIgnoreCaseMach","toLowerCase","parseInstruction","parseDCC","ElementAttributes","parseElementStartPart","closed","fixSelfClosed","locator2","copyLocator","parseHtmlSpecialContent","Math","max","f","addAttribute","qname","startIndex","attributeNames","addValue","attrName","setTagName","nsp","nsPrefix","elStartEnd","elEndStart","pos","lastIndexOf","matchs","lastMatch","endDTD","getLocalName","win","global","self","module","isObject","obj","merge","objects","result","isArray","concat","values","o","range","flatten","lists","x","y","findIndexes","union","keyFunction","acc","errors","INVALID_NUMBER_OF_PERIOD","DASH_EMPTY_MANIFEST","DASH_INVALID_XML","NO_BASE_URL","MISSING_SEGMENT_INFORMATION","SEGMENT_TIME_UNSPECIFIED","UNSUPPORTED_UTC_TIMING_SCHEME","urlTypeToSegment","indexRange","segment","resolvedUri","rangeStr","ranges","startRange","BigInt","endRange","Number","MAX_SAFE_INTEGER","byterange","byteRangeToString","parseEndNumber","endNumber","isNaN","segmentRange","static","duration","timescale","sourceDuration","periodDuration","segmentDuration","dynamic","NOW","clientOffset","availabilityStartTime","periodStart","minimumUpdatePeriod","timeShiftBufferDepth","Infinity","now","periodStartWC","periodEndWC","segmentCount","ceil","availableStart","floor","availableEnd","min","toSegments","number","startNumber","timeline","time","parseByDuration","type","segments","sectionDuration","segmentsFromBase","initialization","presentationTime","initSegment","sourceURL","segmentTimeInfo","addSidxSegmentsToPlaylist$1","playlist","sidx","sidxByteRange","sidxEnd","mediaReferences","references","r","referenceType","endList","mediaSequence","firstOffset","reference","size","referencedSize","subsegmentDuration","endIndex","SUPPORTED_MEDIA_TYPES","TIME_FUDGE","getUniqueTimelineStarts","timelineStarts","sort","b","findPlaylistWithName","playlists","NAME","getMediaGroupPlaylists","manifest","mediaGroupPlaylists","properties","group","label","updateMediaSequenceForPlaylist","updateSequenceNumbers","oldPlaylists","newPlaylists","discontinuitySequence","findIndex","oldPlaylist","firstNewSegment","oldMatchingSegmentIndex","oldSegment","abs","discontinuity","discontinuityStarts","unshift","oldMatchingSegment","positionManifestOnTimeline","oldManifest","newManifest","generateSidxKey","mergeDiscontiguousPlaylists","mergedPlaylists","contentProtection","addSidxSegmentsToPlaylist","sidxMapping","sidxKey","sidxMatch","addSidxSegmentsToPlaylists","formatAudioPlaylist","isAudioOnly","BANDWIDTH","bandwidth","CODECS","codecs","targetDuration","AUDIO","SUBTITLES","formatVttPlaylist","m3u8Attributes","organizeAudioPlaylists","mainPlaylist","formattedPlaylists","role","language","roleLabel","autoselect","default","formatted","firstLabel","organizeVttPlaylists","organizeCaptionServices","captionServices","svcObj","svc","service","channel","instreamId","aspectRatio","easyReader","formatVideoPlaylist","RESOLUTION","width","height","frameRate","videoOnly","contentType","audioOnly","vttOnly","addMediaSequenceValues","flattenMediaGroupPlaylists","mediaGroupObject","labelContents","toM3u8","dashPlaylists","locations","previousManifest","suggestedPresentationDelay","videoPlaylists","audioPlaylists","vttPlaylists","captions","Boolean","allowCache","VIDEO","organizedAudioGroup","organizedVttGroup","playlistTimelineStarts","audio","subs","cc","getLiveRValue","parseByTimeline","segmentTimeline","media","sIndex","S","d","repeat","segmentTime","nextS","identifierPattern","identifierReplacement","identifier","format","constructTemplateUrl","url","parseTemplateInfo","segmentsFromTemplate","templateValues","RepresentationID","Bandwidth","mapSegment","Time","presentationTimeOffset","SegmentURLToSegmentObject","segmentUrl","mediaRange","segmentsFromList","segmentUrls","segmentUrlMap","segmentUrlObject","generateSegments","segmentInfo","segmentAttributes","segmentsFn","template","segmentsInfo","toPlaylists","representations","findChildren","getContent","textContent","trim","parseDivisionValue","parseFloat","prev","parseDuration","str","SECONDS_IN_YEAR","SECONDS_IN_MONTH","SECONDS_IN_DAY","SECONDS_IN_HOUR","SECONDS_IN_MIN","durationRegex","year","month","day","hour","minute","second","parseDate","dateRegex","Date","parsers","mediaPresentationDuration","parsedValue","DEFAULT","parseAttributes","parseFn","keySystemsMap","buildBaseUrls","referenceUrls","baseUrlElements","baseUrlElement","getSegmentInformation","adaptationSet","segmentTemplate","segmentList","tag","segmentBase","segmentTimelineParentNode","segmentInitializationParentNode","segmentInitialization","inheritBaseUrls","adaptationSetAttributes","adaptationSetBaseUrls","adaptationSetSegmentInfo","representation","repBaseUrlElements","repBaseUrls","representationSegmentInfo","generateKeySystemInformation","contentProtectionNodes","schemeIdUri","keySystem","psshNode","pssh","parseCaptionServiceMetadata","flags","opts","opt","val","toRepresentations","periodAttributes","periodBaseUrls","periodSegmentInfo","roleAttributes","accessibility","labelVal","toAdaptationSets","mpdAttributes","mpdBaseUrls","period","adaptationSets","getPeriodStart","priorPeriodAttributes","mpdType","inheritAttributes","mpd","manifestUri","periodNodes","periods","priorPeriod","representationInfo","stringToMpdXml","manifestString","parser","parseUTCTimingScheme","UTCTimingNode","method","VERSION","parsedManifestInfo","parseUTCTiming","URL_REGEX","FIRST_SEGMENT_REGEX","SLASH_DOT_REGEX","SLASH_DOT_DOT_REGEX","baseURL","relativeURL","alwaysNormalize","basePartsForNormalise","parseURL","path","normalizePath","buildURLFromParts","relativeParts","scheme","baseParts","netLoc","pathParts","builtParts","params","query","fragment","baseURLPath","newPath","parts","reverse","define","amd","document","dataset","res","fetch","parsedManifest","rootPath","log","ll","segmentsAudio","aa","filename","data3","data4","uriSegment","fullPathSegment","response3","datas","arrayBuffer","_appendBuffer","sourceBufferVideo","j","_uriSegment","_fullPathSegment","_response","_datas","sourceBufferAudio","download","file","Blob","createObjectURL","body","click","setTimeout","revokeObjectURL","buffer1","buffer2","tmp","byteLength","buffer","init","dataInit"],"sourceRoot":""}